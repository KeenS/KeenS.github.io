<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Îºeenã®Happy HacÎºing Blog</title>
    <link>/categories/common-lisp/index.xml</link>
    <description>Recent content on Îºeenã®Happy HacÎºing Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-jp</language>
    <atom:link href="/categories/common-lisp/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Deprecating CIM</title>
      <link>/blog/2017/01/29/deprecating_cim</link>
      <pubDate>Sun, 29 Jan 2017 22:18:24 +0900</pubDate>
      
      <guid>/blog/2017/01/29/deprecating_cim</guid>
      <description>&lt;p&gt;I&amp;rsquo;m Îºeen. I have a sad news, I&amp;rsquo;ll stop the development of &lt;a href=&#34;https://github.com/KeenS/CIM&#34;&gt;CIM&lt;/a&gt; and no more updates for new lisp impls will be provided.

It has been months from when I stopped developping CIM and only providing updates for new lisp impl versions.
From that point, CIM is a half-dead product. I know there are still someone using CIM though, so I kept updating.
For present CIM users, I recomend to migrate to &lt;a href=&#34;https://github.com/roswell/roswell&#34;&gt;roswell&lt;/a&gt;, also a lisp installer and manager, which is well-maintained.&lt;/p&gt;

&lt;p&gt;CIM has been developed in my studenthood for my practice in shell scripts. This is my first OSS.
The reason why I wrote CIM in shell script other than for practice is that shell scripts are the most portable and available script language on Unix-like systems.
The original purpose of writing a new manager is to provide a consistent way of launching CLs from CLI.
To realize that, managing lisp impls, including installing is needed so CIM has started to manage impls.
At some point, CIM was used such products like &lt;a href=&#34;https://github.com/luismbo/cl-travis&#34;&gt;cl-travis&lt;/a&gt;.
But CIM lacked flexibility of development as it is written in ugly shell script, and lacked Windows support.
As I got a job and got interests other than lisp such as Rust, I have no more time to spend for maintaining CIM.&lt;/p&gt;

&lt;p&gt;Thus &lt;a href=&#34;https://github.com/snmsts&#34;&gt;@snmsts&lt;/a&gt;, the author of roswell, started to develop roswell to support Windows.
Roswell is written mainly in Lisp though booting from C, so many of Lispers may be able to hack it.
Roswell is well-maintained because stmsts is, unlike me, a hobby Lisper, professional lisper and he uses roswell in daily work.
Besides roswell is well-maintained, roswell is more feature-rich than CIM.
It searchs for new lisp versions for itself so there is no need to update manager itself to update your local lisp impls.
It is distributed from package managers such like homebrew and AUR so you don&amp;rsquo;t need to care about updating it.
Using &lt;code&gt;dump&lt;/code&gt; feature of roswell, you can create an executable binary from a lisp script in a command.
And so on. There are many reasons to use roswell even if CIM would be kept maintained.&lt;/p&gt;

&lt;p&gt;Anyway I wish CIM users to keep using lisp via roswell. Thank you for staying with me for a long time.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>é«˜é€Ÿãªç¶™ç¶šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å‘ã‘ã¦</title>
      <link>/slide/kousokunakeizokuraiburarinimukete/</link>
      <pubDate>Sun, 08 May 2016 21:26:32 +0900</pubDate>
      
      <guid>/slide/kousokunakeizokuraiburarinimukete/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n===\n&#34;
    data-vertical=&#34;\n---\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# é«˜é€Ÿãªç¶™ç¶šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å‘ã‘ã¦
----------------------
[ç¶™ç¶šå‹‰å¼·ä¼š](http://connpass.com/event/28150/) 2016-05-22
&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Rust, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™
===
# ç¶™ç¶šæ¬²ã—ã„
-----------

* è‰²ã€…ãªå ´é¢ã§ä¾¿åˆ©
* Schemeã§ä½¿ã„å›ã—ã¦ã‚‹ã®ã†ã‚‰ã‚„ã¾ã—ã„
* Common Lispã§ã‚‚ä½¿ã„ãŸã„
* ç¾å®Ÿã«ã¯é™å®šç¶™ç¶šãŒæ¬²ã—ã„
  +  Common Lispã«ã¯å¤§åŸŸè„±å‡ºã¯ã‚ã‚‹

===
# é™å®šç¶™ç¶šã‚’ä½¿ã†ä¾‹
-----------------
## éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°

* ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å½¢å¼ã ã¨å³ã—ã„
* é™å®šç¶™ç¶šã‚’ä½¿ã†ã¨ç¶ºéº—ã«æ›¸ãç›´ã›ã‚‹

===
# é™å®šç¶™ç¶šã‚’ä½¿ã†ä¾‹
-----------------
## ã‚²ãƒ¼ãƒ ã®ã‚³ãƒ«ãƒ¼ãƒãƒ³

* è¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¶å¾¡ã™ã‚‹ã®ã«ã‚³ãƒ«ãƒ¼ãƒãƒ³ãŒæ¬²ã—ã„
* cf [ã‚³ãƒ«ãƒ¼ãƒãƒ³ã‚’Common Lispã§ç°¡å˜ã«å®šç¾© - ã•ãã‚‰ã‚“ã¼ã®lambdaæ—¥è¨˜](http://lambdasakura.hatenablog.com/entry/20111026/1319598590)

===
# é™å®šç¶™ç¶šã‚’ä½¿ã†ä¾‹
-----------------
## doè¨˜æ³•

* ãƒ¢ãƒŠãƒ‰ã®doè¨˜æ³•ã¯é™å®šç¶™ç¶šã‚’ä½¿ã£ã¦å®Ÿè£…å‡ºæ¥ã‚‹
* [Operational monad in scheme](http://www.slideshare.net/yuichinishiwaki/operational-monad-in-scheme)


===
# Common Lispã§ã®é™å®šç¶™ç¶šã®å®Ÿç¾
---------------

1. ä»•æ§˜ã«å…¥ã‚Œã¦ã‚‚ã‚‰ã†
2. å‡¦ç†ç³»ã«æ‰‹ã‚’å…¥ã‚Œã‚‹
3. ãƒ¦ãƒ¼ã‚¶ãƒ¬ãƒ™ãƒ«ã§(é™å®š)ç¶™ç¶šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œã‚‹
   + æŸ”è»ŸãªCommon Lispã§ã¯å¯èƒ½

===
# CPSå¤‰æ›
---------

* (é™å®š)ç¶™ç¶šã®å®Ÿç¾æ–¹æ³•ã®1ã¤
  + ã‚¹ã‚¿ãƒƒã‚¯ã‚’åˆ‡ã‚Šå–ã‚‹æ–¹å¼ã¨ã‹ã‚‚ã‚ã‚‹
* æ©Ÿæ¢°çš„ã«ã‚‚å‡ºæ¥ã‚‹
* ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªå¤‰æ›ãªã®ã¨ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãªå¼ã—ã‹æ›¸ã‘ãªã„ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å†…éƒ¨ã§ã‚„ã‚‹ã“ã¨ãŒå¤šã„
  + ç¶™ç¶šé–¢ä¿‚ãªã—ã«ä¸­é–“å½¢å¼ã¨ã—ã¦æ¡ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„
* é–¢æ•°å®šç¾©/å‘¼ã³å‡ºã—ä»¥å¤–ã«ã‚‚è«¸ã€…ã®æ§‹æ–‡ã¨ã‹ã«å¯¾ã—ã¦ã‚‚å®šç¾©ãŒå¿…è¦

===
# CPSå¤‰æ›
----------

Q. Common Lispã ã¨ã„ãã¤ã®æ§‹æ–‡ã«å¯¾ã—ã¦å®šç¾©ãŒå¿…è¦?

1. 1ã¤
2. 26ã¤
3. 42ã¤
4. ç„¡æ•°


===
# CPSå¤‰æ›
----------

A. 26ã¤ (ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ 25+funcall)

===
# Common Lispã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–
--------------------------

* ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã¨å‘¼ã°ã‚Œã‚‹
* ä»•æ§˜ã§25å€‹å®šã‚ã‚‰ã‚Œã¦ã„ã‚‹
* [CLHS: Section 3.1.2.1.2.1](http://www.lispworks.com/documentation/HyperSpec/Body/03_ababa.htm)
* ã“ã®ä¸­ã«é–¢æ•°å®šç¾©ã ã¨ã‹ä¾‹å¤–ã ã¨ã‹ã¯å…¥ã£ã¦ã„ãªã„
  + ãƒã‚¯ãƒ­ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹

===
# ãƒã‚¯ãƒ­
--------

* æ§‹æ–‡æœ¨ to æ§‹æ–‡æœ¨(Så¼to Så¼)å¤‰æ›å™¨( = æ™®é€šã®Lispã®é–¢æ•°)
* æ–°ã—ã„æ§‹æ–‡ã‚’ä½œã‚Œã‚‹
* CPSå¤‰æ›ã¯?????

===
# `macroexpand`
-------------

* [CLHS: Function MACROEXPAND, MACROEXPAND-1](http://clhs.lisp.se/Body/f_mexp_.htm)
* ãƒã‚¯ãƒ­ã‚’æ‰‹å‹•å±•é–‹ã™ã‚‹é–¢æ•°
* é›‘ã«ã„ã†ã¨æ™®æ®µpre-orderãªãƒã‚¯ãƒ­å±•é–‹ã‚’in-orderã‚„post-orderã«ã™ã‚‹æ™‚ã«ä½¿ã†
* æœ¬æ¥ã¯ã‚ã¾ã‚Šä½¿ã„ãŸããªã„
  + å‡¦ç†ç³»ã®å±•é–‹å™¨ã«ä»»ã›ãŸæ–¹ãŒé–“é•ã„ãŒå°‘ãªã„
* ã“ã‚Œã§ãƒã‚¯ãƒ­ã‚’æ’ã—ãŸãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã®Common Lispã®æ§‹æ–‡æœ¨ã«ã‚¢ã‚¯ã‚»ã‚¹å‡ºæ¥ã‚‹

===
# cl-cont
---------

* ä¸Šè¨˜ã®ã“ã¨ã‚’å…¨ã¦ã‚„ã£ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒª
* ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã¨ã„ã†ã‹å”¯ä¸€ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
* [Common Lispã§é™å®šç¶™ç¶šã¨éŠã¶ | Îºeenã®Happy HacÎºing Blog](http://keens.github.io/slide/Common_Lispdegenteikeizokutoasobu_/)

===
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;ã€Œshift/resetãŒã‚ã‹ã‚‰ãªã„æ™‚ã«ã‚ã’ã‚‹å£°ã€&lt;/p&gt;&amp;mdash; ã‹ãš(åŸææ–™ã«å°éº¦ç²‰ã‚’å«ã‚€) (@kazzna) &lt;a href=&#34;https://twitter.com/kazzna/status/674026894602309632&#34;&gt;2015å¹´12æœˆ8æ—¥&lt;/a&gt;&lt;/blockquote&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# cl-contã®ä½¿ç”¨ä¾‹

``` common-lisp
(with-call/cc
  (+ 1 (call/cc
        (lambda (k)
          (funcall k 2)))))
```

===
# cl-contã®ä½¿ç”¨ä¾‹

``` common-lisp
(FUNCALL
 (LAMBDA (&amp;OPTIONAL #:G542 &amp;REST #:G543)
   (DECLARE (IGNORABLE #:G542))
   (DECLARE (IGNORE #:G543))
   (FUNCALL
    (LAMBDA (&amp;OPTIONAL #:G544 &amp;REST #:G545)
      (DECLARE (IGNORABLE #:G544))
      (DECLARE (IGNORE #:G545))
      (FUNCALL (LAMBDA (K) (FUNCALL K 1))
               (LAMBDA (&amp;OPTIONAL #:G546 &amp;REST #:G547)
                 (DECLARE (IGNORABLE #:G546))
                 (DECLARE (IGNORE #:G547))
                 (FUNCALL (CL-CONT::FDESIGNATOR-TO-FUNCTION/CC #:G542) #&#39;VALUES
                          #:G544 #:G546))))
    1))
 #&#39;+)
```


===
# cl-contã¸ã®ä¸æº€
-----------------

* é…ã„
* lambdaå¤šã„ã€‚
  + å¤šåˆ†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¨ç›¸æ€§ãŒæ‚ªã„
* lambdaç¦æ­¢ãŠã˜ã•ã‚“ã¨åˆ†ã‹ã‚Šã‚ãˆã‚‹

===
# cl-fast-cont


&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# cl-fast-cont
--------------

* [KeenS/cl-fast-cont: faster partial contiuation library of common lisp](https://github.com/KeenS/cl-fast-cont)
* ã¨ã‚Šã‚ãˆãšãƒ¬ãƒã‚¸ãƒˆãƒªä½œã£ãŸã ã‘
* å®Œæˆã•ã›ãŸã„â€¦

===
# ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ1
&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# SSAä½¿ã†
---------

* CPSã¨ç­‰ä¾¡
* ã ã‘ã©SSAã ã£ãŸã‚‰lambdaå‡ºã¦ã“ãªã„
* Common Lispãªã‚‰gotoã‚ã‚‹ã—ã„ã‘ã‚‹ã‚“ã˜ã‚ƒã­ï¼Ÿ

===
```common-lisp
(let (x y z)
 (tagbody
    (setq x 1)
  :call/cc
    (setq y 1)
    (setq z (+ x y))))
```


===
# å•é¡Œ
-------

* ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¹ã‚¿ãƒƒã‚¯ã¨ã¯åˆ¥ã«è‡ªåˆ†ã§ã‚¹ã‚¿ãƒƒã‚¯ä½œã‚‰ãªã„ã¨ã„ã‘ãªã„
  + ä¾‹å¤–ã¨ã‹ã§ã‚¹ã‚¿ãƒƒã‚¯å·»ãæˆ»ã•ã‚Œã‚‹ã¨ã¤ã‚‰ã„
* gotoã®ã‚¿ã‚°ã‚’tagbodyã®å¤–ã«æŒã¡å‡ºã›ãªã„(=ç¶™ç¶šã‚’å¤–ã«æŒã¡å‡ºã›ãªã„)
* å¤‰æ•°ã‚’æº–å‚™ã™ã‚‹ã®ãŒé¢å€’orãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å½±éŸ¿ã—ãã†
* ãã‚‚ãã‚‚tagbodyãã“ã¾ã§æŸ”è»Ÿã˜ã‚ƒãªã‹ã£ãŸ
* é–¢æ•°ãŒæ¶ˆã—é£›ã¶

===
# ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ2
&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# SSA+CPS
---------

* SSAã¨CPSã‚’çµ„ã¿åˆã‚ã›ã‚‹
* åŸºæœ¬ã¯SSA
* ã‚¹ã‚¿ãƒƒã‚¯ã‚’ä½¿ã†/ç¶™ç¶šãŒå¿…è¦ãªæ‰€ã§ã ã‘CPS
===
# å•é¡Œ
-------

* SSAã®éƒ¨åˆ†æ„å‘³ãªãã­ï¼Ÿ
* ãã‚‚ãã‚‚ç¶™ç¶šã‚’å–ã‚Šå‡ºã™ã®ãŒç›®çš„ãªã®ã§é–¢ä¿‚ãªã„æ‰€ã§å¤‰æ›ã—ã¦ã‚‚æ„å‘³ãŒãªã„

===
# ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ3
&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# Selective CPS
----------------

* ç¶™ç¶šãŒå¿…è¦ãªéƒ¨åˆ†ã§ã®ã¿å¤‰æ›
* 2 pass transformation
* [A Selective CPS Transformation](http://www.sciencedirect.com/science/article/pii/S1571066104809691)
===

```common-lisp
(with-call/cc
  (let ((x 3) y)
    (setq y (* x x))
    (+ 1 (call/cc
          (lambda (k)
            (funcall k y))))))

```

===

```common-lisp
(with-call/cc
  (let ((x 3) y)
    (setq y (* x x))
    (+ 1 @(call/cc
          (lambda (k)
            (funcall k y))))))

```

===

```common-lisp
(with-call/cc
  (let ((x 3) y)
    (setq y (* x x))
    @(+ 1 @(call/cc
          (lambda (k)
            (funcall k y))))))

```

===

```common-lisp
(with-call/cc
  @(let ((x 3) y)
    (setq y (* x x))
    @(+ 1 @(call/cc
          (lambda (k)
            (funcall k y))))))

```

===
# ãã‚‚ãã‚‚Common Lispã®ã¤ã‚‰ã„è©±
-------------------------------
* ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ãŒå‹•çš„
  + catch, block, tagbody
  + special variable
  + å¤‰æ›ã¯é™çš„ãªã®ã§ã©ã†é ‘å¼µã£ã¦ã‚‚è¿½ã„ä»˜ã‹ãªã„
* multiple valueãŒé¢å€’


===
# ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯!!
----------------

``` common-lisp
(block name
 (let ((f
        (lambda (x) (return-from name x))))
   (with-call/cc
       (funcall
        f
        (call/cc
         (lambda (k)
           (funcall k 2)))))))
```

===
# ã‚¹ãƒšã‚·ãƒ£ãƒ«å¤‰æ•°
---------------

* Common Lispã«ã¯ãƒ¬ã‚­ã‚·ã‚«ãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã¨ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚¹ã‚³ãƒ¼ãƒ—ä¸¡æ–¹ã‚ã‚‹
* CPSå¤‰æ›ã™ã‚‹ã¨ç¶™ç¶šã®å…¨ã¦ãŒã‚¹ã‚³ãƒ¼ãƒ—ä¸‹ã«å…¥ã‚‹
  + é–¢æ•°ã®å‘¼ã³å‡ºã—é–¢ä¿‚ãŒæœ¨ã ã£ãŸã®ãŒç·šå‹ã«ãªã‚‹
  + ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚¹ã‚³ãƒ¼ãƒ—ã ã¨å›°ã‚‹
===
![CPSå‰ã®AST](/images/cps/pre-cps.png)


===
![CPSå¾Œã®AST](/images/cps/post-cps.png)


===
```
(defvar *x* 1)
(with-call/cc
  (progn
    (let ((*x* 2))
      (call/cc ..)
      (format t &#34;~a~%&#34; *x*)) ; *x* = 2
    (format t &#34;~a~%&#34; *x*))) ; *x* = 1

```

===

```
(defvar *x* 1)
(with-call/cc
  (progn
    (let ((*x* 2))
      (...
       (lambda (ignore)
         ((lambda (ignore)
            (format t &#34;~a~%&#34; *x*)) ; *x* = 2!!
          (format t &#34;~a~%&#34; *x*))))))) ; *x* = 1
```

===
# å¤šå€¤
------

* Common Lispã®å¤šå€¤ã¯Goã¨é•ã£ã¦ç„¡è¦–å‡ºæ¥ã‚‹
* å¤‰æ›ãŒç©ºæ°—èª­ã‚€å¿…è¦ãŒã‚ã‚‹
* ä¸‹æ‰‹ã™ã‚‹ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å£Šã™
  1. æœ¬å½“ã¯å¤šå€¤ã‚’è¿”ã—ã¦ã‚‹ã®ã«å¤‰æ›ã§ç„¡è¦–ã•ã‚ŒãŸ
  2. æ„å›³çš„ã«ç„¡è¦–ã—ã¦ã‚‹ã®ã«å¤‰æ›ã§åŠ ãˆã‚‰ã‚ŒãŸ

===
# é–¢æ•°å®šç¾©ã¨å¼•æ•°ã®æ•°
-----------------

* **Selective** CPS
* é–¢æ•°ã‚’CPSå¤‰æ›ã™ã‚‹ã¨ãã¨ã—ãªã„æ™‚ãŒã‚ã‚‹
* å‘¼ã³å‡ºã™æ™‚ã«ã©ã£ã¡ã‹åˆ†ã‹ã‚“ãªãã­ï¼Ÿ
  1. çµ±ä¸€çš„ã«å¤‰æ›ã—ã¦ã—ã¾ã†
  2. Selectiveã«å¤‰æ›ã—ã¦é–¢æ•°ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¤ã‘ã‚‹

-&gt; ã¾ã æ±ºã‚ãã‚Œã¦ãªã„

===
# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
----------------


&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—
-----------------
* ã¨ã‚Šãˆã‚ãšã®ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã§è¨ˆæ¸¬
  + Full CPSå¤‰æ›ã«å‰²ã¨ä¸åˆ©
  + ä½•ã‚‚è€ƒãˆãšã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨ã“ã†ãªã‚‹ã‚ˆã£ã¦ä¾‹
* Selective CPSã¯ä½•ã‚‚ã—ãªã„=æ™®é€šã®å®šç¾©ã¨åŒã˜


===
```common-lisp
(defun fib (n)
  (if (&lt;= n 1)
      1
      (+ (fib (- n 1)) (fib (- n 2)))))
```

``` common-lisp
(defun/cc fib-cont (n)
  (if (&lt;= n 1)
      1
      (+ (fib-cont (- n 1)) (fib-cont (- n 2)))))
```

===
# Selective


```
Evaluation took:
  1.517 seconds of real time
  1.516000 seconds of total run time (1.516000 user, 0.000000 system)
  99.93% CPU
  4,388,993,782 processor cycles
  0 bytes consed
```

===
# Full

```
Evaluation took:
  18.347 seconds of real time
  18.576000 seconds of total run time (18.248000 user, 0.328000 system)
  [ Run times consist of 1.396 seconds GC time, and 17.180 seconds non-GC time. ]
  101.25% CPU
  53,149,416,888 processor cycles
  22,922,853,904 bytes consed
```
===
# ã‚³ãƒ«ãƒ¼ãƒãƒ³
------------

* ãã“ã¾ã§Full CPSã«ä¸åˆ©ã˜ã‚ƒãªã„
* å‰²ã¨å®Ÿç”¨ã—ãã†ãªä¾‹
* Selective CPSã¯å°‘ã—ã ã‘ãƒ©ãƒ ãƒ€ãŒå°‘ãªã„

===
# Selective

``` common-lisp
(let (c)
  (setf c ((lambda ()
             (write-line &#34;in thread A 1&#34;)
             (lambda ()
              (write-line &#34;in thread A 2&#34;)
              (lambda ()
                (write-line &#34;in thread A 3&#34;))))))
  (write-line &#34;in main thread 1&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 2&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 3&#34;))
```


===
# full

```common-lisp
(let (c)
  (setf c (with-call/cc
            (write-line &#34;in thread A 1&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 2&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 3&#34;)))
  (write-line &#34;in main thread 1&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 2&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 3&#34;))
```
===
# Selective

```
Evaluation took:
  0.905 seconds of real time
  0.904000 seconds of total run time (0.904000 user, 0.000000 system)
  99.89% CPU
  2,617,396,241 processor cycles
  0 bytes consed

```

===
# full

```
Evaluation took:
  1.272 seconds of real time
  1.272000 seconds of total run time (1.272000 user, 0.000000 system)
  100.00% CPU
  3,681,362,466 processor cycles
  0 bytes consed
```

===
# ã¾ã¨ã‚
--------

* é™å®šç¶™ç¶šä¾¿åˆ©ã ã‚ˆ
* ãƒã‚¯ãƒ­ã‚’ä½¿ãˆã°CPSå¤‰æ›ã§é™å®šç¶™ç¶šå®Ÿè£…å‡ºæ¥ã‚‹ã‚ˆ
* ã§ã‚‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚„è¨€èªã®å•é¡Œã‚‚ã‚ã‚‹ã‚ˆ
* Selective CPSã‚’ä½¿ãˆã°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å•é¡Œè§£æ±ºå‡ºæ¥ã‚‹ã‚ˆ

&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>readlineã®ä½œã‚Šæ–¹</title>
      <link>/blog/2016/02/14/readlinenotsukurikata</link>
      <pubDate>Sun, 14 Feb 2016 22:37:35 +0900</pubDate>
      
      <guid>/blog/2016/02/14/readlinenotsukurikata</guid>
      <description>&lt;p&gt;Îºeenã§ã™ã€‚ãªã‚“ã‹ä¼ç·šã£ã½ã„ã‚‚ã®å›åã—ã¨ã„ãŸæ–¹ãŒè‰¯ã„ã‹ãªã¨æ€ã£ã¦Linuxã£ã½ã„è©±ã§ã‚‚ã€‚
&lt;/p&gt;

&lt;p&gt;readlineã£ã¦ä¾¿åˆ©ã§ã™ã‚ˆã­ã€‚
ã§ã‚‚Cã§æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‹ã‚‰ä»–ã®è¨€èªã‹ã‚‰ä½¿ãŠã†ã¨æ€ã†ã¨é¢å€’ã ã£ãŸã‚Šä½¿ãˆãªã‹ã£ãŸã‚ŠGPLv3ã®æ‰€ç‚ºã§ä½¿ãˆãªã‹ã£ãŸã‚Šã—ã¾ã™ã‚ˆã­ã€‚
ãã“ã§ã‚ã‚‹ç¨‹åº¦POSIXã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ‰±ã‚ã›ã¦ãã‚Œã‚‹è¨€èªã§ã®readlineã®ä½œã‚Šæ–¹ã§ã‚‚ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰&#34;&gt;ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰&lt;/h1&gt;

&lt;p&gt;readlineã®ä»•çµ„ã¿è‡ªä½“ã¯ç°¡å˜ã§ã€å…¨ã¦ã®æ–‡å­—å…¥åŠ›ã‚’å—ã‘å–ã£ã¦ã€&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;readlineã®åˆ¶å¾¡ã‚­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãªã‚‰æŒ‡å®šã®åˆ¶å¾¡ã‚’è¡Œãªã†&lt;/li&gt;
&lt;li&gt;æ™®é€šã®æ–‡å­—ãªã‚‰ãã®ã¾ã¾ç”»é¢ã«è¡¨ç¤ºã™ã‚‹&lt;/li&gt;
&lt;li&gt;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãªã‚‰ &lt;code&gt;^W&lt;/code&gt; ãªã©ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—è¡¨ç¤ºã™ã‚‹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã“ã‚Œã ã‘ã§ã™ã€‚ã—ã‹ã—ãã†ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ã‚ãªãŸã®ãŠæ°—ã«å…¥ã‚Šã®è¨€èªã§ &lt;code&gt;readchar&lt;/code&gt; ã£ã½ã„é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨åˆ†ã‹ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ä¸€æ–‡å­—å…¥åŠ›ã—ãŸã ã‘ã§ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å…¥åŠ›æ–‡å­—ãŒæ¸¡ã•ã‚Œãªã„ã€‚ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦åˆã‚ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® &lt;code&gt;readchar&lt;/code&gt; é–¢æ•°ãŒè¿”ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;å…¥åŠ›ã—ãŸæ–‡å­—ãŒãã®ã¾ã¾ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ã•ã‚Œã‚‹ã€‚ã™ãªã‚ã¡ã€ &lt;code&gt;â†&lt;/code&gt; ã‚’æŠ¼ã—ã¦ã‚‚ &lt;code&gt;^[[D&lt;/code&gt; ãŒå…¥åŠ›ã•ã‚Œã¦ã—ã¾ã„ã€åˆ¶å¾¡ä¸Šä¸éƒ½åˆã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç§ã¯æ˜”ã¯ã“ã‚Œã‚‰ã®æŒ™å‹•ãŒé©åˆ‡ãªé–¢æ•°ãŒãªã„ã‹ã‚‰ã ã¨æ€ã£ã¦ã¾ã—ãŸã€‚ã—ã‹ã—ã€ãã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ã“ã®ã‚ˆã†ãªæŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è²¬ä»»ã§ã‚‚ã§ã‚‚ã‚·ã‚§ãƒ«ã®è²¬ä»»ã§ã‚‚ãªãã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®è²¬ä»»ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¯å¤šå½©ãªãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚Šã€ãã‚Œã«ã‚ˆã£ã¦æŒ™å‹•ãŒå¤‰ã‚ã‚‹ã®ã§ã™ã€‚
ã¤ã¾ã‚Šã€1.ã®æŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã®æŒ™å‹•ã€2.ã®æŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®æŒ™å‹•ãªã®ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;tcgetattr-ã¨-tcsetattr&#34;&gt;&lt;code&gt;tcgetattr&lt;/code&gt; ã¨ &lt;code&gt;tcsetattr&lt;/code&gt;&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ å´ã‹ã‚‰å¤‰æ›´å‡ºæ¥ã¾ã™ã€‚ãã‚Œã‚’è¡Œãªã†ã®ãŒ &lt;code&gt;tcgetattr(3)&lt;/code&gt; ã¨ &lt;code&gt;tcsetattr(3)&lt;/code&gt; ã§ã™ã€‚
ã–ã£ãã‚Šè¨€ã†ã¨ &lt;code&gt;tcgetattr&lt;/code&gt; ã§ç¾åœ¨ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–å¾—ã—ã¦ã€ãã‚Œã‚’æ‰€æœ›ã®ãƒ¢ãƒ¼ãƒ‰ã«æ›¸ãæ›ãˆã€ &lt;code&gt;tcsetattr&lt;/code&gt; ã‚’ä½¿ã£ã¦åæ˜ å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›ã¯ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’offã«ã—ãŸã„ã®ã§ã™ã”ã„é›‘ãªã‚³ãƒ¼ãƒ‰ã ã¨ã“ã†æ›¸ã‘ã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(require &#39;sb-posix)
(let* ((stdin 0)
       (termios (sb-posix:tcgetattr stdin))
       (lflag (sb-posix:termios-lflag termios)))
  (setf lflag (logand lflag (lognot sb-posix:icanon)))
  (setf lflag (logand lflag (lognot sb-posix:echo)))
  (setf (sb-posix:termios-lflag termios) lflag)
  (sb-posix:tcsetattr stdin sb-posix:tcsadrain termios))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã—ã‹ã—ã€ã“ã‚Œã¯é›‘ã™ãã¾ã™ã€‚ãªãœãªã‚‰readlineã‚’å®Ÿè¡Œã—çµ‚ã‚ã£ãŸå¾Œã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å…ƒã®çŠ¶æ…‹ã«å¾©å…ƒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚
ãã†ã—ãªã„ã¨readlineã™ã‚‹ã¤ã‚‚ã‚Šã®ãªã„å…¥åŠ›é–¢æ•°ãŒäºˆæœŸã›ã¬æŒ™å‹•ã‚’ã™ã‚‹ã§ã—ã‚‡ã†ã€‚
ã‚ã‚‹ã„ã¯Lispãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã—ãŸå¾Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¾ã§å½±éŸ¿ãŒåŠã³ã¾ã™ã€‚
ãªã®ã§ &lt;strong&gt;å¿…ãš&lt;/strong&gt; å‡¦ç†ãŒçµ‚ã‚ã£ãŸã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®çŠ¶æ…‹ã‚’å¾©å…ƒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€Common Lispã§ã¯ã“ã®ã€Œå¿…ãšã€ã¯ &lt;code&gt;unwind-protect&lt;/code&gt; ã‚’ä½¿ã£ãŸ &lt;code&gt;with-&lt;/code&gt; ãƒã‚¯ãƒ­ã§å®Ÿç¾ã™ã‚‹ã®ãŒå¸¸å¥—æ‰‹æ®µã§ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã¯ã“ã®ã‚ˆã†ã«ãªã‚‹ã§ã—ã‚‡ã†ã‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro with-readline-mode (&amp;amp;body body)
  (let ((stdin       (gensym &amp;quot;stdin&amp;quot;))
        (old-termios (gensym &amp;quot;old-termios&amp;quot;))
        (new-termios (gensym &amp;quot;new-termios&amp;quot;))
        (lflag       (gensym &amp;quot;lflag&amp;quot;)))
    `(let* ((,stdin 0)
            (,old-termios (sb-posix:tcgetattr ,stdin))
            (,new-termios (sb-posix:tcgetattr ,stdin))
            (,lflag (sb-posix:termios-lflag ,new-termios)))
       (unwind-protect
            (progn
              (setf ,lflag (logand ,lflag (lognot sb-posix:icanon)))
              (setf ,lflag (logand ,lflag (lognot sb-posix:echo)))
              (setf (sb-posix:termios-lflag ,new-termios) ,lflag)
              (sb-posix:tcsetattr ,stdin sb-posix:tcsadrain ,new-termios)
              ,@body)
        (sb-posix:tcsetattr ,stdin sb-posix:tcsadrain ,old-termios)))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã§&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(with-readline-mode
  (format t &amp;quot;~a~%&amp;quot; (read-char)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãªã©ã¨ã™ã‚‹ã¨ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰ãŒå¤‰ã‚ã£ãŸã“ã¨ãŒå®Ÿæ„Ÿå‡ºæ¥ã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;å°šã€ç¹°ã‚Šè¿”ã™ã¨ã“ã‚Œã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®è¨­å®šã®è©±ãªã®ã§Emacså†…ã‹ã‚‰è©¦ãã†ã¨ã—ã¦ã‚‚æ­£å¸¸ã«å‹•ä½œã—ãªã„ç­ˆã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹&#34;&gt;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€Common Lispã®æ¨™æº–ã«ãªã„æ‹¡å¼µæ©Ÿèƒ½ãŒå¿…è¦ãªã®ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´ã ã‘ã§ã€ã‚ã¨ã¯å¥½ãå‹æ‰‹å‡ºæ¥ã‚‹ã®ã§ã™ãŒç§ã‚‚å°‘ã—åµŒã£ãŸéƒ¨åˆ†ãŒã‚ã‚‹ã®ã§ãã“ã ã‘ã€‚&lt;/p&gt;

&lt;p&gt;readlineã«æ¬²ã—ã„æ©Ÿèƒ½ã¯ãªã‚“ã§ã—ã‚‡ã†ã‹ã€‚è‰²ã€…ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ã¾ãšã¯ &lt;code&gt;â†&lt;/code&gt; ã€ &lt;code&gt;â†’&lt;/code&gt; ã§ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã‚’ã—ãŸã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚
å®Ÿã¯ã“ã‚ŒãŒå¤§è½ã—ç©´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;â†&lt;/code&gt; ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¯ãªã‚“ã¨3æ–‡å­—å…¥åŠ›ã•ã‚Œã¾ã™ã€‚ã™ãªã‚ã¡ã€ Escæ–‡å­—ã® &lt;code&gt;^[&lt;/code&gt; ã€æ™®é€šã®ASCIIæ–‡å­—ã® &lt;code&gt;[&lt;/code&gt; ã€ãã—ã¦å¤§æ–‡å­—ã® &lt;code&gt;D&lt;/code&gt; ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã—ã¦ã‚«ãƒ¼ã‚½ãƒ«ã®ç§»å‹•æ–‡å­—ã‚’å—ã‘ã¦ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç§»å‹•ã™ã‚‹ã«ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãã®ã¾ã¾Escæ–‡å­—ã® &lt;code&gt;^[&lt;/code&gt; ã€æ™®é€šã®ASCIIæ–‡å­—ã® &lt;code&gt;[&lt;/code&gt; ã€ãã—ã¦å¤§æ–‡å­—ã® &lt;code&gt;D&lt;/code&gt; ã‚’å…¥åŠ›ã—ã¦ã‚ã’ã‚Œã°å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãªã®ã§ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defconstant left &amp;quot;[d&amp;quot;)
(defconstant right &amp;quot;[c&amp;quot;)

(defun left ()
  (format t &amp;quot;~a&amp;quot; left)
  (force-output))

(defun right ()
  (format t &amp;quot;~a&amp;quot; right)
  (force-output))


(defun readline ()
  (let ((line &#39;()))
    (flet ((self-insert (char)
             (format t &amp;quot;~c&amp;quot; char)
             (setf line (cons char line))
             (force-output)))
      (with-readline-mode
       (loop
          (let* ((char (read-char))
                 (code (char-code char)))
            (case code
              ; escape
              ((#b11011)
               (let* ((char (read-char))
                      (code (char-code char)))
                 ;; (write-line &amp;quot;called&amp;quot;)
                 ;; (format t &amp;quot;~a~%&amp;quot; char)
                 ;; (format t &amp;quot;~a~%&amp;quot; code)
                 (case char
                   ((#\[)
                    (let* ((char (read-char))
                           (code (char-code char)))
                      (case char
                        ((#\c) (right))
                        ((#\d) (left)))))
                   ((t)
                    (self-insert #\escape)
                    (self-insert char)))))
              ((#b1010)
               (return-from readline (coerce (reverse line) &#39;string)))
              (t (self-insert char)))))))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;case&lt;/code&gt; ã‚’ãƒã‚¹ãƒˆã—ã¦ã„ãã®ã¯ãƒ€ãƒ«ã„ã—æ‹¡å¼µæ€§ãŒãªã„ã®ã§ç¾å®Ÿçš„ã«ã¯trieæœ¨ã‚’ä½¿ã†ã“ã¨ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒå˜ç´”ã«ã¯ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§readlineã‚’ä½œã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s Happy HacÎºking!&lt;/p&gt;

&lt;h1 id=&#34;ä»˜éŒ²a-ä¼ç·š&#34;&gt;ä»˜éŒ²A: ä¼ç·š&lt;/h1&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;é©å½“ã«é­šã¨é‡èœç‚’ã‚ãŸã‚‰ã‚ªã‚µãƒ¬ã£ã½ããªã£ãŸ &lt;a href=&#34;https://t.co/9IIzhIGjzd&#34;&gt;pic.twitter.com/9IIzhIGjzd&lt;/a&gt;&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/698821538686984192&#34;&gt;2016, 2æœˆ 14&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; é­šã¯ä½•ï¼Ÿã‚¿ãƒ©ï¼Ÿã ã£ãŸã‚‰å­£ç¯€ç‰©ã ã—ã€æ—¬ã®é±ˆã¨é‡èœã®ã‚½ãƒ†ãƒ¼ã€è©³è§£Linuxã‚«ãƒ¼ãƒãƒ«ã‚’æ·»ãˆã¦ã€‚ã¨å‘½åã—ã‚ˆã†&lt;/p&gt;&amp;mdash; Shinnosuke Takeda (@cnosuke) &lt;a href=&#34;https://twitter.com/cnosuke/status/698824048319410176&#34;&gt;2016, 2æœˆ 14&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h1 id=&#34;ä»˜éŒ²b-pure-rubyãªreadlineã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&#34;&gt;ä»˜éŒ²B: Pure Rubyãªreadlineã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h1&gt;

&lt;p&gt;åŠªåŠ›ãŒå¿…è¦ã¨ã„ã†ã“ã¨ãŒèª­ã¿è§£ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/ConnorAtherton/rb-readline/blob/master/lib/rbreadline.rb&#34;&gt;rb-readline/rbreadline.rb at master Â· ConnorAtherton/rb-readline&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Common Lispã§é«˜é€Ÿè¡Œåˆ—æ¼”ç®—</title>
      <link>/blog/2016/02/04/common_lispdekousokugyouretsuenzan</link>
      <pubDate>Thu, 04 Feb 2016 23:47:34 +0900</pubDate>
      
      <guid>/blog/2016/02/04/common_lispdekousokugyouretsuenzan</guid>
      <description>&lt;p&gt;Îºeenã§ã™ã€‚Common Lispã‹ã‚‰ç·šå½¢ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ãƒã‚¹ãƒˆã§æ¯”è¼ƒã«Common Lispã®ã‚³ãƒ¼ãƒ‰ãŒå‡ºã•ã‚Œã¦ã„ãŸã®ã§ã™ãŒã‚‚ã†å°‘ã—æ”¹è‰¯å‡ºæ¥ãã†ã ã£ãŸã®ã§å°‘ã—ã°ã‹ã‚Šé«˜é€ŸåŒ–ã—ã¦ã¿ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;ãã®ãƒã‚¹ãƒˆã¯ã“ã¡ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://d.hatena.ne.jp/masatoi/20160204/1454519281&#34;&gt;Common Lispã§è¡Œåˆ—æ¼”ç®—: LLA(Lisp Linear Algebra)ã‚’ä½¿ã† - ç¿¡ç¿ ã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«åµã‚’ç”Ÿã‚€ã‹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ§å€’çš„ã«Common LispãŒé…ã„ã§ã™ã­ã€‚ãã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã‹ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://tanakahx.hatenablog.com/entry/2015/09/25/070000&#34;&gt;Python (NumPy) ã¨ Common Lisp (LLA) ã§è¡Œåˆ—ç©ã®å®Ÿè¡Œé€Ÿåº¦ã‚’æ¯”è¼ƒã™ã‚‹ - ä¸ç¢ºå®šç‰¹ç•°ç‚¹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¡Œåˆ—è¨ˆç®—(GEMM)éƒ¨åˆ†ã‚’æŠœãå‡ºã™ã¨ã“ã†ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun simple-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))
      (dotimes (row rows)
        (dotimes (col cols)
          (dotimes (k cols)
            (incf (aref result row col)
                  (* (aref ma row k) (aref mb k col))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã‚’&lt;code&gt;*N*&lt;/code&gt; = 256, ã§100å›ç¹°ã‚Šè¿”ã—ãŸã‚‰&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   4.688 seconds of real time
;;   4.692000 seconds of total run time (4.688000 user, 0.004000 system)
;;   100.09% CPU
;;   13,564,728,093 processor cycles
;;   26,216,000 bytes consed

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã®ã“ã¨ã€‚ã¾ã‚ã€ã¾ã é«˜é€ŸåŒ–ã®ä½™åœ°ã¯ã‚ã‚Šãã†ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹&#34;&gt;ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹&lt;/h1&gt;

&lt;p&gt;å†…å´ã®ãƒ«ãƒ¼ãƒ—ã‚’ã¿ã‚‹ã¨ã“ã†ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;          (dotimes (k cols)
            (incf (aref result row col)
                  (* (aref ma row k) (aref mb k col))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;incf&lt;/code&gt;ã‚’ã°ã‚‰ã™ã¨ã“ã†ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;          (dotimes (k cols)
            (setf (aref result row col)
                  (+ (aref result row col) (* (aref ma row k) (aref mb k col)))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å€¤ã¨ã—ã¦å‚ç…§ã—ã¦ã„ã‚‹æ–¹ã®&lt;code&gt;(aref result row col)&lt;/code&gt;ã¯&lt;code&gt;k&lt;/code&gt;ã«ä¾å­˜ã—ãªã„ã®ã§ãƒ«ãƒ¼ãƒ—ã®å¤–ã«å‡ºã›ã¾ã™ã€‚
æ›¸ãè¾¼ã‚“ã§ã„ã‚‹æ–¹ã¯å ´æ‰€ã ã‹ã‚‰ä»•æ–¹ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun caching-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((cell (aref result row col)))
           (dotimes (k cols)
             (setf (aref result row col)
              (+ cell (* (aref ma row k) (aref mb k col)))))
           )))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ã¨ã‚‹ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; 3.971 seconds of real time
;; 3.972000 seconds of total run time (3.972000 user, 0.000000 system)
;; 100.03% CPU
;; 11,491,319,119 processor cycles
;; 26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2016-02-28 è¿½è¨˜:&lt;/p&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã¨ã“ã‚ã€resultã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«kã¯ä½¿ã£ã¦ãªã„ã‘ã©ã€kãŒé€²ã‚€ã”ã¨ã«å¯¾è±¡ã®è¦ç´ ã¯å¤‰åŒ–ã—ã¦ã‚‹ã¯ãšãªã®ã§ã€ã“ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã—ã‹ãŸã¯ã¾ãšã„ã®ã§ã¯?&lt;/p&gt;&amp;mdash; goskevich (@gos_k) &lt;a href=&#34;https://twitter.com/gos_k/status/700622885933613056&#34;&gt;2016å¹´2æœˆ19æ—¥&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§ã“ã‚Œã¯é–“é•ã£ã¦ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°&#34;&gt;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€å…ˆç¨‹ã®å†…å´ã®ãƒ«ãƒ¼ãƒ—ã€ä»•äº‹ãŒå°‘ãªã„ã§ã™ã­ã€‚å°ã•ãªä»•äº‹ã‚’ãƒãƒãƒãƒãƒ«ãƒ¼ãƒ—ã—ã¦ã‚‹ã¨ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆãŒåµ©ã¿ã¾ã™ã€‚
1å›ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ä»•äº‹ã‚’å¢—ã‚„ã™ã¹ãã€ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’ã—ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ã‚³ãƒ”ãƒšã¯ãƒ€ãƒ«ã„ã®ã§ã¾ãšã¯ãƒã‚¯ãƒ­ã‚’ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro dotimes-unroll ((i n unroll) &amp;amp;body body)
  (let ((n_      (gensym &amp;quot;n&amp;quot;)))
    `(let ((,n_ ,n))
       (do ((,i 0))
           ((&amp;lt; ,n_ (the fixnum (+ ,unroll ,i)))
            (do ((,i ,i (the fixnum (1+ ,i))))
                ((&amp;lt; ,n_ (the fixnum (1+ ,i))))
              ,@body
              ))
         ,@(loop :repeat unroll :append (append body `((setq ,i (the fixnum (1+ ,i))))))))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°‘ã—è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(dotimes-unroll (i 10 3)
  (format t &amp;quot;~%~a&amp;quot;) i)
0
1
2
3
4
5
6
7
8
9
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ˆã—ã‚ˆã—ã€‚&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯ã“ã‚Œã‚’ä½¿ã£ã¦ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun loop-unroll-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((cell (aref result row col)))
           (dotimes-unroll (k cols 16)
             (setf (aref result row col)
              (+ cell (* (aref ma row k) (aref mb k col))))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ«æ•°ã¯16ãŒä¸€ç•ªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‡ºãŸã‚ˆã†ã§ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   3.847 seconds of real time
;;   3.848000 seconds of total run time (3.848000 user, 0.000000 system)
;;   [ Run times consist of 0.012 seconds GC time, and 3.836 seconds non-GC time. ]
;;   100.03% CPU
;;   11,128,993,432 processor cycles
;;   26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¾›ã†ã˜ã¦é€Ÿããªã£ã¦ã‚‹â€¦ã€‚å› ã¿ã«ã“ã‚Œã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯CPUã®å‘½ä»¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®çŠ¶æ³ã«ä¾å­˜ã™ã‚‹ã®ã§ä½•åº¦ã‹è©¦ã™ã¨ã“ã‚Œã‚ˆã‚Šé€Ÿã„ã‚¹ã‚³ã‚¢ãŒå‡ºã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Evaluation took:
  3.338 seconds of real time
  3.340000 seconds of total run time (3.332000 user, 0.008000 system)
  [ Run times consist of 0.020 seconds GC time, and 3.320 seconds non-GC time. ]
  100.06% CPU
  9,657,259,219 processor cycles
  26,248,768 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„&#34;&gt;ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€æœ€åˆã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãŸæ™‚ã«æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹æ–¹ã® &lt;code&gt;(aref result row col)&lt;/code&gt; ã¯å ´æ‰€ã ã‹ã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‡ºæ¥ãªã„ã¨ã„ã„ã¾ã—ãŸã€‚ã¾ã‚ã€ãã‚Œã¯æ­£ã—ã„ã®ã§ã™ãŒãƒ«ãƒ¼ãƒ—ã®ä¸­ã§æ¯å›æ›¸ãè¾¼ã‚€å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ¬ã‚¸ã‚¹ã‚¿ä¸Šã§è¨ˆç®—ã‚’æ¸ˆã¾ã›ã¦æœ€å¾Œã«æ›¸ãè¾¼ã‚“ã§ã‚ã’ã‚Œã°ååˆ†ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun on-register-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((res (aref result row col)))
           (dotimes-unroll (k cols 16)
             (setf res
                   (the single-float (+ res (* (aref ma row k) (aref mb k col))))))
           (setf (aref result row col) res))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   2.302 seconds of real time
;;   2.304000 seconds of total run time (2.300000 user, 0.004000 system)
;;   [ Run times consist of 0.008 seconds GC time, and 2.296 seconds non-GC time. ]
;;   100.09% CPU
;;   6,662,273,812 processor cycles
;;   26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ãŠï¼æ€¥ã«é€Ÿããªã‚Šã¾ã—ãŸã€‚ &lt;code&gt;(* 100 (- (/ 4.688 2.302) 1))&lt;/code&gt; â‰’ 103ã€ 100%è¿‘ã„é«˜é€ŸåŒ–ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãŠã‚ã‚Šã«&#34;&gt;ãŠã‚ã‚Šã«&lt;/h1&gt;

&lt;p&gt;ç‰¹ã«æ·±ã„æ„å‘³ã¯ãªã‹ã£ãŸã®ã§ã™ãŒãƒ‘ã‚¿ãƒ˜ãƒã«è¼‰ã£ã¦ã„ãŸã‚„ã¤ã‚’è©¦ã—ã¦ã¿ãŸãã¦éŠã‚“ã§ã¿ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;æ™®é€šã«è¡Œåˆ—è¨ˆç®—ã—ãŸã„ãªã‚‰ç·šå½¢ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒãƒ¼ãƒˆ&#34;&gt;ãƒãƒ¼ãƒˆ&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã®éƒ¨åˆ†ã‚’ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆã§èª¬æ˜ã—ã¾ã—ãŸãŒä»–ã«ã‚‚1ãƒ«ãƒ¼ãƒ—å†…ã®å‘½ä»¤æ•°ãŒå¢—ãˆã‚‹ã¨çµ„ã¿åˆã‚ã›ãƒ‘ã‚ºãƒ«ã®ãƒ”ãƒ¼ã‚¹ãŒå¢—ãˆã‚‹ã®ã§æœ€é©åŒ–ã•ã‚Œã‚„ã™ããªã‚Šã¾ã™ã€‚ã¾ã‚ã€SBCLã¯è¦—ãç©´æœ€é©åŒ–ã‚’ã»ã¨ã‚“ã©ã—ãªã„ã®ã§ã‚ã¾ã‚Šæ„å‘³ã‚ã‚Šã¾ã›ã‚“ãŒã€‚æ°—ã«ãªã‚‹æ–¹ã¯ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚&lt;/li&gt;
&lt;li&gt;ã“ã®ã‚ã¨ã€ &lt;code&gt;(aref mb k col)&lt;/code&gt; ãŒCPUã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡é§„ã«ã—ã¦ã„ã‚‹ã¨ã„ã†è©±ã‹ã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚ºæ¯ã«è¡Œã€åˆ—ã‚’åˆ†ã‘ã¦è¨ˆç®—ã™ã‚‹ã‚„ã‚Šæ–¹ã‚’ç´¹ä»‹ã—ã‚ˆã†ã¨ã—ãŸã®ã§ã™ãŒé€†ã«é…ããªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ä»˜éŒ²Aã«ã‚³ãƒ¼ãƒ‰ã‚’ç½®ã„ã¦ãŠãã¾ã™ã€‚ã†ãƒ¼ã‚€ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬å½“ã¯ã•ã‚‰ã«ã“ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ¯ã«ã‚¹ãƒ¬ãƒƒãƒ‰ã«è¨ˆç®—ã‚’æŠ•ã’ã¦ä¸¦åˆ—åŒ–ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§é«˜é€ŸåŒ–ã—ãªã‹ã£ãŸã®ã§èãˆã¦è«¦ã‚ã¾ã—ãŸã€‚&lt;/li&gt;
&lt;li&gt;ãƒ‘ã‚¿ãƒ˜ãƒçš„ã«ã¯SIMDã‚‚ä½¿ã†ã®ã§ã™ãŒæ·±å¤œã«è¿‘ä»˜ã„ã¦ãã¦é¢å€’ã«ãªã£ãŸã®ã§ã“ã®è¾ºã§ã‚„ã‚ã¾ã—ãŸã€‚Common Lisp(SBCL)ã‹ã‚‰SIMDå‘½ä»¤ã‚’ä½¿ã†ã«ã¯&lt;a href=&#34;http://keens.github.io/blog/2014/12/02/vopdeyou-bu/&#34;&gt;ç§ã®éå»ã®ã‚¨ãƒ³ãƒˆãƒª&lt;/a&gt;ã‚’å‚ç…§ã—ã¦ä¸‹ã•ã„ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ°—ã§è¡Œåˆ—è¨ˆç®—ã‚’ã—ãŸã„ãªã‚‰ä»Šå›ã® $O(n^3)$ ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã ã‘ã§ãªãStrassenã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„Coppersmith-Winogradã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚‚æ¤œè¨ã™ã¹ãã§ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;ä»˜éŒ²a&#34;&gt;ä»˜éŒ²A&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun segmented-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let* ((segment 16)
         (rows (array-dimension ma 0))
         (cols (array-dimension mb 1))
         (colseg (floor cols segment))
         ktmp coltmp
         k col
         )
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (ci colseg)
          (setf coltmp (the fixnum (* ci segment)))
          (dotimes (ki colseg)
            (setf ktmp (the fixnum (* ki segment)))
           (dotimes (cs segment)
             (setf col (the fixnum (+ coltmp cs)))
             (let ((res (aref result row col)))
               (dotimes (ks segment)
                 (setf k (the fixnum (+ ktmp ks)))
                 (setf res
                       (the single-float (+ res (* (aref ma row k) (aref mb k col))))))
               (setf (aref result row col) res))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>ãƒã‚¯ãƒ­ã«ã¤ã„ã¦æ•´ç†ã—ã¦ã¿ã‚‹</title>
      <link>/blog/2015/07/04/makuronitsuiteseirishitemiru</link>
      <pubDate>Sat, 04 Jul 2015 15:34:46 +0900</pubDate>
      
      <guid>/blog/2015/07/04/makuronitsuiteseirishitemiru</guid>
      <description>&lt;p&gt;ä½•æ•…LisperãŒãƒã‚¯ãƒ­ã«ã¤ã„ã¦èªã‚‹ã®ã‹ã€‚Lisperã¨è­°è«–ã—ã¦ã¿ã¦ã‚‚æº€è¶³ã®ã„ãç­”ã‚’å¾—ãŸäººã¯ãã‚“ãªã«ã„ãªã„ã¨æ€ã†ã€‚
ãã‚Œã¯Lisperè‡ªèº«ä¾¿åˆ©ã¨ã¯æ€ã£ã¦ã„ã¦ã‚‚ä½•ãŒä¾¿åˆ©ãªã®ã‹ã‚’æ„è­˜ã—ã¦ãªãã¦ä»–äººã«ä¸Šæ‰‹ãèª¬æ˜å‡ºæ¥ãªã„ã‹ã‚‰ã˜ã‚ƒãªã„ã‹ã¨æ€ã£ãŸã€‚
ã¡ã‚‡ã£ã¨æ€ã„ã¤ã„ãŸç¯„å›²ã§ã¾ã¨ã‚ã¦ã¿ã‚‹ã€‚

æœ€è¿‘ã§ã¯ãƒã‚¯ãƒ­ã‚·ã‚¹ãƒ†ãƒ ã‚’æŒã¤è¨€èªã¯çã—ããªã„ã€‚Rust, Scala, Template Haskell, Mirahãªã©ãªã©ã€‚æœ€åˆã«Common Lispã®ãƒã‚¯ãƒ­ã¨ä»–ã®è¨€èªã®ãƒã‚¯ãƒ­ã¨ã®é•ã„ã‚’å°‘ã—è€ƒãˆã¦ã¿ãŸã„ã€‚&lt;/p&gt;

&lt;h1 id=&#34;unless&#34;&gt;Unless&lt;/h1&gt;

&lt;p&gt;ã¾ãšã€unlessã‚’ãƒã‚¯ãƒ­ã§æ›¸ãã“ã¨ã‚’è€ƒãˆã¦ã¿ãŸã„ã€‚å˜ç´”ã«ifã«notã‚’ã¤ã‘ã‚Œã°ã„ã„ã€‚&lt;/p&gt;

&lt;p&gt;Common Lispã§ã¯ã“ã†ãªã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(if (not foo-p)
    bar)

(defmacro unless (cond then)
  `(if (not ,cond)
       ,then))

(unless foo-p
  bar)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Rustã ã¨ã“ã†ãªã‚‹ã ã‚ã†ã‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-rust&#34;&gt;
if ! isFoo {
    bar;
}

macro_rules! unless {
    ($cond:expr, $then:stmt) =&amp;gt; {{
        if ! $cond {
            $then
        }
    }};
}

unless!(isFoo, {
    bar;
})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ã‚‹ã„ã¯mirahã ã¨ã“ã†ãªã‚‹ã€‚unlessãŒäºˆç´„èªãªã®ã§_unlessã«ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;if ! isFoo
  bar
end

macro def _unless(cond, block:Block)
  quote{
    if ! `cond`
      `block.body`
    end
  }
end

_unless isFoo do
  bar
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¡ãªã¿ã«Cã ã¨ã“ã†å‡ºæ¥ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-C&#34;&gt;if(! is_foo)
  bar;

#define unless(cond) if(!(cond))

unless(is_foo)
  bar;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã•ã¦ã€ä¸Šã®ãƒã‚¯ãƒ­ãŸã¡ã‚’è¦‹æ¯”ã¹ã¦æ¬²ã—ã„ã€‚Common Lispã®ãƒã‚¯ãƒ­ã¨Cã®ãƒã‚¯ãƒ­ã¯é•å’Œæ„Ÿãªãæ–°ãŸãªåˆ¶å¾¡æ§‹é€ ã‚’ä½œã‚ŒãŸã®ã«å¯¾ã—ã¦Rustã¨Mirahã¯ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—ãŒå‰¥ãå‡ºã—ã«ãªã£ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§æ³¨æ„ã—ã¦æ¬²ã—ã„ã®ã¯Cã¯ã¨ã‚‚ã‹ãCommon Lispã€Rustã€Mirahã®ãƒã‚¯ãƒ­ã¯å…¨ã¦å¼•æ•°ã«å¿…è¦ãªæ§‹æ–‡æœ¨ã‚’ã¨ã£ã¦ãã®ã¾ã¾ç”¨æ„ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ã¦ã¯ã‚ã¦ã„ã‚‹ã ã‘ã ã€‚ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã«é•ã„ã¯ãªã„ã€‚
ä½•ãŒé•ã†ã‹ã¨ã„ã†ã¨ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—ã®æ§‹æ–‡ãŒåˆ¶å¾¡æ§‹é€ ã®æ§‹æ–‡ã¨åŒã˜ã‹é•ã†ã‹ã¨ã„ã†ç‚¹ã ã‘ã ã€‚ç§ã®çŸ¥ã‚‹ç¯„å›²ã§ã¯ãã®ã‚ˆã†ãªæ§‹æ–‡ã‚’ã—ãŸè¨€èªã¯Lispã—ã‹ãªã„ã€‚ã ã‹ã‚‰ã€ŒLispã®ã€ãƒã‚¯ãƒ­ãªã®ã ã€‚&lt;/p&gt;

&lt;p&gt;ã‚‚ã†ä¸€ã¤ã€‚ã©ã®ãƒã‚¯ãƒ­å®šç¾©ã‚‚ååˆ†ç›´æ„Ÿçš„ã«èª­ã‚ãŸã¨æ€ã†ã€‚ã“ã®ç¯„å›²ãªã‚‰ &lt;strong&gt;Så¼ã ã‹ã‚‰ãƒã‚¯ãƒ­ãŒç°¡å˜ã«ãªã‚‹ã¨ã„ã†ã“ã¨ã¯ãªã„&lt;/strong&gt; ã¨æ€ã†ã€‚åˆ¥ã«Så¼ã§ãªãã¦ã‚‚quasiquoteãŒã‚ã‚Œã°ååˆ†èª­ã¿æ˜“ã„ãƒã‚¯ãƒ­ãŒæ›¸ã‘ã‚‹ã€‚&lt;/p&gt;

&lt;h1 id=&#34;case&#34;&gt;Case&lt;/h1&gt;

&lt;p&gt;caseã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚ˆã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun fun1 (x)
  (let ((y (case x
             ((:foo) (hoge &amp;quot;foo&amp;quot;))
             ((:bar) (hoge &amp;quot;bar!&amp;quot;)))))
    ...))


(defun fun2 (x)
 (let ((y (case x
            ((:foo) (hoge &amp;quot;foo&amp;quot;))
            ((:baz) (hoge &amp;quot;baz!&amp;quot;)))))
   ...))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã®ã‚ˆã†ã«ä¼¼ãŸã‚ˆã†ãªã€ã—ã‹ã—å¾®å¦™ã«é•ã†caseãŒå¿…è¦ã«ãªã£ãŸã‚ˆã†ãªæ™‚ã«å¿…è¦ã ã‚ã†ã€‚ã“ã®æ™‚ã€&lt;code&gt;&#39;(:foo (hoge &amp;quot;foo&amp;quot;) :bar (hoge &amp;quot;bar!&amp;quot;))&lt;/code&gt;ã®ã‚ˆã†ã«ãƒªãƒ†ãƒ©ãƒ«ã§ãã®ã¾ã¾æ›¸ã„ã¦ã—ã¾ã£ã¦ã¯æŠ½è±¡åŒ–ã™ã‚‹æ„å‘³ãŒãªããªã‚‹ã€‚ä¾‹ãˆã°ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«Key-Valueãƒšã‚¢ã‚’å…¥ã‚Œã¦å¿…è¦ãªæ™‚ã«å…¥ã‚ŒãŸã‚Šå‰Šé™¤ã—ãŸã‚Šã™ã‚Œã°ã‚ˆã„ã€‚ãã®ã‚ˆã†ãªãƒã‚¯ãƒ­ã¯ã“ã†æ›¸ã‘ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro case-table (key hash)
  `(case ,key
     ,@(loop
          :for k :being :the :hash-key :of hash :using (hash-value v)
          :collect `((,k) ,v))))

(defparameter *table*)
(setf (gethash :foo *table*) &#39;(hoge &amp;quot;foo&amp;quot;))
(setf (gethash :bar *table*) &#39;(hoge &amp;quot;bar!&amp;quot;))

(defun fun1 (x)
  (let ((y (case-table x #.*table*)))
    ...))

(remhash :bar *table*)
(setf (gethash :baz &#39;(hoge &amp;quot;baz!&amp;quot;)))


(defun fun2 (x)
  (let ((y (case-table x #.*table*)))
    ...))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å—ã‘å–ã£ã¦ãƒªã‚¹ãƒˆã‚’è¿”ã™æ™®é€šã®loopãƒã‚¯ãƒ­ã®åŠ›ã‚’ãƒã‚¯ãƒ­å±•é–‹æ™‚ã«ã‚‚ä½¿ãˆã‚‹ã€‚ã¾ãŸã€ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯&lt;code&gt;&#39;(hoge &amp;quot;foo&amp;quot;)&lt;/code&gt;ãªã©ã®ãŸã ã®ãƒªã‚¹ãƒˆã‚’çªã£è¾¼ã‚“ã ãŒãã‚Œã‚’ãã®ã¾ã¾ASTã¨ã—ã¦ã‚‚ä½¿ã£ã¦ã„ã‚‹ã€‚
Common Lispã®ãƒã‚¯ãƒ­ã®ã‚‚ã†1ã¤ã®è‰¯ã„ã¨ã“ã‚ã¯ãƒã‚¯ãƒ­ã®å±•é–‹æ™‚ã«ã‚‚Common Lispã®æ©Ÿèƒ½ãŒãƒ•ãƒ«ã§ä½¿ãˆã‚‹ã¨ã“ã‚ã§ã‚ã‚Šã€ãƒã‚¯ãƒ­ã®å¼•æ•°ã«å—ã‘å–ã‚‹ã®ãŒæ§‹æ–‡æœ¨ã§ã‚ã‚Šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚‚ã‚ã‚‹Så¼ãªã¨ã“ã‚ã ã€‚ã“ã“ã§ã¯ &lt;strong&gt;Så¼ã®åŒå›³åƒæ€§ãŒé‡è¦ãªãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã«ãªã£ã¦ã„ã‚‹&lt;/strong&gt; ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;(case-table x #.*table*)&lt;/code&gt; ã§ä½¿ã£ã¦ã„ã‚‹ &lt;code&gt;#.&lt;/code&gt; ã¯ &lt;em&gt;ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­&lt;/em&gt; ã¨ã„ã£ã¦ãƒã‚¯ãƒ­å±•é–‹(ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚)ã‚ˆã‚Šå‰(ãƒªãƒ¼ãƒ‰æ™‚ã€æ§‹æ–‡è§£ææ™‚)ã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã ã€‚ã“ã®ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã¯eval-when-readã¨ã„ã£ã¦ãƒªãƒ¼ãƒ‰æ™‚ã«
å€¤ã‚’è©•ä¾¡ã™ã‚‹ã€‚ãã®çµæœã€&lt;code&gt;case-table&lt;/code&gt;ã«æ¸¡ã‚‹ã®ãŒ &lt;code&gt;&#39;*table*&lt;/code&gt;ã¨ã„ã†ã‚·ãƒ³ãƒœãƒ«ã§ãªã&lt;code&gt;*table*&lt;/code&gt;ã«æŸç¸›ã•ã‚Œã¦ã„ã‚‹ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãªã‚‹ã€‚å› ã¿ã« &lt;em&gt;ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒã‚¯ãƒ­&lt;/em&gt; ã¨ã„ã†ãƒã‚¯ãƒ­å±•é–‹ãŒçµ‚ã‚ã£ãŸå¾Œã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã‚‚ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ãƒã‚¯ãƒ­1ã¤ã§ã¯ãªããƒã‚¯ãƒ­ã®å‰å¾Œã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã‚‚ã‚ã£ã¦ã“ãåˆã‚ã¦æŸ”è»Ÿæ€§ã‚’æ‰‹ã«ã—ã¦ã„ã‚‹ã€‚ã‚ã¾ã‚Šãã®ç‚¹ã¯è­°è«–ã•ã‚Œã¦ãªã„ã®ã§ã¯ãªã„ã ã‚ã†ã‹ã€‚&lt;/p&gt;

&lt;h1 id=&#34;common-lispã®è¨­è¨ˆ&#34;&gt;Common Lispã®è¨­è¨ˆ&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€å„ã€…è¨€èªã«ã¯äºˆç´„èªã‚„~æ§‹æ–‡ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã¨æ€ã†ã€‚ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©æ§‹æ–‡ãªã©ã€‚Common Lispã«ã‚‚ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã¨ã„ã†åå‰ã§&lt;a href=&#34;http://www.lispworks.com/documentation/HyperSpec/Body/03_ababa.htm&#34;&gt;25&lt;/a&gt;å€‹å­˜åœ¨ã™ã‚‹ã€‚
é©šãã¹ãã“ã¨ã«ã€ã“ã“ã¾ã§ã«å‡ºã¦ããŸCommon Lispã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã¯3ã¤ã—ã‹å‡ºã¦ã“ãªã„ã€‚ifã¨letã¨quoteã ã€‚setfã‚„loopã€defunã€defmacroã€caseã€defparameterãªã‚“ã‹ã¯ãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;defunã¾ã§ãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¯ãƒ¦ãƒ¼ã‚¶ãŒãã®æ°—ã«ãªã‚Œã°é–¢æ•°å®šç¾©ã®æ§‹æ–‡ã«æ‰‹ã‚’å…¥ã‚ŒãŸã‚Šã‚‚å‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚
æ™®é€šã€ãã‚“ãªã“ã¨ã‚’ã—ãŸã‚‰é˜¿é¼»å«å–šã ãŒCommon Lispãªã‚‰å®‰å…¨ã«å‡ºæ¥ã‚‹ã€‚ãƒã‚¯ãƒ­ã‚‚ã‚·ãƒ³ãƒœãƒ«ã«æŸç¸›ã•ã‚Œã¦ã„ã‚‹ã®ã§æ–°ãŸã«ãƒã‚¯ãƒ­ã§ä¸Šæ›¸ãã—ãŸã‚·ãƒ³ãƒœãƒ«ã‚’åå‰ç©ºé–“ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãªã‘ã‚Œã°ä»Šã¾ã§é€šã‚Šã®defunã‚„loopãŒä½¿ãˆã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã‚‚ã†1ã¤ã€æ™®æ®µä½¿ã†ã‚‚ã®ãŒãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¯ãƒã‚¯ãƒ­ã‚’è¢«ã›ã¦ãªã„æ©Ÿèƒ½ã¯ç›¸å½“ä½ãƒ¬ãƒ™ãƒ«ã ã¨ã„ã†ã“ã¨ã ã€‚ãƒã‚¯ãƒ­ã•ãˆæ›¸ã‘ã°å…¨ãæ–°ã—ã„è¨€èªæ©Ÿèƒ½ã‚’è¿½åŠ å‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã§ã‚ã‚Šã€ã‚ã‚‹ã„ã¯&lt;a href=&#34;http://cl21.org/&#34;&gt;å…¨ãæ–°ã—ã„è¨€èªã‚‚ä½œã‚Œã¦ã—ã¾ã†&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®ã‚ˆã†ãªè¨­è¨ˆã¯ãƒã‚¯ãƒ­ã§åˆ¶å¾¡æ§‹é€ ã¾ã§ã‚‚ä½œã‚Œã‚‹ã‹ã‚‰å‡ºæ¥ã‚‹ã®ã ã€‚é–¢æ•°å®šç¾©æ§‹æ–‡ã‚’ãƒã‚¯ãƒ­ã§å®šç¾©ã—ã¦ã„ã‚‹è¨€èªã¯Lispä»¥å¤–ã«ç§ã¯çŸ¥ã‚‰ãªã„ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨common-lisp&#34;&gt;ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨Common Lisp&lt;/h1&gt;

&lt;p&gt;ã¨ã“ã‚ã§ã€ãƒã‚¯ãƒ­ã«é™ã‚‰ãªã„ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ãŸã„ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ããƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãã“ã¨ã ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å®Ÿè¡Œå½¢å¼ã«è‡³ã‚‹ã¾ã§ã®é–“ã«æ§˜ã€…ãªä¸­é–“å½¢å¼ã‹ã‚‰ä¸­é–“å½¢å¼ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯ãã®ã©ã“ã‹ã®å½¢å¼ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã¨åŒç¾©ã«ãªã‚‹ã€‚é€šå¸¸ã€å‡¦ç†ç³»å†…éƒ¨ã§ä½¿ã†å½¢å¼ã¯å¤‰ãªã“ã¨ã‚’ã•ã‚Œã‚‹ã¨å›°ã‚‹ã®ã§ã‚ã¾ã‚Šå¤–éƒ¨ã«å…¬é–‹ã—ãŸããªã„ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¨±ã™ã¨ã—ã¦ã‚‚æ§‹æ–‡è§£æãªã©ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«è¿‘ã„éƒ¨åˆ†ã«ãªã‚‹ã ã‚ã†ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹ãˆã°yaccã‚„lexã®ã‚ˆã†ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã€rubyã‚„Dã®ã‚ˆã†ãªæ–‡å­—åˆ—ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯å…¬é–‹APIã§ã‚ã‚‹ã¨ã“ã‚ã®ãƒ‘ãƒ¼ã‚µã ã‘ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§å®‰å…¨æ€§ã¯é«˜ã„ã€‚ã—ã‹ã—æ–‡å­—åˆ—ã ã‘ã ã¨æ§‹é€ ãŒãªã„ã®ã§æ›¸ãå´ã¯ã¤ã‚‰ã„ã€‚ä¸€å¿œã€Common Lispã«ã‚‚readé–¢æ•°ã¨evalé–¢æ•°ãŒã‚ã‚‹ã®ã§Common Lispã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰æ–‡å­—åˆ—ã‚’åã„ã¦readã—ã¦evalã™ã‚Œã°æ–‡å­—åˆ—ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯å‡ºæ¥ã‚‹ã€‚ç‰¹ã«å¬‰ã—ããªã„ã®ã§ã‚„ã‚‰ãªã„ãŒã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡ã¯ãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒã‚ã‚‹ã€‚Cã®ãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µãªã©ã€‚Common Lispã§ã‚‚ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã§å¯èƒ½ã ã€‚ä¾‹ãˆã°æ­£è¦è¡¨ç¾ãƒªãƒ†ãƒ©ãƒ«ã‚’ä½œã£ãŸã‚Šã¨ã‹ã®ä¾‹ãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡ã¯ASTãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒã‚ã‚‹ã€‚ãƒã‚¯ãƒ­ã ã€‚ã“ã‚Œã¯ä»Šã¾ã§è¦‹ã¦ããŸã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã‚ˆã‚Šå…ˆã¯ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã¯ã‚ã¾ã‚Šè¨€ã‚ãªã„æ°—ãŒã™ã‚‹ã€‚JITã¨å‘¼ã¶ã®ã§ã¯ãªã„ã‹ã€‚Common Lispã«ã‚‚evalé–¢æ•°ã‚„compileé–¢æ•°ãŒã‚ã‚‹ã‹ã‚‰ãã†ã„ã†ã“ã¨ã‚‚å‡ºæ¥ã‚‹ã€‚æ­£è¦è¡¨ç¾ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã‚“ã‹ãŒä½¿ã£ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ç§ãŒè¨€ã„ãŸã„ã®ã¯Common Lispã«ã¯ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ©Ÿæ§‹ãŒä¸€æ¯ã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã¯ãªã„ã€‚read, eval, compileâ€¦ã€‚æ°—ä»˜ã„ãŸã‹ã‚‚ã—ã‚Œãªã„ãŒã€Lispã¯Lispè‡ªèº«ã§å‡ºæ¥ã¦ã„ã‚‹ã€‚
Lispã‚’æ›¸ãã¨ãã€Lispã‚’æ›¸ã„ã¦ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã—Lispã‚’æ§‹æˆã™ã‚‹Lispã‚’æ›¸ã„ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã„ãã‚‰ã§ã‚‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã¾ã¨ã‚&#34;&gt;ã¾ã¨ã‚&lt;/h1&gt;

&lt;p&gt;ä½•ã‚„ã‚‰Common Lispè³›ç¾æ­Œã«ãªã£ã¦ã—ã¾ã£ãŸãŒä¸€å¿œã¾ã¨ã‚ã¦ãŠãã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç°¡å˜ãªãƒã‚¯ãƒ­å®šç¾©ãªã‚‰Så¼ã§ã‚ã‚‹å¿…è¦ã¯ãªã„&lt;/li&gt;
&lt;li&gt;è¤‡é›‘ãªãƒã‚¯ãƒ­å®šç¾©ãªã‚‰Så¼ã§ã‚ã‚‹ã¨æ›¸ãæ˜“ã„ã€‚æã‚‰ãä»–ã®æ§‹æ–‡ã§ã‚‚æ›¸ã‘ãªã„ã“ã¨ã¯ãªã„ã€‚&lt;/li&gt;
&lt;li&gt;ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—æ§‹æ–‡ã¯Så¼ã§ãªã„ã¨é‡å¤§ãªé•ã„ãŒã‚ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ãƒã‚¯ãƒ­ä»¥å¤–ã«ã‚‚ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©ä»–ã®è¨€èªæ©Ÿèƒ½ãŒã‚ã£ã¦ã“ããƒã‚¯ãƒ­ãŒæ´»ãã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;è¨€èªæ©Ÿèƒ½ã ã‘ã§ãªããƒã‚¯ãƒ­ã‚’å‰æã¨ã—ãŸè¨­è¨ˆã‚‚é‡è¦ã§ã‚ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;Lispã¯Så¼ã§å‡ºæ¥ã¦ã„ã‚‹ä»¥å‰ã«Lispã§å‡ºæ¥ã¦ã„ã‚‹ã€‚&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>ã‚ãªãŸã®çŸ¥ã‚‰ãªã„Shebang</title>
      <link>/blog/2015/06/26/anatanoshiranaishebang</link>
      <pubDate>Fri, 26 Jun 2015 23:24:44 +0900</pubDate>
      
      <guid>/blog/2015/06/26/anatanoshiranaishebang</guid>
      <description>&lt;p&gt;Îºeenã§ã™ã€‚æœ€è¿‘ã¯ä½•æ•…ã‹Blackå›ã£ã¦å‘¼ã°ã‚Œã¾ã™ã€‚Shebangã®æ›¸ãæ–¹ã«ã¯ã„ãã¤ã‹ã‚ã£ã¦ã€ãã‚Œã‚’åˆ©ç”¨ã—ãŸãµã¨é¢ç™½ã„æ–¹æ³•ã‚’æ€ã„ä»˜ã„ãŸã®ã§å…±æœ‰ã‚’ã€‚
&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ã”å­˜çŸ¥Shebangã¨ã„ãˆã°&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/sh
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®1è¡Œç›®ãŒ&lt;code&gt;#!&lt;/code&gt;ã‹ã‚‰å§‹ã¾ã£ã¦ã„ã‚‹ã¨ã‚·ã‚§ãƒ«ãŒãã‚Œä»¥é™ã®æ–‡å­—åˆ—ã‚’å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹åã¨ã—ã¦æœã—ã¦å®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§ã™ãŒã€å®Ÿã¯&lt;code&gt;#!&lt;/code&gt;ã¯å”¯ä¸€ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;#!&lt;/code&gt;ãŒãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã«ãªã‚‹å‰ãªã®ã‹ãã‚‚ãã‚‚ã‚·ã‚§ãƒ«ã«ã‚³ãƒ¡ãƒ³ãƒˆãŒãªã‹ã£ãŸæ™‚ä»£ã®ã‚‚ã®ãªã®ã‹ã¯çŸ¥ã‚Šã¾ã›ã‚“ãŒæ˜”ã¯&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;: /bin/sh
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨&lt;code&gt;:&lt;/code&gt;ã§å§‹ã‚ã¦ã„ãŸã‚‰ã—ã„ã§ã™ã€‚å› ã¿ã«&lt;code&gt;:&lt;/code&gt;ã¯ã€Œä½•ã‚‚ã—ãªã„ã‚³ãƒãƒ³ãƒ‰ã€ã§ã™ã€‚å®Ÿè³ªçš„ã«ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æ‰±ã£ãŸã‚Šå‰¯ä½œç”¨ã®ã‚ã‚‹å¤‰æ•°å±•é–‹ã ã‘ã‚’è¡Œãªã£ãŸã‚Šãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã ã£ãŸã‚Šã®ç”¨é€”ã§ä½¿ã‚ã‚Œã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ã‚·ã‚§ãƒ«ã¯å…¨ã¦æ–‡å­—åˆ—ãªã®ã§ã‚¯ã‚©ãƒ¼ãƒˆã—ã¦ã‚‚ã—ãªãã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã—ã¦ã‚‚ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ãã‚Œã¾ã™ã€‚ãªãœã‚ã–ã‚ã–ã‚¯ã‚©ãƒ¼ãƒˆã™ã‚‹ã‹ã¨ã„ã†ã¨&lt;a href=&#34;//KeenS.github.io/blog/2014/12/08/ge-tochu-li-xi-potaburunacommon-lispshi-xing-ke-neng-huairuwozuo-ru/&#34;&gt;å‰²ã¨å‡¦ç†ç³»ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªCommon Lispå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ | Îºeenã®Happy HacÎºing Blog&lt;/a&gt;ã®ã‚ˆã†ã«åˆ¥ã®è¨€èªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹æ™‚ã«æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã«ãªã£ã¦ãã‚Œã‚‹ã¨å˜ç´”ã«ç„¡è¦–ã•ã‚Œã‚‹ã®ã§äº’æ›æ€§ãŒé«˜ã¾ã‚‹ã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§å®Œå…¨ç‰ˆãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªCommon Lispå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã†ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;

#|
run_if_exists(){
 command -v $1 &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exec &amp;quot;$@&amp;quot;
}
 run_if_exists cl &amp;quot;$0&amp;quot; &amp;quot;$@&amp;quot;
 run_if_exists sbcl --noinform --no-sysinit --no-userinit --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists clisp -norc --quiet --silent -on-error exit  &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ecl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists mkcl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists alisp -qq -#! &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ccl --no-init --quiet --batch --load &amp;quot;$0&amp;quot;  --eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 run_if_exists abcl --noinform --noinit --nosystem --batch --load &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists lisp -quiet -noinit -batch -load &amp;quot;$0&amp;quot; -eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 echo &amp;quot;No lisp implementation found&amp;quot;
 exit 1
|#

(write-line (lisp-implementation-type))
(force-output)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;abclã¨cclãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚ã‚ã¨CIMã‚‚æœã™ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚roswellã¯ä½œè€…ã«è¨Šã„ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ã¡ãªã¿ã«ã€shebangã®è§£é‡ˆã¯ã‚·ã‚§ãƒ«ã«ä¾å­˜ã™ã‚‹ã®ã§ã™ãŒã€B Shell, csh, tcsh, dash, Bash, zshã§å‹•ä½œç¢ºèªã—ã¾ã—ãŸã€‚å¤ã„æ©Ÿèƒ½ãªã®ã§æ–°ã—ã„ã‚·ã‚§ãƒ«ã»ã©åˆ‡ã‚Šæ¨ã¦ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã£ãŸã®ã§ã™ãŒBashã‚„zshãŒå¤§ä¸ˆå¤«ã ã£ãŸã®ã§è‰¯ã‹ã£ãŸã§ã™ã€‚
ä¸€å¿œéæ¨å¥¨ãªæ°—ãŒã—ã¾ã™ãŒã“ã‚Œã—ã‹æ–¹æ³•ãŒãªã„ã®ã§ä»•æ–¹ãªã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§ã¿ãªã•ã‚“ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ›¸ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h1 id=&#34;è¿½è¨˜&#34;&gt;è¿½è¨˜&lt;/h1&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; shebangã®è§£é‡ˆã¯ã‚·ã‚§ãƒ«ã˜ã‚ƒãªãã¦OSã®exec()ãŒã‚„ã‚Šã¾ã™ã€‚ã§ã€#!ã‚„èªè­˜ã§ãã‚‹ãƒã‚¤ãƒŠãƒªä»¥å¤–ã¯ã€exec()ãŒã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ãŸå¾Œã§ã‚·ã‚§ãƒ«ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãªã‚‰ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã£ã¦ã‚„ã£ã¦ã¾ã™ã€‚ãªã®ã§å…ˆé ­ãŒ:ã®å ´åˆã¯(ç¶š&lt;/p&gt;&amp;mdash; Kilo Kawai (@anohana) &lt;a href=&#34;https://twitter.com/anohana/status/614551978526445570&#34;&gt;2015, 6æœˆ 26&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; shebangã¨ã—ã¦ã§ã¯ãªãã€ã‚·ã‚§ãƒ«ãŒã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦èª­ã‚“ã§ã‚‹ã ã‘ãªã®ã§ã€ãã®å¾Œã«/bin/shã¨ã‹æ›¸ã„ã¦ã‚ã£ã¦ã‚‚é–¢ä¿‚ãªã„ã¯ãš (ã‚·ã‚§ãƒ«ã«ã‚ˆã£ã¦ã¯ãã“ã‚‚è¦‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒ)&lt;/p&gt;&amp;mdash; Kilo Kawai (@anohana) &lt;a href=&#34;https://twitter.com/anohana/status/614552151759589376&#34;&gt;2015, 6æœˆ 26&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§å®Ÿé¨“ã—ã¦ã¿ãŸã¨ã“ã‚ã€å…ˆé ­ã®&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;&lt;/code&gt;ã¯ã©ã®ã‚·ã‚§ãƒ«ã‚‚èª­ã¿é£›ã°ã™æ¨¡æ§˜(ã¤ã¾ã‚Šã€&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/usr/bin/ruby&amp;quot;&lt;/code&gt;ã¨æ›¸ã„ã¦ã‚‚rubyãŒå®Ÿè¡Œã•ã‚Œã‚‹è¨³ã§ã¯ãªã„)ã€‚&lt;/p&gt;

&lt;p&gt;ã§ã€å…ˆç¨‹ã® å®Œå…¨ç‰ˆã‹ã‚‰&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;&lt;/code&gt;ã‚’å–ã‚Šé™¤ã„ã¦&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;#|
run_if_exists(){
 command -v $1 &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exec &amp;quot;$@&amp;quot;
}
 run_if_exists cl &amp;quot;$0&amp;quot; &amp;quot;$@&amp;quot;
 run_if_exists sbcl --noinform --no-sysinit --no-userinit --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists clisp -norc --quiet --silent -on-error exit  &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ecl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists mkcl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists alisp -qq -#! &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ccl --no-init --quiet --batch --load &amp;quot;$0&amp;quot;  --eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 run_if_exists abcl --noinform --noinit --nosystem --batch --load &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists lisp -quiet -noinit -batch -load &amp;quot;$0&amp;quot; -eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 echo &amp;quot;No lisp implementation found&amp;quot;
 exit 1
|#

(write-line (lisp-implementation-type))
(force-output)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã—ã¦ã‚‚å‹•ã„ãŸã®ã§ã“ã‚ŒãŒæœ€çµ‚ç‰ˆã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å¤§å­¦ã®è¬›ç©¶ã§MINIXæœ¬ã‚„ã£ãŸã©ã“ã‚ã‹execã®ã¨ã“ã‚è‡ªåˆ†ã®æ‹…å½“ã ã£ãŸã®ã«æ¥ã‹ã—ã„ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Common Lispå‡¦ç†ç³»æ‹¡å¼µã®æ¢æ±‚ SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆ</title>
      <link>/slide/Common_Lispshorikeikakuchounotankyuu_SBCLnomaruchisureddosapo_to/</link>
      <pubDate>Sat, 20 Jun 2015 18:30:52 +0900</pubDate>
      
      <guid>/slide/Common_Lispshorikeikakuchounotankyuu_SBCLnomaruchisureddosapo_to/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n===\n&#34;
    data-vertical=&#34;\n---\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
### Common Lisp å‡¦ç†ç³»æ‹¡å¼µã®æ¢æ±‚
SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆ

----------------------
Lisp Meet Up #29

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + æ¸‹è°·ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™
===
# CLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰
----------------------------
## [bordeaux-threads](https://trac.common-lisp.net/bordeaux-threads/wiki/ApiDocumentation)
* è‰²ã€…ãªå‡¦ç†ç³»ã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆã®æŠ½è±¡ãƒ¬ã‚¤ãƒ¤ãƒ¼
* ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰
  + ã‚¹ãƒ¬ãƒƒãƒ‰
  + ãƒ­ãƒƒã‚¯
  + ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãƒ´ã‚¡ãƒªã‚¢ãƒ«

===
# SBLCã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰

&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
# SBLCã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰
----------------------------

* ã‚¹ãƒ¬ãƒƒãƒ‰
  + ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã‚¨ãƒ©ãƒ¼
* ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
  + CAS&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* æ’ä»–åˆ¶å¾¡ï¼ˆãƒ­ãƒƒã‚¯ï¼‰
* ã‚»ãƒãƒ•ã‚©
* ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãƒ´ã‚¡ãƒªã‚¢ãƒ«
* ãƒãƒªã‚¢
* ã‚­ãƒ¥ãƒ¼&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* ã‚²ãƒ¼ãƒˆ&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* frlock&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;

===
# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ
----------------
è¤‡é›‘ãªå‹•ä½œã¯åŒã˜ãƒ‡ãƒ¼ã‚¿ã«ä¸¦è¡Œã«å‹•ã‹ã™ã¨å£Šã‚Œã†ã‚‹

```
        [var = 1]
[incf]      |      [decf]
 [1]&lt;-------|
  |         |------&gt;[1]
 [2]---&gt;[var = 2]    |
            |        | 
        [var = 0]&lt;--[0]
```
===
# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ
----------------

* `atomic-{incf, decf}`
  + å‹•ä½œå‡ºæ¥ã‚‹å ´æ‰€ãŒé™ã‚‰ã‚Œã¦ã„ã‚‹
* `atomic-{pop, push, update}`
  + CASãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã‚Œã°ã©ã“ã§ã‚‚

===
# CASãƒ—ãƒ­ãƒˆã‚³ãƒ«
---------------
* compare and swap
* ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œã®åŸºæœ¬ä¸­ã®åŸºæœ¬
  + ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ¬ãƒ™ãƒ«ã®ã‚µãƒãƒ¼ãƒˆ
* ã–ã£ãã‚Šè¨€ã†ã¨ä¸¦è¡Œç‰ˆsetf
* `(cas place old new env)`
  + ã‚‚ã—`place`ãŒ`old`ã«ç­‰ã—ã‘ã‚Œã°`new`ã‚’ä»£å…¥
* `(defun (cas foo) (old new))`
  + `cas`ç‰ˆã®`setf`å®šç¾©
* ä»–ã«ã‚‚`setf`ç›¸å½“ã®æ©Ÿèƒ½ã¯æƒã£ã¦ã‚‹
===
# CASãƒ—ãƒ­ãƒˆã‚³ãƒ«
---------------

```lisp
(defvar *foo* nil)

(defun (cas foo) (old new)
  (cas (symbol-value &#39;*foo*) old new))
```

===
# ã‚­ãƒ¥ãƒ¼
--------

* æ™®é€šã®ã‚­ãƒ¥ãƒ¼
* ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•
* `enqueue`, `dequeue`ãŒåŸºæœ¬æ“ä½œ
* `dequeue`ãŒå¤šå€¤ã§ã€ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„
  + ç©ºãªã‚‰ç¬¬äºŒå€¤ãŒnilã«ãªã‚‹

===
# ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹
---------------

* ã‚­ãƒ¥ãƒ¼ã¨ã»ã¼åŒã˜
* ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•
* `send-message`, `recieve-message`ãŒåŸºæœ¬æ“ä½œ
* `recieve-message`ã¯ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹
  + ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚‚è¨­å®šå‡ºæ¥ã‚‹
* `recieve-message-no-hangã¯dequeue`ã¨åŒã˜æŒ™å‹•
* `recieve-pending-messages`ã‚‚ã‚ã‚‹

===
# ã‚²ãƒ¼ãƒˆ
--------

* è¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒ1ã¤ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…ã¤æ™‚ã«ä½¿ã†
* `wait-on-gate`, `open-gate`, `close-gate`ãŒåŸºæœ¬æ“ä½œ

===
```
[gate (closed)]  [T1] [T2] [T3]
     |            |    |    |
     |     wait   |    |    |
     |&lt;----------------+----+
     |            |    .    .
     |     open   |    .    .
[gate (opened)]&lt;--+    .    .
     +----------------&gt;+---&gt;+
         go            |    |
                       V    V
```

===
# frlock
--------

* Fast Read Lock
* ã¾ãŸã®åã‚’Read-Write Lock
* Read Lockã¯å¤šé‡ã«å–ã‚Œã‚‹ã€‚Write Lockã¯1ã¤ã—ã‹å–ã‚Œãªã„ã€‚
* åŸºæœ¬æ“ä½œã¯`frlock-read`ã¨`frlock-write`
* æ™®é€šã®lockã¨é•ã£ã¦è¤‡æ•°ã®ReadãŒé€Ÿããªã‚‹

===
# ã¾ã¨ã‚
--------

* SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆã¯bordeaux-threadsã‚ˆã‚Šã‚‚ãƒªãƒƒãƒ
* å‡¦ç†ç³»ã®ç‹¬è‡ªã‚µãƒãƒ¼ãƒˆé¢ç™½ã„
* å‡¦ç†ç³»ã«ä¾å­˜ã—ã¦ã—ã¾ã£ã¦ã‚‚ã„ã„ã‚“ã˜ã‚ƒãªã„ã ã‚ã†ã‹
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Common Lispã§é™å®šç¶™ç¶šã¨éŠã¶</title>
      <link>/slide/Common_Lispdegenteikeizokutoasobu_/</link>
      <pubDate>Sun, 26 Apr 2015 21:09:07 +0900</pubDate>
      
      <guid>/slide/Common_Lispdegenteikeizokutoasobu_/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n===\n&#34;
    data-vertical=&#34;\n---\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Common Lispã§é™å®šç¶™ç¶šã¨éŠã¶
----------------------
[Lisp Meet Up #27](https://atnd.org/events/64988)

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + æ¸‹è°·ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™

===
# Agenda
--------

0. cl-contã®ç´¹ä»‹
1. é™å®šç¶™ç¶šã®è©±
2. é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±
3. é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±

===
# CL-CONTã®ç´¹ä»‹

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# CL-CONT
---------

* Common Lispã®é™å®šç¶™ç¶šãƒ©ã‚¤ãƒ–ãƒ©ãƒª
* çµæ§‹å¤ãã‹ã‚‰ã‚ã‚‹ã£ã½ã„
* å‰²ã¨è‰²ã€…ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ã£ã¦ã‚‹
===
# CL-CONT
---------

![cl-cont dependers](/images/cl-cont-dependers.png)
===
# API
-----

* ç¶™ç¶šã‚’åŒºåˆ‡ã‚‹ãƒã‚¯ãƒ­
  + `with-call/cc`
  + `defun/cc`
  + `lambda/cc`
* ç¶™ç¶šã‚’å–å¾—ã™ã‚‹ãƒã‚¯ãƒ­
  + `call/cc`
  + `let/cc`

â€»å¾Œã§èª¬æ˜ã™ã‚‹ã®ã§æ„å‘³ãŒåˆ†ã‹ã‚‰ãªãã¦ã‚‚å•é¡Œãªã„ã§ã™ã€‚

===
# é™å®šç¶™ç¶šã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# ç¶™ç¶šã¨ã¯
---------

* &#34;ãã®å¾Œ&#34;ã®è¨ˆç®—ã‚’è¡¨ã‚ã™æ¦‚å¿µã€‚
* å€¤ãŒæ±ºå®šã—ãŸå¾Œãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«æˆ»ã‚‹ã¾ã§ã®è¨ˆç®—ã€‚
* SchemeãŒä¸€ç´šå¸‚æ°‘ã¨ã—ã¦æ‰±ãˆã‚‹ã“ã¨ã§æœ‰å
* å€¤ã¨ã—ã¦å–ã‚Šå‡ºã—ãŸæ™‚ã¯0-1å¼•æ•°é–¢æ•°ã¨ã—ã¦æŒ¯ã‚‹èˆã†
===
# ç¶™ç¶šã¨ã¯
----------
`foo`ã®ç¶™ç¶šã¯ã€`foo`ã‚’è™«é£Ÿã„ã«ã—ãŸã‚‚ã®ã¨æ€ãˆã°è‰¯ã„ã€‚

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      (foo x))))
```
===
# ç¶™ç¶šã¨ã¯
----------
`foo`ã®ç¶™ç¶šã¯ã€`foo`ã‚’è™«é£Ÿã„ã«ã—ãŸã‚‚ã®ã¨æ€ãˆã°è‰¯ã„ã€‚

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      â–¡)))
```
===
# ç¶™ç¶šã¨ã¯
----------
ã‚ã¨ã¯ãã‚Œã‚’é–¢æ•°ã«ã™ã‚‹ã ã‘

```lisp
(lambda (k)
  (mapc #&#39;writ-line
        (loop :for x :in list
           :collect (if (evenp x)
                        k))))
```

===
# é™å®šç¶™ç¶šã¨ã¯
---------

* &#34;ãã®å¾Œ&#34;ã®è¨ˆç®—ã‚’è¡¨ã‚ã™æ¦‚å¿µã€‚
* å€¤ãŒæ±ºå®šã—ãŸå¾Œ *æŒ‡å®šã—ãŸä½ç½®* ã«æˆ»ã‚‹ã¾ã§ã®è¨ˆç®—ã€‚
* ç¶™ç¶šãŒãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã¾ã§æˆ»ã‚‹ã®ã«å¯¾ã—ã¦é™å®šç¶™ç¶šé€”ä¸­ã§æ­¢ã¾ã‚‹ã€‚ãã‚Œã ã‘ã€‚
* éƒ¨åˆ†ç¶™ç¶šãªã©ã®è¨€ã„æ–¹ã‚‚ã‚ã‚‹
  + è‹±èªã‚‚part contã¨delimited contã§åˆ†ã‹ã‚Œã‚‹

===
# é™å®šç¶™ç¶šã¨ã¯
-------------
å…ˆã®ä¾‹ã‚’`loop`ã¾ã§ã®é™å®šç¶™ç¶šã«ã™ã‚‹ã¨

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      (foo x))))
```

===
# é™å®šç¶™ç¶šã¨ã¯
-------------
å…ˆã®ä¾‹ã‚’`loop`ã¾ã§ã®é™å®šç¶™ç¶šã«ã™ã‚‹ã¨

```lisp
(loop :for x :in list
           :collect (if (evenp x)
                        â–¡))
```

===
# é™å®šç¶™ç¶šã¨ã¯
-------------

```lisp
(lambda (k)
  (loop :for x :in list
     :collect (if (evenp x)
                  k)))
```
===
# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
æ™®é€šã®ã‚„ã¤

```lisp
(with-call/cc
  (+ 1 (call/cc
        (lambda (k)
          (funcall k 2)))))
```

ã“ã‚Œã¯

```lisp
(+ 1 2)
```

ã¨ç­‰ä¾¡
===
# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
ä»Šåº¦ã¯ç¶™ç¶šã‚’å‘¼ã°ãªã„ã§ã¿ã‚‹

```lisp
(with-call/cc
  (+ 1 (call/cc (lambda (k) 2))))
```

ã“ã‚Œã¯

```lisp
2
```

ã¨ç­‰ä¾¡
===
# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
ã‚‚ã†ã¡ã‚‡ã£ã¨å‘¼ã°ãªã„ä¾‹  
(`(let/cc k ...)` = `(call/cc (lambda (k) ...))`)

```lisp
(with-call/cc
  (write-line &#34;hello&#34;)
  (let/cc k 1)
  (write-line &#34;world&#34;))
```

ã¯

```lisp
(progn
  (write-line &#34;hello&#34;)
  1)
```

ã¨ç­‰ä¾¡

===
# é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±
---------------------

* ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
* ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ç¶ºéº—ã«æ›¸ãæ›ãˆã‚‹
* éæ±ºå®šæ€§è¨ˆç®—
* etc...

===
## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰

&lt;!-- .slide: class=&#34;center&#34; --&gt;

===
## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------

* ã¾ãŸã®åã‚’ã‚³ãƒ«ãƒ¼ãƒãƒ³
* ã¾ãŸã®åã‚’å¼·èª¿ã‚¹ãƒ¬ãƒƒãƒ‰


===
## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------
```lisp
(let (c)
  (setf c (with-call/cc
            (write-line &#34;in thread A 1&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 2&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 3&#34;)))
  (write-line &#34;in main thread 1&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 2&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 3&#34;))
```
===
## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------
å®Ÿè¡Œçµæœ

```
in thread A 1
in main thread 1
in thread A 2
in main thread 2
in thread A 2
in main thread 3

```

===
## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
----------------------
æœ¬å½“ã¯ã“ã†æ›¸ããŸã„

```lisp
(with-event-loop
    (format t &#34;Hello, ~a!~%&#34; (async-read stream)))
```
===
## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
----------------------
ã—ã‹ã—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’è¦æ±‚ã—ã¦ãã‚‹

```lisp
(with-event-loop
    (async-read stream (lambda (line)
                         (format t &#34;Hello, ~a!~%&#34; line))))
```
===
## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
-----------------------
ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ = é™å®šç¶™ç¶šï¼ˆå¾Œè¿°ï¼‰ãªã®ã§ã“ã†ã—ã¦ã‚„ã‚Œã°è‰¯ã„ã€‚

```lisp
(with-event-loop
    (with-call/cc
      (format t &#34;Hello, ~a!~%&#34;
              (call/cc (lambda (k))
                       (async-read stream k)))))
```
===
## éæ±ºå®šæ€§è¨ˆç®—

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢

* ç¶™ç¶šã‚’é–¢æ•°ã¨ã—ã¦å–ã‚Šå‡ºã—ãŸå¾ŒåŒã˜å‡¦ç†ã‚’ä½•å›ã‚‚å®Ÿè¡Œå‡ºæ¥ã‚‹ã‚“ã˜ã‚ƒã­ï¼Ÿ

===
## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
è¤‡æ•°å›å‘¼ã³å‡ºã—ã¦ã¿ã‚‹

```lisp
(let (c)
  (setf c (with-call/cc
            (+ 1 (* 2 (- 3 (let/cc k k))))))
  (list (funcall c 1)
        (funcall c 2)
        (funcall c 3)))
```

===
## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
æ™®é€šã®1å¼•æ•°é–¢æ•°ã¨ã—ã¦ä½¿ã£ã¦ã¿ã‚‹

```lisp
(let (c)
  (setf c (with-call/cc
            (+ 1 (* 2 (- 3 (let/cc k k))))))
  (mapcar c (list 1 2 3)))
```
===
## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
ãƒã‚¯ãƒ­ã§ãƒ©ãƒƒãƒ—ã—ã¦ã¿ã‚‹

```lisp
(defmacro for (&amp;body expr)
  `(with-call/cc ,@expr))
(defmacro in (m)
  `(let/cc k (apply #&#39;append (mapcar k ,m))))
(defun yield (x) (list x))
(defun unit () nil)
```

===
## éæ±ºå®šæ€§è¨ˆç®—
-------------
ä½¿ã£ã¦ã¿ã‚‹

```lisp
(for
  (let ((x (in &#39;(1 2 3)))
        (y (in &#39;(a b c))))
    (yield (cons x y))))
```

```
((1 . A) (1 . B) (1 . C) (2 . A) (2 . B) (2 . C) (3 . A) (3 . B) (3 . C))
```

===
# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±
-------------------

* ç¶™ç¶šã¯0~1å¼•æ•°é–¢æ•°ã¨ã—ã¦å–ã‚Šå‡ºã›ã‚‹ã®ã§ã‚ã£ãŸã€‚
  + å®Ÿã¯æ©Ÿæ¢°çš„ã«å–ã‚Šå‡ºã›ã‚‹
* ç¶™ç¶šã¯å…¨ã¦ã®å¼ã«æš—é»™ã«å­˜åœ¨ã™ã‚‹ã®ã§ã‚ã£ãŸ
  + å…¨ã¦ã®å¼ã‚’ç¶™ç¶šã‚’æ˜ç¤ºçš„ã«ä½¿ã†ã‚ˆã†ã«ã‚‚å‡ºæ¥ã‚‹

===
# CPSå¤‰æ›

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# CPSå¤‰æ›
---------

* å…¨ã¦ã®é–¢æ•°ã®å¼•æ•°ã‚’1ã¤å¢—ã‚„ã—ã¦ã€ãã“ã§ç¶™ç¶šã‚’å—ã‘å–ã‚‹
* å€¤ã‚’è¿”ã™æ™‚ã¯æš—é»™ã®returnã‚’ä½¿ã†ã®ã§ã¯ãªãæ˜ç¤ºçš„ã«ç¶™ç¶šã‚’å‘¼ã¶
* é–¢æ•°ã‚’å‘¼ã¶æ™‚ã¯å¿…ãšç¶™ç¶šã‚’æ¸¡ã™ã€‚å‘¼ã³å‡ºã—å…ƒã«ã¯è¿”ã£ã¦ã“ãªã„ï¼ˆè‡ªç„¶ã¨æœ«å°¾å†å¸°ã«ãªã‚‹ï¼‰

===
# CPSå¤‰æ›
---------
ä¾‹ãˆã°

```lisp
(with-call/cc
  (foo (call/cc
        (lambda (k)
          (funcall k 2)))))
```

ã¯ã€å–ã‚Šå‡ºã•ã‚ŒãŸç¶™ç¶šãŒ

```lisp
(lambda (k) (foo k))
```

ã€‚

===
# CPSå¤‰æ›
---------
ã‚ˆã£ã¦

```lisp
((lambda (k) (foo k)) 2)
```

ã¨å¤‰æ›ã•ã‚Œã‚‹

===
# CPSå¤‰æ›
---------
å†å¸°é–¢æ•°ã ã¨å°‘ã—é¢å€’

```lisp
(defun fact (n)
  (if (&lt;= n)
      1
      (* n (fact (- n 1))))))

```

ãŒ

```lisp
(defun fact (n c)
  (if (&lt;= n)
      (c 1)
      (fact (- n 1) (lambda (v) (* n v)))))
```

ã¨ãªã‚‹

===
# CPSå¤‰æ›
---------

* CPSå¤‰æ›ã‚’è¡Œãªã†ã“ã¨ã§ã„ã¤ã§ã‚‚ç¶™ç¶šã‚’å€¤ã¨ã—ã¦ä½¿ãˆã‚‹

===
# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±
-------------------

* CPSå¤‰æ›ã‚’è£ã§è¡Œãªã£ã¦ã„ã‚‹
* è‡ªå‹•ã§å‡ºæ¥ã‚‹ã®ã§ãƒã‚¯ãƒ­ã§å¤‰æ›ã‚’ã—ã¦ã„ã‚‹
  + çµ„ã¿è¾¼ã¿é–¢æ•°ã¯å¤‰æ›´å‡ºæ¥ãªã„ã®ã§ç‰¹åˆ¥æ‰±ã„
  + ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã‚‚æ°—ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹
* `lambda`ãŒä¹±ç«‹ã™ã‚‹ã®ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯é…·ã„ã€‚

===
# ã¾ã¨ã‚
-------

* cl-contã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã£ã¦ã€é™å®šç¶™ç¶šãŒæ‰±ãˆã‚‹
* é™å®šç¶™ç¶šã¯å‡¦ç†ã‚’ä¸­æ–­ã—ãŸã‚Šå†é–‹ã—ãŸã‚Šç¹°ã‚Šè¿”ã—ãŸã‚Šã«ä½¿ãˆã‚‹
* è£ã§ã¯ãˆã’ã¤ãªã„ã“ã¨ã‚’ã‚„ã£ã¦ã„ã‚‹
* ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¿…è¦ãªã¨ã“ã‚ã§ã¯ä½¿ã£ã¡ã‚ƒãƒ€ãƒ¡

===
# å‚è€ƒ
------
* [picrin/partcont.scm at master Â· picrin-scheme/picrin](https://github.com/picrin-scheme/picrin)
* [cl-cont | Quickdocs](http://quickdocs.org/cl-cont/)
* [ã‚³ãƒ«ãƒ¼ãƒãƒ³ã‚’Common Lispã§ç°¡å˜ã«å®šç¾© - ã•ãã‚‰ã‚“ã¼ã®lambdaæ—¥è¨˜](http://lambdasakura.hatenablog.com/entry/20111026/1319598590)
* [ç¶™ç¶šæ¸¡ã—ã‚¹ã‚¿ã‚¤ãƒ« - Wikipedia](http://ja.wikipedia.org/wiki/%E7%B6%99%E7%B6%9A%E6%B8%A1%E3%81%97%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB)
* [M.Hiroi&#39;s Home Page / ãŠæ°—æ¥½ Scheme ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å…¥é–€](http://www.geocities.jp/m_hiroi/func/abcscm20.html)
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>caveman2ã€ningleâ€¦Common Lispã®Webå‘¨ã‚Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å¿«é©ã«ä½¿ã†ãŸã‚ã®ãŸã£ãŸ1ã¤ã®ã‚³ãƒˆ</title>
      <link>/slide/caveman2-ningle./</link>
      <pubDate>Thu, 05 Mar 2015 13:18:44 +0900</pubDate>
      
      <guid>/slide/caveman2-ningle./</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n===\n&#34;
    data-vertical=&#34;\n---\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# caveman2ã€ningleã€dataflyâ€¦Common Lispã®Webå‘¨ã‚Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å¿«é©ã«ä½¿ã†ãŸã‚ã®ãŸã£ãŸ1ã¤ã®ã‚³ãƒˆ
----------------------
Clack Meet Up #1  
2015-03-05 @ã‚µãƒ ãƒ©ã‚¤ãƒˆ

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
&lt;span style=&#34;font-size:300%&#34;&gt;ãšã£ã¨ä¿ºã®ã‚¿ãƒ¼ãƒ³&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# å•é¡Œ
------
Common Lispã¯ case

* Sensitive &lt;!--.element: class=&#34;fragment grow&#34; data-fragment-index=&#34;1&#34; --&gt;  
* Insensitive &lt;!--.element: class=&#34;fragment shrink&#34; data-fragment-index=&#34;1&#34; --&gt;

ã©ã£ã¡?
===
# å•é¡Œ
-------

ã‚ã‚Œï¼Ÿ

```lisp
(eql? &#39;CaseInsensitive &#39;caseinsensitive) ;=&gt; t
```

===
# å•é¡Œ
-------

ãƒªãƒ¼ãƒ€ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å¤§æ–‡å­—ã«ã™ã‚‹ã ã‘
```lisp
(eql? &#39;|CaseSensitive| &#39;|casesensitive|) ;=&gt; nil
```

===
# Caveman2
---------

```lisp
@route GET &#34;/hello&#34;
(defun say-hello (&amp;key (|name| &#34;Guest&#34;))
  (format nil &#34;Hello, ~A&#34; |name|))
```
===
# Ningle
--------

```lisp
(setf (ningle:route *app* &#34;/login&#34; :method :POST)
      #&#39;(lambda (params)
          (if (authorize (getf params :|username|)
                         (getf params :|password|))
            &#34;Authorized!&#34;
            &#34;Failed...Try again.&#34;)))
```
===
# é¢å€’â€¦
----
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãã®ã¾ã¾ã ãŸã£ã‚‰ã„ã„ã®ã«
===
# é­”æ³•ã®`readtable-case`

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# é­”æ³•ã®`readtable-case`
-----------------------
```lisp
(setf (readtable-case *readtable*) :invert)
```
ã‚’ä½¿ãˆã°OK  
å‚è€ƒ: [SBCLã§clispã¨ã‹allegroã®modern modeçš„ãªã“ã¨ã‚’ã™ã‚‹ - wasabizã®æ—¥è¨˜](http://wasabiz.hatenablog.com/entry/20120929/1348889601)
===
# ä¾‹
----
```lisp
CL-USER&gt; :username
:USERNAME
CL-USER&gt; (setf (readtable-case *readtable*) :invert)
:invert
CL-USER&gt; :username
:username
```
===
# ã¾ã¨ã‚
--------
* `(setf (readtable-case *readtable*) :invert)`ã‚’ä½¿ã†ã¨å¿«é©ã ã‚ˆ


&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®å•é¡Œç‚¹ã¨å†è¨­è¨ˆ</title>
      <link>/slide/kizonnotenpure-toenjinnomondaitentosaisekkeiaruihaArrowsnitsuite/</link>
      <pubDate>Mon, 02 Mar 2015 23:36:03 +0900</pubDate>
      
      <guid>/slide/kizonnotenpure-toenjinnomondaitentosaisekkeiaruihaArrowsnitsuite/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n===\n&#34;
    data-vertical=&#34;\n---\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
&lt;style type=&#34;text/css&#34;&gt;
.red {
color: red;
}
&lt;/style&gt;
# æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®å•é¡Œç‚¹ã¨å†è¨­è¨ˆã€ã‚ã‚‹ã„ã¯Arrowsã«ã¤ã„ã¦
-----------------------------------------------------------------
Clack Meet Up #1  
2015-03-05 @ã‚µãƒ ãƒ©ã‚¤ãƒˆ

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + é‡ç”Ÿã®Lisper
 + Lisp, Ruby, OCaml, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™
===
# Template Engines

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
# Existing Architeture
----------------------
0. (ãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
1. ã‚¢ãƒ—ãƒª
  0. å¼•æ•°ã‚’è¨ˆç®—
  1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å¼•æ•°ã‚’æ¸¡ã™
  2. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° &lt;!--.element: class=&#34;fragment grow&#34;  --&gt;
4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚µãƒ¼ãƒã«æ¸¡ã™
5. (ãƒ¬ã‚¹ãƒãƒ³ã‚¹)
===
# Rendering?
----------------------
* çµåˆã—ãŸæ–‡å­—åˆ—ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã£ãŸã‚‰ãã®å¾Œã¯ã‚´ãƒŸ
 + GCã¸è² è·ãŒã‹ã‹ã‚‹ (å¾Œè¿°)
* ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã¨ã£ã¦1ã¤ã®æ–‡å­—åˆ—ã§ã‚ã‚‹å¿…è¦ã¯ãªã„
* ã‚€ã—ã‚è¿”ã›ã‚‹éƒ¨åˆ†ã ã‘å…ˆã«è¿”ã—ãŸæ–¹ãŒå¾—ï¼ˆå¾Œè¿°ï¼‰
===
# GC Pressure (SBCL)
-----------------
* ä¸–ä»£åˆ¥Copy GC
* çµåˆã—ãŸæ–‡å­—åˆ—ã¯æ¯”è¼ƒçš„å¤§ãã„
* `alloc_space`ã«å…¥ã‚‰ãªã„å¤§ãã•ãªã‚‰ã‚¢ãƒ­ã‚±ãƒ¼ãƒˆãŒé…ã„
* GCã‚’é »ç¹ã«èµ·å‹•ã—ã¦ã—ã¾ã†
* 16KBã‚’è¶Šãˆã‚‹ã¨ç‰¹åˆ¥æ‰±ã„ã•ã‚Œã¦é…ã„/ãƒ¡ãƒ¢ãƒªã‚’å–°ã†
* Lispã®Webã‚¢ãƒ—ãƒªã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã®åˆ†æ•£ãŒå¤§ãã„ï¼ˆè¦å‡ºå±•ï¼‰

å‚è€ƒ: [SBCL GENCGC @ x86 Linux](http://cl-www.msi.co.jp/reports/sbcl-gc-memo.html)
===
# Split Response
---------------
ä¾‹ãˆã°ã€ã“ã‚“ãªã®

&lt;pre&gt;&lt;code class=&#34;html&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html xmlns=&amp;quot;http://www.w3.org/1999/xhtml&amp;quot; xml:lang=&amp;quot;en&amp;quot; lang=&amp;quot;en-us&amp;quot;&amp;gt;
    &amp;lt;head&amp;gt;
        &amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;http://localhost:1313//reveal.js/lib/css/xcode.css&amp;quot;&amp;gt;
        &amp;lt;script src=&amp;quot;//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
        ....
        &amp;lt;/script&amp;gt;
    &amp;lt;/head&amp;gt;
    &amp;lt;body class=&amp;quot;li-body&amp;quot;&amp;gt;
    &amp;lt;header&amp;gt;{{ header }}&amp;lt;/header&amp;gt;
    {{ body }}
    ...
&lt;/code&gt;&lt;/pre&gt;
===
# Split Response
---------------
1. `{{ header }}`ã®å‰ã«å…ˆé ­ã‹ã‚‰`&lt;header&gt;`ã¾ã§ã‚’è¿”ã™
2. `{{ header }}`ã‚’è¿”ã™
3. `&lt;/header&gt;`ã‚’è¿”ã™
4. `{{ body }}`ã‚’è¿”ã™

...

===
# Pros of Split Response
------------------------
* `header`ã‚’è¨ˆç®—ã—ã¦ã‚‹é–“ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«headéƒ¨åˆ†ãŒæ¸¡ã‚‹
  + å…ˆã«`&lt;link&gt;`ã‚„`&lt;script&gt;`ã‚’è¦æ±‚å‡ºæ¥ã‚‹
  + ã‚µãƒ¼ãƒå´ã®ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ ã¯å¤‰ã‚ã‚‰ãªã„ãŒ
    ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å®Œäº†ã¾ã§ã®æ™‚é–“ã¯å¤§å¹…ã«çŸ­ç¸®å‡ºæ¥ã‚‹
* æ–‡å­—åˆ—ã‚’çµåˆã™ã‚‹å¿…è¦ãŒãªã„
* å®šæ•°éƒ¨åˆ†ã«ã¤ã„ã¦ã¯é•·ã•ãŒåˆ¤ã£ã¦ã‚‹ã®ã§æœ€é©åŒ–ã—æ˜“ã„
===
# How TEs Work 
---------------------------
## Compilation
1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–‡å­—åˆ—
 + ãƒ‘ãƒ¼ã‚µ &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
2. æŠ½è±¡æ§‹æ–‡æœ¨
 + ã‚³ãƒ¼ãƒ‰ã‚¨ãƒŸãƒƒãƒˆ &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
3. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°
===
# How TEs Work 
---------------------------
## Rendering
1. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°
 + å¼•æ•° &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
2. æ–‡å­—åˆ—
===
# Misc Problems
---------------
* ã‚µãƒ¼ãƒã«æ¸¡ã™ã®ã¯æ–‡å­—åˆ—ãªã®ã«ã‚½ã‚±ãƒƒãƒˆã«æ›¸ãè¾¼ã‚€æ™‚ã¯ã‚ªã‚¯ãƒ†ãƒƒãƒˆï¼Ÿ
  + æ–‡å­—åˆ—ã§è¿”ã™ï¼Ÿã‚ªã‚¯ãƒ†ãƒƒãƒˆã§è¿”ã™ï¼Ÿï¼ˆãƒ‡ãƒãƒƒã‚°ãŒãƒ¼ï¼‰
  + ã‚ªã‚¯ãƒ†ãƒƒãƒˆã®å¤‰æ›ã¯ã„ã¤ï¼Ÿ
* ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒé…ã„ï¼Ÿ
  + POSIX APIãŒä½¿ãˆã‚‹&#34;ãªã‚‰&#34;fdã®æ–¹ãŒé€Ÿã„ï¼Ÿ
* ãƒ¦ãƒ¼ã‚¶ãŒç”¨æ„ã—ãŸãƒãƒƒãƒ•ã‚¡ã«æ›¸ãå‡ºã—ãŸã„ï¼Ÿ
* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ¸¡ã™å¼•æ•°ãŒå®šæ•°æ–‡å­—åˆ—ãªã‚‰ç•³ã¿è¾¼ã‚ã‚‹ç­ˆï¼Ÿ
* ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®åº¦ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã®ã¯ç­‹æ‚ªã ã‘ã©é–‹ç™ºä¸­ã¯æ¯å›ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã®ã¯é¢å€’ï¼Ÿ
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;

# Arrows

Template flies like an arrow

&lt;!-- .slide: class=&#34;center&#34; --&gt;
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Arrows
--------
* [KeenS/arrows](https://github.com/KeenS/arrows)
* ç¾åœ¨é–‹ç™ºä¸­ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³
* è¤‡æ•°ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒé¸ã¹ã‚‹ï¼ˆäºˆå®šï¼‰
* è¤‡æ•°ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒé¸ã¹ã‚‹
* ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ä¾ã£ã¦ã¯non-consing
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How Arrows Works
------------------
## Compilation
1. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–‡å­—åˆ—&lt;span class=&#34;red&#34;&gt; + å®šæ•°å¼•æ•°&lt;/span&gt;
  + ãƒ‘ãƒ¼ã‚µ&lt;span class=&#34;red&#34;&gt;(default, cl-emdäº’æ›...)&lt;/span&gt; &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
2. æŠ½è±¡æ§‹æ–‡æœ¨
  + &lt;span class=&#34;red&#34;&gt;æœ€é©åŒ–(const folding, concat, convert...)&lt;/span&gt; &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
  + ã‚³ãƒ¼ãƒ‰ã‚¨ãƒŸãƒƒãƒˆ &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
3. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°&lt;span class=&#34;red&#34;&gt;(string, octets, stream, fast-io ...)&lt;/span&gt;
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How Arrows Works
------------------
## Rendering
1. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°
  + å¼•æ•° &lt;!-- .element: style=&#34;list-style-image: url(/images/arrow_down.svg);&#34; --&gt;
2. æ–‡å­—åˆ—&lt;span class=&#34;red&#34;&gt;ã€ã‚ªã‚¯ãƒ†ãƒƒãƒˆåˆ—ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ æ›¸ãå‡ºã—ã€fast-ioâ€¦&lt;/span&gt;
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How compiled
--------------
```html
&lt;h1&gt;Hi {{var name}}!&lt;/h1&gt;
```
ã‚’
```lisp
(compile-template-string :xxx
  &#34;&lt;h1&gt;Hi {{var name}}!&lt;/h1&gt;&#34; ())
```
ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
===
# Stream backend
----------------
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
```lisp
(lambda (stream &amp;key name)
  (write-string &#34;&lt;h1&gt;Hi &#34; stream)
  (write-string
    (encode-for-tt (princ-to-string name))
    stream)
  (write-string &#34;!&lt;/h1&gt;&#34; stream))
```
* ã»ã¨ã‚“ã©ã‚¢ãƒ­ã‚±ãƒ¼ãƒˆã—ãªã„
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Octet backend
----------------
```lisp
(lambda (&amp;key name)
  (with-fast-output (buffer)
    (fast-write-sequence
      #.(string-to-octets &#34;&lt;h1&gt;Hi &#34;)
       buffer)
    (fast-write-sequence
      (string-to-octets
        (encode-for-tt (princ-to-string name)))
                       buffer)
    (fast-write-sequence
      #.(string-to-octets &#34;!&lt;/h1&gt;&#34;)
      buffer)))
```
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How optimized
---------------
```html
&lt;h1&gt;Hi {{var name}}!&lt;/h1&gt;
```
ã‚’

```lisp
(compile-template-string :stream
   &#34;&lt;h1&gt;Hi {{var name}}!&lt;/h1&gt;&#34;
   &#39;(:known-args (:name &#34;&lt;Îºeen&gt;&#34;)))
```
ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How optimized
---------------
## variable folding
```lisp
(lambda (stream)
  (write-string &#34;&lt;h1&gt;Hi &#34; stream)
  (write-string (encode-for-tt &#34;&lt;Îºeen&gt;&#34;) stream)
  (write-string &#34;!&lt;/h1&gt;&#34; stream))
```
* æ—¢çŸ¥ã®å¼•æ•°ã¯ç•³ã¿è¾¼ã‚€
* æ–‡å­—åˆ—ãªã‚‰`princ-to-string`ã—ãªã„
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How optimized
---------------
## const folding
```lisp
(lambda (stream)
  (write-string &#34;&lt;h1&gt;Hi &#34; stream)
  (write-string &#34;&amp;lt;Îºeen&amp;gt;&#34; stream)
  (write-string &#34;!&lt;/h1&gt;&#34; stream))
```
* å®šæ•°ã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æ¸ˆã¾ã›ã‚‹
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# How optimized
---------------
## append sequence
```lisp
(lambda (stream)
  (write-string &#34;&lt;h1&gt;Hi &amp;lt;Îºeen&amp;gt;!&lt;/h1&gt;&#34;
                stream))
```
* è¤‡æ•°ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®æ›¸ãå‡ºã—ã¯1ã¤ã«ã¾ã¨ã‚ã‚‹
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Further Ideas
---------------
* å¼•æ•°è¨ˆç®—ã®é…å»¶
* å¼•æ•°è¨ˆç®—ã®ä¸¦åˆ—åŒ–
* éåŒæœŸåŒ–
* HTML compction
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Further Ideas
---------------
## å¼•æ•°è¨ˆç®—ã®é…å»¶
* `name`ã®è¨ˆç®—ãŒé‡ã„ã¨ãã«å…ˆã«`&#34;&lt;h1&gt;Hi &#34;`ã‚’è¿”ã™ã€‚
* `name`ã¯å¿…è¦ã«ãªã£ãŸã‚‰å€¤ã‚’è¨ˆç®—ã™ã‚‹(Promise ãƒ‘ã‚¿ãƒ¼ãƒ³)
```lisp
(lambda (stream &amp;key name)
  (write-string &#34;&lt;h1&gt;Hi &#34; stream)
  (write-string
    (encode-for-tt (princ-to-string name))
    stream)
  (write-string &#34;!&lt;/h1&gt;&#34; stream))
```
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Further Ideas
---------------
## å¼•æ•°è¨ˆç®—ã®ä¸¦åˆ—åŒ–
* `name`ã®è¨ˆç®—ãŒé‡ã„ã¨ãã«å…ˆã«`&#34;&lt;h1&gt;Hi &#34;`ã‚’è¿”ã™ã€‚
* `name`ã¯ä¸¦åˆ—ã«è¨ˆç®—ã—ã¦å¿…è¦ã«ãªã£ãŸã‚‰å€¤ã‚’è¦æ±‚ã™ã‚‹(Futureãƒ‘ã‚¿ãƒ¼ãƒ³)
```lisp
(lambda (stream &amp;key name)
  (write-string &#34;&lt;h1&gt;Hi &#34; stream)
  (write-string
    (encode-for-tt (princ-to-string name))
    stream)
  (write-string &#34;!&lt;/h1&gt;&#34; stream))
```
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Further Ideas
---------------
## éåŒæœŸåŒ–
* å˜ç´”ã«writeã‚’éåŒæœŸã«ã™ã‚‹
* ä»–ã«Futureã‚‚ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã®ã§éåŒæœŸFutureã‚’ä½¿ã†
===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# Further Ideas
---------------
## HTML compction
```html
&lt;ol&gt;
  &lt;li&gt; item 1 &lt;/li&gt;
  &lt;li&gt; item 2 &lt;/li&gt;
  &lt;li&gt; item 3 &lt;/li&gt;
&lt;/ol&gt;

```
ã‚’
```html
&lt;ol&gt;&lt;li&gt;item 1&lt;/li&gt;&lt;li&gt;item 2&lt;/li&gt;&lt;li&gt;item 3&lt;/li&gt;&lt;/ol&gt;

```
* DOMæ§‹é€ ãŒå¤‰ã‚ã£ã¦ã—ã¾ã†

===
&lt;!-- .slide: data-background=&#34;/images/arrows.jpg&#34; --&gt;
# TODOs
-------
* è¨­è¨ˆä¸Šè¤‡æ•°ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆå¯èƒ½ã ãŒã¾ã ã—ã¦ãªã„
* æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã¨ã®æ¯”è¼ƒãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
* é«˜é€ŸåŒ–
* å¤šæ©Ÿèƒ½åŒ–
  + ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  + æœ€é©åŒ–
  + ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
* clackã¨ã®é€£æº
  + clackã®APIã¯ãƒ¡ãƒ¢ãƒªã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¤šã‚ã«å¿…è¦ã«ãªã‚‹
===
# Summary
---------
* æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã¯éåŠ¹ç‡
  + ãƒ¡ãƒ¢ãƒªã‚’ç„¡é§„é£ã„ã—ã¦ã„ãŸ
  + ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã“ã¨ã‚’è€ƒãˆã¦ãªã‹ã£ãŸ
* æ–°ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­è¨ˆã—ãŸ
  + ãƒ¡ãƒ¢ãƒªã‚¢ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚ã¾ã‚Šã—ãªã„
  + ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã®é€Ÿåº¦ã¾ã§è€ƒæ…®ã—ãŸ
  + æŸ”è»Ÿ
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Common Lispã®ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£ã¨ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒªãƒ†ã‚£</title>
      <link>/blog/2015/01/22/common-lisp-portability-and-univesality</link>
      <pubDate>Thu, 22 Jan 2015 07:51:02 +0000</pubDate>
      
      <guid>/blog/2015/01/22/common-lisp-portability-and-univesality</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://clfreaks.org/post/108341635899/1-cim-vs-roswell&#34;&gt;clfreaks&lt;/a&gt;ã®åéŒ²æ™‚ã«ä»–ã®Lisperã¨è©±ã—ã¦ã¦ä¾¡å€¤è¦³ã¨ã„ã†ã‹ç›®æ¨™ã‚’å…±æœ‰å‡ºæ¥ã¦ãªã„ãªã¨æ€ã£ãŸã®ã§ã“ã“ã§å¿ƒæƒ…ã‚’èªã‚‹æ¬¡ç¬¬ã€‚ä»Šã®Common Lispã®ä½¿ã‚ã‚Œæ–¹ã«ã¯å•é¡ŒãŒã‚ã‚‹ã€‚

Common Lispã«ã¯ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£ã¨ã„ã†ã‹ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒªãƒ†ã‚£ã¨ã„ã†ã‹ã€ãã†ã„ã†ã‚‚ã®ãŒãªã„ã€‚ã„ã‚„ã€å‡¦ç†ç³»ã®ä½œè€…é”ã¯ã—ã£ã‹ã‚Šä½œã£ã¦ã‚‹ã®ã ã‘ã©LisperãŒãã†ã„ã†ä½¿ã„æ–¹ã‚’ã—ã¦ã„ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹ãˆã°ã€Rubyã§å‡ºæ¥ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ã„ãŸã„ã¨ã—ã‚ˆã†ã€‚JekyllãŒã„ã„ã‹ãªã€‚å¤§æŠµã®ã‚·ã‚¹ãƒ†ãƒ ã«ã¯å…¥ã£ã¦ã‚‹ã ã‚ã†ãŒä¸€å¿œå‡¦ç†ç³»ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰å§‹ã‚ã¦ã¿ã‚‹ã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;aptãªã‚Špkgãªã‚Šyumãªã‚Šã§å‡¦ç†ç³»ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ãã‚ŒãŒæ°—ã«å…¥ã‚‰ãªã‘ã‚Œã°ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚‚ã„ã„ã€‚&lt;/li&gt;
&lt;li&gt;å‡¦ç†ç³»ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨gemãŒã¤ã„ã¦ãã‚‹ã®ã§&lt;code&gt;gem install jekyll&lt;/code&gt;ã‚’å©ãã€‚&lt;/li&gt;
&lt;li&gt;ã‚ã¨ã¯Jekyllã‚’ä½¿ã†ã ã‘ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã‚ã‚‹ã„ã¯ã€Octopressãªã‚‰å‡¦ç†ç³»ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ã‚ã¨ã¯&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;git cloneã—ã¦ãã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gem install bundler&lt;/code&gt;ã§bundlerã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bundle install&lt;/code&gt;ã§ä¾å­˜gemã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bundle exec rake preview&lt;/code&gt;ã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;æ­¢ã‚ãŸã‘ã‚Œã°Ctrl-Cã§æ­¢ã¾ã‚‹ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Common Lispã§å‡ºæ¥ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ã„ãŸã„ã¨ã—ã‚ˆã†ã€‚&lt;a href=&#34;https://github.com/vsedach/cliki2&#34;&gt;cliki&lt;/a&gt;ã€‚ãŒã„ã„ã‹ãªã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‡¦ç†ç³»ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯Rubyã¨åŒã˜ããƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã§å…¥ã‚‹ã€‚ã‚ã‚‹ã„ã¯ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚‚ã„ã„ã€‚ã“ã®éš›å‡¦ç†ç³»é¸ã³ã¯æ—¢ã«çµ‚ã‚ã£ã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;clikiã‚’git cloneã—ã¦ãã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ASDFã«èª­ã‚“ã§ã‚‚ã‚‰ã†ãŸã‚ã«~/common-lispä»¥ä¸‹ã«clikiã‚’ç§»å‹•ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ãŸã‚ã«quicklispã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

&lt;ul&gt;
&lt;li&gt;quicklisp.lispã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;REPLã‚’èµ·å‹•ã™ã‚‹ã€‚ã©ã†ã‚„ã£ã¦ï¼Ÿå‡¦ç†ç³»ä¾å­˜ã ã‹ã‚‰è‡ªåˆ†ã§èª¿ã¹ã‚ã€‚&lt;/li&gt;
&lt;li&gt;Lispã®å¼ã‚’ã„ãã¤ã‹è©•ä¾¡ã—ã¦quicklispã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚~/quicklispãŒå‡ºç¾ã™ã‚‹ãŒã“ã®éš›ç›®ã‚’ç‘ã‚‹ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;REPLã§&lt;code&gt;(ql:quickload :cliki)&lt;/code&gt;ã‚’è©•ä¾¡ã—ã¦ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;(start-cliki-server port homedir wikis)&lt;/code&gt;ã§ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹ã€‚REPLã‚‚èµ·å‹•ã—ã£ã±ãªã—ã€‚&lt;/li&gt;
&lt;li&gt;æ­¢ã‚ãŸã‘ã‚Œã°

&lt;ul&gt;
&lt;li&gt;Ctrl-Cã§interactive-interruptã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚’ç™ºç”Ÿã•ã›ã‚‹ã€‚ãƒ‡ãƒãƒƒã‚¬ãŒèµ·å‹•ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ãƒ‡ãƒãƒƒã‚¬ã‹ã‚‰REPLã®toplevelã«æˆ»ã‚‹ã€‚ãƒ‡ãƒãƒƒã‚¬ã®æ“ä½œ?å‡¦ç†ç³»ä¾å­˜ã ã‹ã‚‰è‡ªåˆ†ã§èª¿ã¹ã‚ã€‚&lt;/li&gt;
&lt;li&gt;REPLã‚’çµ‚äº†ã™ã‚‹ã€‚ã©ã†ã‚„ã£ã¦ï¼Ÿå‡¦ç†ç³»ä¾å­˜ã ã‹ã‚‰è‡ªåˆ†ã§èª¿ã¹ã‚ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯~/common-lispã˜ã‚ƒãªãã¦/var/wwwã«ç½®ããŸã„ã‚“ã ã‘ã©ã€ - ã€Œã‚³ãƒ³ãƒ•ã‚£ã‚°æ›¸ã„ãŸã‚‰å¤‰ãˆã‚‰ã‚Œã‚‹ã‚ˆã€‚ASDFã®ã‚³ãƒ³ãƒ•ã‚£ã‚°æ›¸ã„ã¦ã­ã€‚ã‚³ãƒ³ãƒ•ã‚£ã‚°ã®æ›¸ãæ–¹ã¯Lisperã®å¸¸è­˜ã ã‚ˆã­ã€&lt;br /&gt;
ã€Œ~/quicklispé‚ªé­”ãªã‚“ã ã‘ã©ã€ - ã€Œã‚ã‚ã€ãã‚Œã‚‚å¤‰ãˆã‚‰ã‚Œã‚‹ã‚ˆã€‚å¥½ããªå ´æ‰€ã«ç§»å‹•ã—ã¦å‡¦ç†ç³»ã®åˆæœŸåŒ–ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãç›´ã—ã¦ã­ã€‚åˆæœŸåŒ–ãƒ•ã‚¡ã‚¤ãƒ«ï¼Ÿå‡¦ç†ç³»ä¾å­˜ã ã‹ã‚‰è‡ªåˆ†ã§èª¿ã¹ã‚ã€‚ã©ã†ç›´ã™ã‹ï¼Ÿç°¡å˜ãªLispã®å¼ã ã‹ã‚‰è‡ªåˆ†ã§ç›´ã›ã‚‹ã‚ˆã­ï¼Ÿã€&lt;/p&gt;

&lt;p&gt;å¤šåˆ†è¨€ã„ãŸã„ã“ã¨ã¯ä¼ã‚ã£ãŸã‹ã¨æ€ã†ã€‚ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰æ‰±ãˆãªã„ã¨ã‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãŒæˆ‘ãŒå„˜ã¨ã‹è‰²ã€…ã‚ã‚‹ã‚“ã ã‘ã©å…¨ã¦ã¯ã€ŒLisperã®ãŸã‚ã ã‘ã®ã‚‚ã®ã«ãªã£ã¦ã„ã‚‹ã€ã®ä¸€è¨€ã§è¡¨ã›ã‚‰ã‚Œã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;quicklispãŒæˆ‘ãŒå„˜ãªã®ã¯ã¾ã è¨±ã›ã‚‹ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå›ºå®šã•ã‚Œã¦ãªã„ã¨ç®¡ç†ã—ã¥ã‚‰ã„ã‹ã‚‰ã€‚ã—ã‹ã—ASDFãŒãƒ©ã‚¤ãƒ–ãƒ©ãƒªã˜ã‚ƒãªãã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¾ã§ç‰¹å®šã®ãƒ‘ã‚¹ã«ã‚ã‚‹ã“ã¨ã‚’è¦æ±‚ã—ã¦ãã‚‹ã®ã¯ç´å¾—ãŒã„ã‹ãªã„ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„ã‚‰ãƒ­ãƒ¼ãƒ‰ã‚„ã‚‰ãƒ†ã‚¹ãƒˆã‚„ã‚‰ã®æ©Ÿèƒ½ãŒã‚ã‚‹ã‚“ã ã‹ã‚‰.asdãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ«ãƒ¼ãƒˆã¨ã—ã¦ãã“ã ã‘ã§å®Œçµã—ã¦ã»ã—ã„ã€‚ä»¥å‰ã€&lt;a href=&#34;/blog/2014/11/30/quicklisp/&#34;&gt;ã“ã‚“ãªè¨˜äº‹&lt;/a&gt;ã‚’æ›¸ã„ãŸæ‰€ç‚ºã§ASDFã®ä¿¡è€…ã¨æ€ã‚ã‚Œã¦ã„ã‚‹ã¿ãŸã„ã ãŒã€ã©ã£ã¡ã‹ã¨ã„ã†ã¨ASDFã®æ–¹ãŒå«Œã„ã ã€‚ASDFãŒæ†–ã£ã‹ä¾å­˜é–¢ä¿‚ã®è§£æ±ºã¾ã§ã™ã‚‹ãŒãŸã‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç½®ãå ´ã¾ã§åˆ¶ç´„ã‚’å—ã‘ã‚‹ã€‚æ‰‹ã‚’åºƒã’ãŸãŒãŸã‚ã«æœ¬æ¥ã®æ©Ÿèƒ½ãŒä½¿ã„è¾›ããªã£ã¦ã„ã‚‹ã€‚LisperãŒåˆ¶ç´„ã‚’å—ã‘ã‚‹ã®ã¯ã¾ã ã„ã„ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ã«ã¾ã§åˆ¶ç´„ãŒåŠã¶ã®ã¯è€ãˆã‚‰ã‚Œãªã„ã€‚&lt;/p&gt;

&lt;p&gt;ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰æ‰±ãˆãªã„å•é¡Œã¯å¤šåˆ†ãƒã‚¦ãƒã‚¦ãŒãªã‹ã£ãŸã‹ã‚‰ã ã¨æ€ã†ã€‚&lt;a href=&#34;/blog/2014/12/08/ge-tochu-li-xi-potaburunacommon-lispshi-xing-ke-neng-huairuwozuo-ru/&#34;&gt;ä»¥å‰ã®è¨˜äº‹&lt;/a&gt;ã§ç´¹ä»‹ã—ãŸæ–¹æ³•ã¯å¤šåˆ†çŸ¥ã‚‰ã‚Œã¦ã„ãªã‹ã£ãŸã€‚ã‚ã¨ã¯è¤‡é›‘ã§ä½¿ã„è¾›ã„ã¨è©•åˆ¤(ã ã£ãŸ)ã®cl-launchã‹ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãŠã‚ã‹quicklispã™ã‚‰REPLã«å…¥ã‚‰ãªã„ã¨ä½¿ãˆãªã„ã€‚ãƒ¦ãƒ¼ã‚¶ãŒLispã‚’å¾®å¡µã‚‚çŸ¥ã‚‰ãªã„å¯èƒ½æ€§ã™ã‚‰ã‚ã‚‹ã®ã«ã€‚ã•ã‚‰ã«ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ä½¿ãˆãªã„ã¨ã„ã†ã“ã¨ã¯ä»–ã®Unixãƒ„ãƒ¼ãƒ«ç¾¤ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã‚‚å›°é›£ã«ãªã‚‹ã€‚ã¾ãŸã€&lt;a href=&#34;http://blog.8arrow.org/entry/20120323/1332516342&#34;&gt;ã“ã“&lt;/a&gt;ã«ã‚ã‚‹ã‚ˆã†ã«REPLã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¦ã„ã‚‹ã¨å•é¡Œã‚‚ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ç§ã¯ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«CIMã‚’ä½œã£ãŸã€‚clfreaksã®æ™‚ã«ã‚‚å–‹ã£ãŸãŒCIMã®ãƒ¡ã‚¤ãƒ³ã®æ©Ÿèƒ½ã¯&lt;code&gt;cl&lt;/code&gt;ã‚³ãƒãƒ³ãƒ‰ã¨&lt;code&gt;ql&lt;/code&gt;ã‚³ãƒãƒ³ãƒ‰ã ã€‚&lt;code&gt;cim&lt;/code&gt;ã‚³ãƒãƒ³ãƒ‰ã¯ãŸã ã®ä»˜åŠ ä¾¡å€¤ã®ãŸã‚ã«ã¤ã‘ãŸãŠã¾ã‘ã§ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã‚‚ã—clã‚³ãƒãƒ³ãƒ‰ãŒåºƒãä½¿ã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Œã°shebangã«clã‚’ä½¿ã†ã ã‘ã§å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œã‚Œã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚qlã‚’ä½¿ãˆã°REPLã«å…¥ã‚‰ãšã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‡ºæ¥ã‚‹ã€‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¦ã‚‚ãƒ‡ãƒãƒƒã‚¬ã«å…¥ã‚‹ã‚ˆã†ãªã“ã¨ã¯ãªã„ã€‚Ctrl-Cã§ã¡ã‚ƒã‚“ã¨æ­¢ã¾ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã§ä¸€éƒ¨ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒªãƒ†ã‚£ã®å•é¡Œã¯è§£æ±ºå‡ºæ¥ãŸã‚“ã ã‘ã ã¾ã ã¾ã æœªè§£æ±ºå•é¡ŒãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;CIMã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã«ãªã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã¯è§£æ±ºã—ãŸã«ã—ã¦ã‚‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸¸ã”ã¨æŒã£ã¦ãã‚‹ã‚ˆã†ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ASDFã®åˆ¶ç´„ã‚’ã†ã‘ã‚‹&lt;/li&gt;
&lt;li&gt;ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®å•é¡Œ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;1ã¯ã‚„ã£ã±ã‚ŠLispã‚’çŸ¥ã‚‰ãªã„äººã«ä½¿ã£ã¦ã‚‚ã‚‰ã„ãŸã„ãªã‚‰CIMã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯çœããŸã„ã€‚å‡¦ç†ç³»ã¨quicklispã ã‘å…¥ã‚ŒãŸã‚‰ä½¿ãˆã¦ã»ã—ã„ã€‚ã‚„ã£ã±ã‚Šquicklispã«å¤‰ã‚ã£ã¦ã‚‚ã‚‰ã†ã—ã‹ãªã„ã®ã‹ãªã€‚é…å¸ƒç‰©ã«å®Ÿè¡Œå¯èƒ½å½¢å¼ã‚’å«ã‚ã¦ãŸã‚‰PATHã‚‚é€šã—ã¦æ¬²ã—ã„ã—ã€‚&lt;/p&gt;

&lt;p&gt;2ã®ASDFã®åˆ¶ç´„ã®å•é¡Œã¯ASDFã‚’ç’°å¢ƒå¤‰æ•°ã§åˆ¶å¾¡å‡ºæ¥ã‚‹ã‚ˆã†ãªã®ã§ã†ã¾ã„ã“ã¨ã™ã‚‹æ–¹æ³•ã‚’è€ƒãˆã¦ã„ã‚‹ã€‚è‰¯ã„æ–¹æ³•ãŒã‚ã£ãŸã‚‰ã¾ãŸã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã™ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;3ã¯ç¾çŠ¶CIMã§æ‰±ã„ã‹ã­ã¦ã‚‹å•é¡Œã€‚ãƒã‚¯ãƒ­å±•é–‹ã®å•é¡Œã‹ã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã®ãŒæœ›ã¾ã—ã„ã‚“ã ã‘ã©ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã«äº’æ›æ€§ãŒãªã„ã€‚ã—ã‹ã‚‚äº’æ›æ€§ãŒãªã„ã®ã«åŒã˜æ‹¡å¼µå­ã‚’ä½¿ã†ã€‚ãã“ã‚’ä¸Šæ‰‹ãæ‰±ã£ã¦ãã‚Œã‚‹ã®ã¯ASDFãªã‚“ã ã‘ã©ã‚„ã£ã±ã‚Šå¥´ã¯æˆ‘ãŒå„˜ã ã—ä½•ã‚ˆã‚Šã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã—ã¾ã†ã¨Allegroã‚’é™¤ã„ã¦shebangãŒåŠ¹ã‹ãªããªã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;è§£æ±ºæ¡ˆã¯ã„ãã¤ã‹ä¸ŠãŒã£ã¦ã‚‹ã‚“ã ã‘ã©ã¾ã æ±ºå®šçš„ãªã‚‚ã®ã¯ãªã„ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã‚ãã‚‰ã‚ã‚‹&lt;/li&gt;
&lt;li&gt;æœ¬ä½“ã ã‘ASDFã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãªã„&lt;/li&gt;
&lt;li&gt;ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒã‚¤ãƒŠãƒªé…å¸ƒã™ã‚‹&lt;/li&gt;
&lt;li&gt;ECLã‚’ä½¿ã£ã¦Cã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…å¸ƒã™ã‚‹&lt;/li&gt;
&lt;li&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã«ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒã‚¤ãƒŠãƒªã‚’ä½œã‚‰ã›ã‚‹&lt;/li&gt;
&lt;li&gt;ç‰¹å®šã®å‡¦ç†ç³»ã‚’è¦æ±‚ã™ã‚‹&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;1ã¯ä¸‹ã®ç­–ã€‚&lt;/p&gt;

&lt;p&gt;2ã¯å€‹äººçš„ã«æ¨ã—ãŸã„ã¨ã“ã‚ã ã‘ã©ã‚„ã£ã±ã‚ŠASDFãŒæ†ã„ã€‚&lt;/p&gt;

&lt;p&gt;3ã¯ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒå£Šæ»…çš„ãªCommon Lispã§ã¯ç¾å®Ÿçš„ã§ã¯ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;4ã¯Common Lispã®åˆ©ç‚¹ã®ä¸€ã¤ã«SBCLã‚„CCLã‚„CMU CLã®é€Ÿåº¦ãŒé€Ÿã„ã¨ã„ã†ã®ãŒã‚ã‚‹ã‹ã‚‰å‡ºæ¥ã‚Œã°è‡ªç”±ã«å‡¦ç†ç³»ã‚’é¸ã°ã›ãŸã„ã€‚ã‚ã¨ECLã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã«ãªã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;5ã¯ã‚„ã£ã±ã‚ŠASDFãŒæ†ã„ã€‚ãã‚Œã«ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã«ã¯quicklispã‚‚ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã£ã¦ã€ä»¥å‰ã®è¨˜äº‹ã®é€šã‚Šãƒã‚¤ãƒŠãƒªã«é‚ªé­”ãªã‚‚ã®ãŒå…¥ã‚‹ã—ãã†ã§ãªãã¦ã‚‚ãƒã‚¤ãƒŠãƒªãŒç´ ã§60MBã¨ã‹ã«ãªã‚‹ã€‚stripã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å‹•ã‹ãªããªã‚‹ã‹ã‚‰stripã‚‚å‡ºæ¥ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;6ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªå‡¦ç†ç³»ã¯ABCLã€CLISPã€XCLã‚ãŸã‚Šã ãŒã€èµ·å‹•ã®é…ã„ABCLã€å¾®å¦™ã«ä»•æ§˜ã«å¾“ã£ã¦ãªãã¦é–‹ç™ºã‚‚åœæ»æ°—å‘³ãªCLISPã€æ—¢ã«é–‹ç™ºã•ã‚Œã¦ã„ãªã„ä¸Šã«ãƒã‚¤ãƒŠãƒ¼ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚µãƒãƒ¼ãƒˆã‚‚è–„ã„XCLã¨ã‚ã¾ã‚Šé¸ã³ãŸããªã„ã‚‚ã®ã°ã‹ã‚Šã€‚&lt;/p&gt;

&lt;p&gt;å› ã¿ã«éLispãƒ¦ãƒ¼ã‚¶ã«ã‚‚ä½¿ã‚ã‚Œã¦ã„ã‚‹Common Lispã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«StumpWMãŒã‚ã‚‹ãŒã€5ã®æ–¹æ³•ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ã€‚ã—ã‹ã—ASDFã‚’ä½¿ã‚ãšã«Makefileã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ã„ã‚‹ã€‚ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚æ‰‹ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å‡ºæ¥ã‚Œã°Common Lispã®ãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ã«è¼‰ã›ãŸã¾ã¾é…å¸ƒã—ãŸã„ã¨ã“ã‚â€¦&lt;/p&gt;

&lt;p&gt;ç ”ç©¶ãŒå¿…è¦ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>å®Ÿç”¨Common Lispã‚’èª­ã‚“ã </title>
      <link>/blog/2014/12/14/shi-yong-common-lispwodu-nda</link>
      <pubDate>Sun, 14 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>/blog/2014/12/14/shi-yong-common-lispwodu-nda</guid>
      <description>&lt;p&gt;ä»¥å‰&lt;a href=&#34;/blog/2014/10/20/lisp-ja/&#34;&gt;Common Lispã®å‹‰å¼·ã®æ‰‹å¼•ã®è¨˜äº‹&lt;/a&gt;ã‚’æ›¸ã„ãŸã¨ãã«å®Ÿç”¨Common Lispã®åã‚’æŒ™ã’ãŸãŒèª­ã‚“ã ã“ã¨ã¯ãªã‹ã£ãŸã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å¿œåå‰ã‚’æŒ™ã’ãŸè²¬ä»»ã¨ã—ã¦èª­ã‚“ã§ã¿ãŸã€‚

èª­ã‚“ã ã¨ã¯è¨€ã£ã¦ã‚‚ã‚½ãƒ¼ã‚¹ã¯ã–ã£ãã‚Šã—ã‹è¦‹ã¦ãªã„ã—ã€æ¼”ç¿’ã«ã¯ç›®ã‚‚ãã‚Œã¦ãªã„ã®ã§ã€Œä¸€é€šã‚Šç›®ã‚’é€šã—ãŸã€ç¨‹åº¦ã€‚
è²·ã£ãŸæœ¬ã¯é€ƒã’ãªã„ã®ã ã—ä¸€å›ã§ç†è§£ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚æœ€åˆã«ä¸€é€šã‚Šå†…å®¹ã‚’æ´ã‚“ã§ä¸»å¼µã‚’ç†è§£ã—ã¦ã‹ã‚‰ã€ã‚ã¨ã§æ°—ã«ãªã£ãŸæ™‚ã«ã¤ã¶ã•ã«èª­ã‚€ã®ãŒç§ã®èª­ã¿æ–¹ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åˆã®æ„Ÿæƒ³ã‚’è¨€ã†ã¨ã€å¤ã„ã€‚Common Lispã‚‚cltl2ã¨ANSIä¸¡æ–¹ã«é…æ…®ã•ã‚Œã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹ã—ã€ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹AIã®äº‹ä¾‹ã‚‚1970~1980å¹´ä»£ã®ã‚‚ã®ã€‚
å¤å…¸ã¨ã„ã£ãŸæ„Ÿã˜ã€‚ãŸã ã—ã€ãã®æ™‚ä»£ã¯Common Lispã¨AIã®æœ€ç››æœŸãªã®ã§ã“ã®æœ¬ã‚’èª­ã‚ã°Common LispãŒAIã§åã‚’é¦³ã›ãŸç†ç”±ãŒè‰¯ãåˆ†ã‹ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;Common Lispã®å†…å®¹ã¯åˆç´šç¨‹åº¦ã€‚ã¾ãˆãŒãã«ã‚‚ã‚ã‚‹ã‚ˆã†ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒã¨ã—ã¦ã¯ä¸­ç´šã ãŒLispã¯åˆå¿ƒè€…ãƒ¬ãƒ™ãƒ«ã®äººå‘ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚åŸºæœ¬çš„ãªã¨ã“ã‚ã‚’æŠ¼ãˆãŸã‚‰ã‚ã¨ã¯ã©ã‚“ã©ã‚“é€²ã‚“ã§ã„ãã€‚
ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®çµŒé¨“ãŒã‚ã‚Œã°ãã‚Œã§ã‚‚å•é¡Œãªã„ç­ˆã€‚å¿ƒé…ãªã‚‰Webä¸Šã«ã„ãã‚‰ã§ã‚‚ã‚ã‚‹ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ã“ãªã›ã°è‰¯ã„ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ã«é–¢ã—ã¦ã¯æœ¬ã®ä¸­ã§å®Œçµã—ã¦ã„ã‚‹ã®ã§è‰¯ãè¨€ãˆã°1ã‹ã‚‰10ã¾ã§æ•™ãˆã¦ãã‚Œã‚‹ã€‚æ‚ªãè¨€ãˆã°æœ€è¿‘ã®Common Lispã®å‹•å‘ã¯å…¨ãåˆ†ã‹ã‚‰ãªã„ã€‚ãã®æ„å‘³ã§ã¯å®Ÿè·µå…¥é–€ã§ã¯ãªãå­¦ç¿’å›³æ›¸ã€‚é™³è…åŒ–ã¯ã—ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;AIã«ã¤ã„ã¦ã¯ã€ã‚„ã¯ã‚Šå¤ã„ã€‚ä»Šã§ã¯æ‰‹æ³•ãŒç¢ºç«‹ã•ã‚Œã¦AIã®åˆ†é‡ã¨ã¯æ‰±ã‚ã‚Œãªã„ã‚‚ã®ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã€‚ãŸã ã—ã€ã“ã‚Œã¯æ„å›³ã—ãŸã‚‚ã®ãªã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚
å¤ã„ã‚‚ã®ã¨ã„ã†ã®ã¯å˜ç´”ã ã€‚æœ€åˆã«2éƒ¨ã§å˜ç´”ãªã‚‚ã®ã‚’é€šã—ã¦ã€Œè‚©é¦´ã‚‰ã—ã€ã‚’ã—ã¦ã‹ã‚‰3éƒ¨ã§æ‰‹é§’ã‚’å¢—ã‚„ã—ã¦4éƒ¨ã§è¸ã¿è¾¼ã‚“ã å†…å®¹ã«å…¥ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã¾ãŸã€AIã®åˆ†é‡ã¨ã—ã¦ã¯æ‰±ã‚ã‚Œã¦ã„ãªã‚‚ã®ã‚‚å«ã‚€ã€ã¨ã„ã†ã“ã¨ã¯ã“ã®æœ¬ãŒæƒ…å ±ç§‘å­¦ã®åºƒã„ç¯„å›²ã‚’ã‚«ãƒãƒ¼ã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã§ã‚‚ã‚ã‚‹ã€‚900ãƒ™ãƒ¼ã‚¸ã¯ä¼Šé”ã˜ã‚ƒãªã„ã€‚é‡ã‚‚ã‚ã‚Œã°ãƒãƒ©ã‚¨ãƒ†ã‚£ã‚‚ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ç¾å®Ÿã«ã‚ã‚‹æ§˜ã€…ãªé›£è§£ãªå•é¡Œã‚’Common Lispã¨ã„ã†å¼·åŠ›ãªé“å…·ã§å¿«åˆ€ä¹±éº»è§£æ±ºã—ã¦ã„ãã€‚ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•ã‚’å­¦ã³ãªãŒã‚‰Common Lispã®å¼·åŠ›ã•ã‚’æ€ã„çŸ¥ã‚‹ãŸã‚ã®ä¸€å†Šã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>å‰²ã¨å‡¦ç†ç³»ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªCommon Lispå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹</title>
      <link>/blog/2014/12/08/ge-tochu-li-xi-potaburunacommon-lispshi-xing-ke-neng-huairuwozuo-ru</link>
      <pubDate>Mon, 08 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>/blog/2014/12/08/ge-tochu-li-xi-potaburunacommon-lispshi-xing-ke-neng-huairuwozuo-ru</guid>
      <description>&lt;p&gt;Îºeenã§ã™ã€‚Lisp Advent Calendarã¯ã‚‚ã†æ åŸ‹ã¾ã£ã¡ã‚ƒã£ãŸã®ã§æ™®é€šã«ãƒ–ãƒ­ã‚°ã§ã€‚&lt;/p&gt;

&lt;p&gt;ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œå¯èƒ½ãªLispãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãã‚Œãªã‚Šã«å¤šãã®å‡¦ç†ç³»ã§å‹•ãã‚ˆã†ã«ä½œã‚‹è©±ã€‚
&lt;/p&gt;

&lt;p&gt;ã“ã®è©±ã¯CIMã®ç”Ÿã„ç«‹ã¡ã¨ã‚‚é–¢é€£ã™ã‚‹ã‚“ã ã‘ã©ã‚·ã‚§ãƒ«ã‹ã‚‰Lispã‚’ä½¿ã„ãŸã„ã¨ãã¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/usr/bin/env sbcl --script

...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãªã‚“ã¦æ›¸ã„ã¦ãŸäººã‚‚å¤šã„ã‚“ã˜ã‚ƒãªã„ã‹ã¨æ€ã†ã‚“ã ã‘ã©ã“ã‚Œã¯è‰²ã€…å•é¡ŒãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;envã¯ç’°å¢ƒã«ä¾ã£ã¦ã¯/usr/local/bin/envã ã£ãŸã‚Šã™ã‚‹&lt;/li&gt;
&lt;li&gt;envã¯ç’°å¢ƒã«ä¾ã£ã¦ã¯è¤‡æ•°å¼•æ•°ã‚’å–ã‚Œãªã„ã€‚&amp;rdquo;sbcl &amp;ndash;script&amp;rdquo;ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœã—ã«ã„ã&lt;/li&gt;
&lt;li&gt;sbclã§ã—ã‹å‹•ã‹ãªã„&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ã“ã®å•é¡Œã®æ‰±ã„ã¯ä¸€å¿œè§£æ±ºç­–ãŒã‚ã‚‹&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/sh

#|
exec sbcl --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
|#

...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3è¡Œç›®ã®&lt;code&gt;#|&lt;/code&gt;ãŒã‚·ã‚§ãƒ«ã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã‚ã‚ŠLispã®ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã§ã‚ã‚‹ã®ãŒãƒã‚¤ãƒ³ãƒˆã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ã‚·ã‚§ãƒ«ã¯&lt;code&gt;#!/bin/sh&lt;/code&gt;ã‚’è¦‹ã¦ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã™ã‚‹&lt;/li&gt;
&lt;li&gt;1,3è¡Œç›®ã¯ã‚³ãƒ¡ãƒ³ãƒˆãªã®ã§ã‚·ã‚§ãƒ«ã¯ç„¡è¦–&lt;/li&gt;
&lt;li&gt;4è¡Œç›®ã§sbclã«ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¼•æ•°ã¨ã—ã¦ä¸ãˆã¦execã™ã‚‹ã€‚execã—ãŸã‚ã¨ã¯ã‚·ã‚§ãƒ«ã«ã¯æˆ»ã‚‰ãªã„ã®ã§ãã®å¾Œä½•ãŒæ›¸ã„ã¦ã‚ã£ã¦ã‚‚æ§‹ã‚ãªã„&lt;/li&gt;
&lt;li&gt;sbclã‚’&lt;code&gt;--script&lt;/code&gt;ä»˜ãã§èª­ã‚“ã§ã‚‹ã®ã§1è¡Œç›®ã®&lt;code&gt;#!&lt;/code&gt;ã§å§‹ã¾ã‚‹è¡Œã¯ç„¡è¦–ã™ã‚‹&lt;/li&gt;
&lt;li&gt;3~5è¡Œç›®ã¯ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆãªã®ã§sbclã¯ç„¡è¦–&lt;/li&gt;
&lt;li&gt;ãã‚Œä»¥é™ãŒLispã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ã¨ã„ã†ã‚«ãƒ©ã‚¯ãƒªã«ãªã£ã¦ã„ã‚‹ã€‚ã“ã†ã„ã†ã®ã‚’ãƒ”ã‚¸ãƒ³è¨€èªã£ã¦ã„ã†ã‚“ã ã‘ï¼Ÿ&lt;/p&gt;

&lt;p&gt;ã¾ã‚ã„ã„ã‚„ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã“ã‚ã§ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸­ã«ã¯ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ›¸ãæ”¾é¡Œã ã‚ˆã­ï¼Ÿãã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§ã©ã®Lispä½¿ã†ã‹æ±ºã‚ãŸã‚‰ãƒãƒ¼ã‚¿ãƒ–ãƒ«ã«ãªã‚Šãã†ã˜ã‚ƒãªã„ï¼Ÿ&lt;/p&gt;

&lt;p&gt;ã“ã†ã„ã†ã®ã¯ã©ã†ï¼Ÿ&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;#!/bin/sh

#|
run_if_exists(){
 command -v $1 &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exec &amp;quot;$@&amp;quot;
}
 run_if_exists sbcl --noinform --no-sysinit --no-userinit --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists clisp -norc --quiet --silent -on-error exit  &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ecl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists mkcl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists alisp -qq -#! &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
|#

(write-line (lisp-implementation-type))
(force-output)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;cclã¨abclã¯1è¡Œç›®ã®ã‚·ã‚§ãƒãƒ³ã‚’èª­ã¿é£›ã°ã›ãªã‹ã£ãŸ&amp;amp;è©•ä¾¡çµæœã‚’ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ã—ãªã„æ–¹æ³•ãŒè¦‹å½“ã‚‰ãªã‹ã£ãŸã‹ã‚‰ãƒ‘ã‚¹ã€‚CMUCLã¯è‡ªåˆ†ã®ç’°å¢ƒã§å‹•ã‹ãªã„ã‹ã‚‰æ¤œè¨¼å‡ºæ¥ã¦ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã§ãƒãƒ¼ã‚¿ãƒ–ãƒ«ã«å®Ÿè¡Œã¯å¯èƒ½ã€‚ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®æ‰±ã„ã¨ã‹ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é ¼ã£ã¦ãã‚Œã€‚å› ã¿ã«CIMã§ã¯&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;  #+allegro  (cdr (system:command-line-arguments))
  #+sbcl (do*  ((var sb-ext:*posix-argv* (cdr list))
                (list var var))
               ((string= (car list) &amp;quot;--&amp;quot;) (return (cdr list))))
  #+clisp ext:*args*
  #+ecl (do*  ((var (si:command-args) (cdr list))
               (list var var))
              ((string= (car list) &amp;quot;--&amp;quot;) (return (cdr list))))
  #+abcl extensions:*command-line-argument-list*
  #+gcl (do*  ((var si::*command-args* (cdr list))
               (list var var))
              ((string= (car list) &amp;quot;--&amp;quot;) (return (cdr list))))
  #+cmu ext:*command-line-words*
  #+ccl ccl:*unprocessed-command-line-arguments*
  #+mkcl (do*  ((var (si:command-args) (cdr list))
               (list var var))
              ((string= (car list) &amp;quot;--&amp;quot;) (return (cdr list))))
  #+lispworks system:*line-arguments-list*
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã—ã¦ã„ã‚‹ã€‚å‚è€ƒã¾ã§ã«ã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>claspãŒã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚ŒãŸã‚ˆ</title>
      <link>/blog/2014/12/06/claspgaatupudetosaretayo</link>
      <pubDate>Sat, 06 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>/blog/2014/12/06/claspgaatupudetosaretayo</guid>
      <description>&lt;p&gt;ã“ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã¯&lt;a href=&#34;http://qiita.com/advent-calendar/2014/lisp&#34;&gt;Lisp Advent Calendar 2014&lt;/a&gt;6æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚&lt;br /&gt;
å‰: nobkzã•ã‚“ã§ &lt;a href=&#34;http://qiita.com/nobkz/items/2be2b6806237d8ea6e21&#34;&gt;lfe - (lisp (flavored (erlang)))ã«ã¤ã„ã¦åŸºæœ¬ãã®1 - Qiita&lt;/a&gt;&lt;br /&gt;
å¾Œ: ç§ã§ &lt;a href=&#34;/blog/2014/12/07/h2onipicrinworong-kasu/&#34;&gt;H2Oã«picrinã‚’æº¶ã‹ã™ | Îºeenã®Happy HacÎºing Blog&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Îºeenã§ã™ã€‚ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚ã£ã¡ã‚ƒæ›¸ã„ã¦ã¾ã™ã­ã€‚
&lt;/p&gt;

&lt;h1 id=&#34;clasp&#34;&gt;Clasp!&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/drmeister/clasp&#34;&gt;clasp&lt;/a&gt;ã®masterã«è‰²ã€…ãƒãƒ¼ã‚¸ã•ã‚Œã¾ã—ãŸã€‚ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã«ã¯ã€&lt;/p&gt;

&lt;p&gt;&lt;quote&gt;&lt;pre&gt;
Clasp version 0.11
* Added ASDF support.
This is still alpha. Compile the ASDF module using (core:compile-asdf).
After that you can load the module using (load &amp;ldquo;sys:kernel;asdf;build;asdf.bundle&amp;rdquo;).
It takes between 15-30 seconds to load (this is why I&amp;rsquo;m integrating Cleavir).
* Added the :CLASP &lt;em&gt;feature&lt;/em&gt; and removed the :ECL &lt;em&gt;feature&lt;/em&gt;.
Clasp will continue to mimic the underlying ECL functionality so that
Common Lisp code that supports ECL can be made to support Clasp by converting
#+ecl to #+(or ecl clasp) and #-ecl to #-(or ecl clasp)
* Added code to generate object files directly from Clasp.
The LLVM bitcode compiler &amp;ldquo;llc&amp;rdquo; no longer needs to be in the PATH
for Clasp to generate object files from Common Lisp source.
The &amp;ldquo;ld&amp;rdquo; linker does need to be accessible.
&lt;/pre&gt;&lt;/quote&gt;&lt;/p&gt;

&lt;p&gt;ã¨ã‚ã‚Šã¾ã™ã€‚ASDFãŒä½¿ãˆã‚‹ï¼ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã«ã¯æ›¸ã„ã¦ã¾ã›ã‚“ãŒslimeã‚µãƒãƒ¼ãƒˆã‚‚masterã«ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã¾ã™ã€‚ã‚ã¨ã‚³ãƒŸãƒƒãƒˆèª­ã‚“ã ã‚‰æœ€é©åŒ–ã‚‚ã•ã‚Œã¦ã‚‹ã‚ˆã†ãªâ€¦ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;/slide/clasp.html&#34;&gt;ä»¥å‰&lt;/a&gt;äºŒåæ•°ç§’æ›ã‹ã£ã¦ã„ãŸ&lt;code&gt;(fib 29)&lt;/code&gt;ã§ã™ãŒã€ä»Šå›ã¯ãªã‚“ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ /usr/local/clasp/bin/clasp_boehm_o
Starting Clasp 0.11 ... loading image... it takes a few seconds
Top level.
&amp;gt; (load &amp;quot;fib.lisp&amp;quot;)
1346269
real time : 34.294 secs
run time  : 38.844 secs
T
&amp;gt; (compile-file &amp;quot;fib.lisp&amp;quot;)

#P&amp;quot;/home/kim/Lisp/fib.bc&amp;quot;
NIL
NIL
&amp;gt; (load &amp;quot;fib.bc&amp;quot;)
1346269
real time : 21.355 secs
run time  : 25.785 secs
T
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã†ã‚ãã€‚é…ããªã£ã¦ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;å› ã¿ã«.bcãƒ•ã‚¡ã‚¤ãƒ«ã¯LLVMã®ä¸­é–“ãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã§Claspã¨ã¯ç‹¬ç«‹ã«&lt;code&gt;opt -f -O3 fib.bc &amp;gt; fib.opt.bc&lt;/code&gt;ã§æœ€é©åŒ–å‡ºæ¥ã¾ã™ã€‚ãã‚Œã‚’ã‚„ã‚‹ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ opt -f -O3 fib.bc &amp;gt; fib.opt.bc
$ /usr/local/clasp/bin/clasp_boehm_o
Starting Clasp 0.11 ... loading image... it takes a few seconds
Top level.
&amp;gt; (load &amp;quot;fib.opt.bc&amp;quot;)
1346269
real time : 34.981 secs
run time  : 37.986 secs
T
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ã‚Œï¼Ÿé…ããªã£ãŸã€‚&lt;/p&gt;

&lt;p&gt;mpsã¯ã¾ã ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¸­ã ã‹ã‚‰å¾…ã£ã¦ã­&lt;/p&gt;

&lt;h1 id=&#34;asdfã‚’ä½¿ã£ã¦ã¿ã‚‹&#34;&gt;ASDFã‚’ä½¿ã£ã¦ã¿ã‚‹&lt;/h1&gt;

&lt;pre&gt;&lt;code&gt;$ /usr/local/clasp/bin/clasp_boehm_o
Starting Clasp 0.11 ... loading image... it takes a few seconds
Top level.
&amp;gt; (time (core:compile-asdf))
zsh: segmentation fault (core dumped)  /usr/local/clasp/bin/clasp_boehm_o
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯ã„ã€‚è§£æ•£ã€‚å› ã¿ã«50åˆ†ãã‚‰ã„ã¯å‹•ã„ã¦ãŸã€‚&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>VOPã§éŠã¶</title>
      <link>/blog/2014/12/02/vopdeyou-bu</link>
      <pubDate>Tue, 02 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>/blog/2014/12/02/vopdeyou-bu</guid>
      <description>&lt;p&gt;(:meta&lt;br /&gt;
 ((:this &amp;ldquo;&lt;a href=&#34;http://qiita.com/advent-calendar/2014/lisp&#34;&gt;Lisp Advent Calendar 2014&lt;/a&gt;ã®3æ—¥ç›®ã®è¨˜äº‹&amp;rdquo;)&lt;br /&gt;
  (:prev (:author &amp;ldquo;tk_riple&amp;rdquo; :title &lt;a href=&#34;http://compassoftime.blogspot.jp/2014/12/r7rs.html&#34;&gt;&amp;ldquo;æ™‚ã®ç¾…é‡ç›¤ï¼ blog: R7RSãƒãƒ¼ã‚¿ãƒ–ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ›¸ãéš›ã®è½ã¨ã—ç©´&amp;rdquo;&lt;/a&gt;))&lt;br /&gt;
  (:next (:author &amp;ldquo;nobkz&amp;rdquo; :tite &amp;ldquo;&lt;a href=&#34;http://qiita.com/nobkz/items/68ee2adbc13caf3eec6f&#34;&gt;Shenã®åŸºç¤ãã®1 åŸºæœ¬çš„ãªå‹ - Qiita&lt;/a&gt;&amp;rdquo;))))&lt;/p&gt;

&lt;p&gt;Îºeenã§ã™ã€‚ã•ã£ãã¾ã§VOPã§éŠã‚“ã§ãŸã®ã§å½“åˆã®äºˆå®šã‚’å¤‰æ›´ã—ã¦VOPã®è©±ã‚’ã—ã¾ã™ã€‚
&lt;/p&gt;

&lt;h1 id=&#34;vopã¨ã¯ä½•ã‹&#34;&gt;VOPã¨ã¯ä½•ã‹&lt;/h1&gt;

&lt;p&gt;SBCLã‚„CMU CLã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰ã‚’åããŸã‚ã®æ©Ÿæ§‹ã€è¦ã¯ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;vopã¨ã¯ã©ã‚“ãªã‚‚ã®ã‹&#34;&gt;VOPã¨ã¯ã©ã‚“ãªã‚‚ã®ã‹&lt;/h1&gt;

&lt;p&gt;ã¨ã‚Šã‚ãˆãšã‚³ãƒ¼ãƒ‰ã‚’ã°ã€‚x86-64ç”¨ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(in-package :cl-user)
(defpackage vop-sample
  (:use :cl :sb-ext :sb-c))
(in-package :vop-sample)

(defknown add (fixnum fixnum)          ; addã®ftypeã‚’å®£è¨€
    fixnum
    (movable                            ; å‰¯ä½œç”¨ãŒãªã„
     flushable                          ; ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦é™¤å»ã—ã¦ã‚ˆã„
     foldable                           ; å®šæ•°ç•³ã¿è¾¼ã¿ã‚’ã—ã¦ã‚ˆã„
     always-translatable)               ; å¿…ãšã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚³ãƒ¼ãƒ‰ã«ãªã‚‹
  :overwrite-fndb-silently t)           ; é–¢æ•°ä¸Šæ›¸ãã®ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã•ãªã„


(in-package &amp;quot;SB-VM&amp;quot;)
(define-vop (vop-sample::add)          ; VOPå
  (:translate vop-sample::add)         ; é–¢æ•°å
  (:policy :fast-safe)                  ; declare optimizeçš„ãª
  (:args (x :scs (signed-reg))          ; å¼•æ•°å®£è¨€ã€‚å¾Œè¿°
         (y :scs (signed-reg)))
  (:arg-types fixnum fixnum)            ; å¼•æ•°ã®å‹å®£è¨€
  (:results (r :scs (signed-reg)))      ; è¿”ã‚Šå€¤å®£è¨€ã€‚å¾Œè¿°
  (:result-types fixnum)                ; è¿”ã‚Šå€¤ã®å‹å®£è¨€
  (:generator 4                         ; ç¿»è¨³ã™ã‚‹ã¨ãã®ã‚³ã‚¹ãƒˆ
              (move r x)                ; è¿”ã‚Šå€¤ãƒ¬ã‚¸ã‚¹ã‚¿ã«xã‚’ç§»å‹•
              (inst add r y)))          ; è¿”ã‚Šå€¤ãƒ¬ã‚¸ã‚¹ã‚¿ã«yã‚’è¶³ã—è¾¼ã‚€
(in-package :vop-sample)

(defun add (x y)                        ; å®‰å…¨ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ©ãƒƒãƒ—ã™ã‚‹
  (add x y))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¡ã‚‡ã£ã¨ãŠã¾ã˜ãªã„ãŒå¤šã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ã™ã“ã—è§£èª¬ã™ã‚‹ã¨å¼•æ•°ã¯åŸºæœ¬ãƒ¬ã‚¸ã‚¹ã‚¿æ¸¡ã—ã§ã€ãƒ¬ã‚¸ã‚¹ã‚¿ãŒè¶³ã‚Šãªã‘ã‚Œã°ã‚¹ã‚¿ãƒƒã‚¯ã‚‚ä½¿ã„ã¾ã™ã€‚ã§ã€ãƒ¬ã‚¸ã‚¹ã‚¿ã‚„ã‚¹ã‚¿ãƒƒã‚¯ã®å€¤ã«ã¯å‹ãŒã‚ã‚Šã¾ã™ã€‚ãã‚ŒãŒã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹(sc)ã§ã™ã€‚ã“ã®å ´åˆã€xã€yã€rã¯&lt;code&gt;signed-reg&lt;/code&gt;ã¨å®£è¨€ã•ã‚Œã¦ã¾ã™ã­ã€‚ç¬¦å·ä»˜ããƒ¬ã‚¸ã‚¹ã‚¿ã§ã™ã€‚&lt;code&gt;:scs&lt;/code&gt;ã®æœ€å¾Œã®sã¯è¤‡æ•°å½¢ã®sã§ã™ã€‚ä»Šå›ã¯1ã¤ã—ã‹æŒ‡å®šã—ã¦ã¾ã›ã‚“ãŒè¤‡æ•°æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ãªã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;move&lt;/code&gt;ã¨ã„ã†ã®ã¯ã‚¢ã‚»ãƒ³ãƒ–ãƒ©å‘½ä»¤ã§ã¯ãªãã€ãƒã‚¯ãƒ­ã‹ãªã‚“ã‹ã§ã™ï¼ˆé©å½“ï¼‰ã€‚VOPãªã®ã‹ãªï¼Ÿã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã‹ã‚‰ã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã«ç§»å‹•ã™ã‚‹ã‹ã‚’èªçŸ¥ã—ã¦é©åˆ‡ãªå‘½ä»¤ã‚’åãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;inst&lt;/code&gt;ãŒä»˜ã„ã¦ã‚‹ã®ãŒã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®ã‚³ãƒ¼ãƒ‰ã€xã¨rãŒç­‰ã—ã„ã¨ãã«æœ€é©åŒ–å‡ºæ¥ã‚‹ã®ã§ã™ãŒãã‚Œã¯ã¾ã‚ãŠã„ã¨ã„ã¦ã€ã“ã„ã¤ã‚’ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;VOP-SAMPLE&amp;gt; (disassemble #&#39;add)
; disassembly for ADD
; Size: 43 bytes. Origin: #x1005C26416
; 16:       488BD3           MOV RDX, RBX                     ; no-arg-parsing entry point
; 19:       48D1FA           SAR RDX, 1
; 1C:       488BF9           MOV RDI, RCX
; 1F:       48D1FF           SAR RDI, 1
; 22:       4801FA           ADD RDX, RDI
; 25:       48D1E2           SHL RDX, 1
; 28:       488BE5           MOV RSP, RBP
; 2B:       F8               CLC
; 2C:       5D               POP RBP
; 2D:       C3               RET
; 2E:       CC0A             BREAK 10                         ; error trap
; 30:       02               BYTE #X02
; 31:       19               BYTE #X19                        ; INVALID-ARG-COUNT-ERROR
; 32:       9A               BYTE #X9A                        ; RCX
; 33:       CC0A             BREAK 10                         ; error trap
; 35:       04               BYTE #X04
; 36:       08               BYTE #X08                        ; OBJECT-NOT-FIXNUM-ERROR
; 37:       FE1B01           BYTE #XFE, #X1B, #X01            ; RDX
; 3A:       CC0A             BREAK 10                         ; error trap
; 3C:       04               BYTE #X04
; 3D:       08               BYTE #X08                        ; OBJECT-NOT-FIXNUM-ERROR
; 3E:       FE9B03           BYTE #XFE, #X9B, #X03            ; RDI
NIL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸»è¦ãªéƒ¨åˆ†ã¯ã“ã“ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; 19:       48D1FA           SAR RDX, 1
; 1C:       488BF9           MOV RDI, RCX
; 1F:       48D1FF           SAR RDI, 1
; 22:       4801FA           ADD RDX, RDI
; 25:       48D1E2           SHL RDX, 1
; 28:       488BE5           MOV RSP, RBP
; 2B:       F8               CLC
; 2C:       5D               POP RBP
; 2D:       C3               RET
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;ADD&lt;/code&gt;ã®ä»–ã«ç„¡é§„ãªå‘½ä»¤ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;SBCLã¯intã®ä¸‹ä½1bitã‚’GCã®ã¨ãã®ã‚¿ã‚°ã¨ã—ã¦ä½¿ã£ã¦ã‚‹ã®ã§ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã«æ¸¡ã™å‰ã«ç®—è¡“å³ã‚·ãƒ•ãƒˆ(&lt;code&gt;SAR&lt;/code&gt;)ã—ã¦æ¸¡ã—ã¦ã¾ã™ã€‚
ãã—ã¦è¿”ã‚‹ã¨ãã¯ã¾ãŸå·¦ã‚·ãƒ•ãƒˆ(&lt;code&gt;SHL&lt;/code&gt;)ã—ã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã®å¾Œã®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; 28:       488BE5           MOV RSP, RBP
; 2B:       F8               CLC
; 2C:       5D               POP RBP
; 2D:       C3               RET
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯é–¢æ•°ã‹ã‚‰è¿”ã‚‹ã¨ãã®ã‚¤ãƒ‡ã‚£ã‚ªãƒ (ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚¤ãƒ³ã‚¿ã‚’å¾©å…ƒã—ã¦ãƒ•ãƒ©ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¦å‘¼ã³å‡ºã—å…ƒã«æˆ»ã‚‹)ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä½™è«‡ã§ã™ãŒLispãƒã‚·ãƒ³ãªã©ã®ã‚¿ã‚°ãƒã‚·ãƒ³ã¯ä¸‹ä½ãƒ“ãƒƒãƒˆã«ã‚ã‚‹ã‚¿ã‚°ã‚’ç„¡è¦–ã—ã¦è¨ˆç®—å‡ºæ¥ã‚‹ã®ã§ã‚·ãƒ•ãƒˆãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚ãªã®ã§é€Ÿã„ã‚“ã§ã™ã­ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚·ãƒ•ãƒˆã‚’ãªãã™&#34;&gt;ã‚·ãƒ•ãƒˆã‚’ãªãã™&lt;/h1&gt;

&lt;p&gt;ã•ã£ãã¯&lt;code&gt;signed-reg&lt;/code&gt;ã‚’æŒ‡å®šã—ã¾ã—ãŸã€‚ã¤ã¾ã‚Šã€Œï¼ˆã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã®ï¼‰intã‚’ãã‚Œã€ã¨è¦æ±‚ã—ãŸè¨³ã§ã™ã€‚
intã®ä¸‹ä½1bitã¯0ãªã®ã§è¶³ã—ç®—ã™ã‚‹åˆ†ã«ã¯åˆ¥ã«ã‚·ãƒ•ãƒˆã•ã‚Œãªãã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“ã‚ˆã­ã€‚ã‚·ãƒ•ãƒˆã‚’æ®ºã—ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã£ãã®ã‚³ãƒ¼ãƒ‰ã®ä¸‹ã«ã“ã‚Œã‚’è¶³ã—ã¾ã™ã€‚&lt;code&gt;add&lt;/code&gt;ã¯å†å®šç¾©ã—ãªã„ã¨åæ˜ ã•ã‚Œãªã„ã‚ˆã†ã§ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(in-package &amp;quot;SB-VM&amp;quot;)
(define-vop (vop-sample::add/v2)        ; vopåã¯ç•°ãªã‚‹
  (:translate vop-sample::add)          ; é–¢æ•°åã¯åŒã˜
  (:policy :fast-safe)
  (:args (x :scs (any-reg))             ; any-regã«ãªã£ã¦ã‚‹
         (y :scs (any-reg)))            ; any-regã«ãªã£ã¦ã‚‹
  (:arg-types fixnum fixnum)
  (:results (r :scs (any-reg)))         ; any-regã«ãªã£ã¦ã‚‹
  (:result-types fixnum)
  (:generator 3                         ; ã‚³ã‚¹ãƒˆã‚’ã•ã£ãã‚ˆã‚Šä½ãã™ã‚‹ã¨å„ªå…ˆã—ã¦ä½¿ã£ã¦ãã‚Œã‚‹
              (move r x)
              (inst add r y)))

(in-package :vop-sample)

(defun add (x y)
  (add x y))

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚“ã§ã€ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã‚‹ã¨&lt;/p&gt;

&lt;p&gt;VOP-SAMPLE&amp;gt; (disassemble #&amp;lsquo;add)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; disassembly for ADD
; Size: 31 bytes. Origin: #x1004C2AB83
; 83:       488BD1           MOV RDX, RCX                     ; no-arg-parsing entry point
; 86:       4801FA           ADD RDX, RDI
; 89:       488BE5           MOV RSP, RBP
; 8C:       F8               CLC
; 8D:       5D               POP RBP
; 8E:       C3               RET
; 8F:       CC0A             BREAK 10                         ; error trap
; 91:       02               BYTE #X02
; 92:       19               BYTE #X19                        ; INVALID-ARG-COUNT-ERROR
; 93:       9A               BYTE #X9A                        ; RCX
; 94:       CC0A             BREAK 10                         ; error trap
; 96:       04               BYTE #X04
; 97:       08               BYTE #X08                        ; OBJECT-NOT-FIXNUM-ERROR
; 98:       FE1B01           BYTE #XFE, #X1B, #X01            ; RDX
; 9B:       CC0A             BREAK 10                         ; error trap
; 9D:       04               BYTE #X04
; 9E:       08               BYTE #X08                        ; OBJECT-NOT-FIXNUM-ERROR
; 9F:       FE9B03           BYTE #XFE, #X9B, #X03            ; RDI
NIL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯ã„ã€‚è¦‹äº‹ã«SARã¨SHLãŒæ¶ˆãˆã¾ã—ãŸã­ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚‚ã†å°‘ã—è¤‡é›‘ãªå‹ã‚’æ‰±ã†&#34;&gt;ã‚‚ã†å°‘ã—è¤‡é›‘ãªå‹ã‚’æ‰±ã†&lt;/h1&gt;

&lt;p&gt;ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã§ã™ã—&lt;code&gt;(simple-array (unsigned-byte 8) (*))&lt;/code&gt;(ä»¥ä¸‹octets)ã‚’æ‰±ã„ãŸã„ã§ã™ã‚ˆã­ã€‚ã¨ã‚Šã‚ãˆãšé›£ã—ã„ã“ã¨ã¯è€ƒãˆãšã«octetsã®0ç•ªç›®ã®è¦ç´ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã¨ã¯ã„ã£ã¦ã‚‚&lt;code&gt;simple-array&lt;/code&gt;ã¯é•·ã•ã‚„è¦ç´ ã®å‹ã®æƒ…å ±ã‚‚æŒã£ã¦ã„ã‚‹ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã‚‹ã®ã§å°‘ã—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿é£›ã°ã•ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã­ã€‚&lt;/p&gt;

&lt;p&gt;ãã®è¾ºã®è¨ˆç®—ãŒåˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§sbclã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãã‚Œã£ã½ã„ã‚‚ã®ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defknown access-simple-array-0 ((simple-array (unsigned-byte 8) (*)))
    (unsigned-byte 8)
    (movable flushable always-translatable)
  :overwrite-fndb-silently t)
(in-package &amp;quot;SB-VM&amp;quot;)
(define-vop (vop-sample::access-simple-array-0)
  (:translate vop-sample::access-simple-array-0)
  (:policy :fast-safe)
  (:args (x :scs (descriptor-reg)))
  (:arg-types *)
  (:results (r :scs (unsigned-reg)))
  (:result-types unsigned-num)
  (:generator 4
              (inst movzx r 
               (make-ea :byte :base x
                        :disp (- (* vector-data-offset n-word-bytes)
                               other-pointer-lowtag)))))

(in-package :vop-sample)
(defvar *octets* (make-array 4
                             :element-type &#39;(unsigned-byte 8)
                             :initial-contents &#39;(10 11 12 13)))

(defun access-simple-array-0 (x)
  (access-simple-array-0 x))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™ã€‚å¢ƒç•Œãƒã‚§ãƒƒã‚¯ã¨ã‹ã¯ã‚„ã£ã¦ã¾ã›ã‚“ãŒè¨±ã—ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;descriptor-reg&lt;/code&gt;ã¨ã„ã†ã®ãŒãƒã‚¤ãƒ³ã‚¿ãŒå…¥ã£ã¦ã‚‹ãƒ¬ã‚¸ã‚¹ã‚¿ã£ã½ã„ã§ã™ã€‚&lt;code&gt;movzx&lt;/code&gt;ã¯8bitã®å€¤ã‚’64bitã®ãƒ¬ã‚¸ã‚¹ã‚¿ã«ç¬¦å·æ‹¡å¼µã—ãªãŒã‚‰ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å‘½ä»¤ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;make-ea&lt;/code&gt;ã¨ã„ã†ã®ãŒã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã§ã™ã­ã€‚&lt;code&gt;x&lt;/code&gt;ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’èµ·ç‚¹ã¨ã—ã¦&lt;code&gt;(- (* vector-data-offset n-word-bytes) other-pointer-lowtag)&lt;/code&gt;ãƒã‚¤ãƒˆ(ï¼Ÿãƒ¯ãƒ¼ãƒ‰ï¼Ÿ)å…ˆã®ãƒ¡ãƒ¢ãƒª1byteã‚’æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã¿ãªã•ã‚“ã‚‚ã†æ…£ã‚Œã¦ããŸã¨æ€ã†ã®ã§ä¸»è¦éƒ¨ã ã‘æŠœãå‡ºã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; 65:       0FB65101         MOVZX EDX, BYTE PTR [RCX+1]      ; no-arg-parsing entry point
; 69:       48D1E2           SHL RDX, 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çŸ­ã„ã§ã™ã­ã€‚ã“ã®&lt;code&gt;BYTE PTR [RCX+1]&lt;/code&gt;ãŒ&lt;code&gt;make-ea&lt;/code&gt;ã—ãŸå€¤ã«å¯¾å¿œã—ã¾ã™ã€‚&lt;code&gt;RCX&lt;/code&gt;ã¯&lt;code&gt;x&lt;/code&gt;ã§&lt;code&gt;(- (* vector-data-offset n-word-bytes) other-pointer-lowtag)&lt;/code&gt;ã®çµæœãŒ1ã«ç¾ã‚Œã¦ã‚‹ã‚“ã§ã—ã‚‡ã†ã€‚è£œè¶³ã—ã¦ãŠãã¨ã€&lt;code&gt;EDX&lt;/code&gt;ã¨&lt;code&gt;RDX&lt;/code&gt;ã¯åŒã˜å ´æ‰€ã‚’æŒ‡ã—ã¾ã™ã€‚32bitã¨ã—ã¦æ‰±ã†ã¨ãã¯Eã€64bitã¨ã—ã¦æ‰±ã†ã¨ãã¯Rã§æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ç§ã¯x86ã®ã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ãªã‚“ã¦å…¨ç„¶çŸ¥ã‚‰ãªã„ã®ã§ã™ãŒã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹é™ã‚Šã‚‚ã†ã¡ã‚‡ã£ã¨è¤‡é›‘ãªã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ãŒå‡ºæ¥ã‚‹ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;é…åˆ—ã®nç•ªç›®ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒè‰¯ã„ä¾‹ã®ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defknown access-simple-array-n ((simple-array (unsigned-byte 8) (*)) (unsigned-byte 64))
    (unsigned-byte 8)
    (movable flushable always-translatable)
  :overwrite-fndb-silently t)
(in-package &amp;quot;SB-VM&amp;quot;)
(define-vop (vop-sample::access-simple-array-n)
  (:translate vop-sample::access-simple-array-n)
  (:policy :fast-safe)
  (:args (x :scs (descriptor-reg))
         (i :scs (unsigned-reg)))
  (:arg-types * unsigned-num)
  (:results (r :scs (unsigned-reg)))
  (:result-types unsigned-num)
  (:generator 4
              (inst movzx r 
               (make-ea :byte :base x
                        :scale 1
                        :index i
                        :disp (- (* vector-data-offset n-word-bytes)
                               other-pointer-lowtag)))))

(in-package :vop-sample)
(defun access-simple-array-n (x i)
  (access-simple-array-n x i))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ–°ãŸã«å¼•æ•°&lt;code&gt;i&lt;/code&gt;ã‚’ã¨ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã¨&lt;code&gt;make-ea&lt;/code&gt;ã®å¼•æ•°ã«&lt;code&gt;:scale 1 :index i&lt;/code&gt;ãŒåŠ ã‚ã£ã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; 98:       0FB6543901       MOVZX EDX, BYTE PTR [RCX+RDI+1]  ; no-arg-parsing entry point
; 9D:       48D1E2           SHL RDX, 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã«&lt;code&gt;+RDI&lt;/code&gt;ãŒåŠ ã‚ã‚Šã¾ã—ãŸã­ã€‚ã©ã†ã—ã¦&lt;code&gt;i&lt;/code&gt;(&lt;code&gt;RDI&lt;/code&gt;)ã‚’&lt;code&gt;RAS&lt;/code&gt;ã—ãªãã¦ã„ã„ã®ã‹æ°—ã«ãªã‚Šã¾ã™ãŒã¾ã‚ã€ã¨ã‚Šã‚ãˆãšæ­£å¸¸ã«å‹•ã„ã¦ã‚‹ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãŠã‚ã‹ã‚Šã‹ã¨æ€ã„ã¾ã™ãŒã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ãŒ&lt;code&gt;x&lt;/code&gt;ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦ä»Šã¾ã§ã®å®šæ•°ã‚ªãƒ•ã‚»ãƒƒãƒˆ+æ–°ãŸã«ãƒ¬ã‚¸ã‚¹ã‚¿ã§æŒ‡å®šã—ãŸã‚ªãƒ•ã‚»ãƒƒãƒˆã«ãªã£ã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;make-ea&lt;/code&gt;ã«æ¸¡ã—ãŸ&lt;code&gt;:index&lt;/code&gt;ã¯ä½•ã‹åˆ†ã‹ã‚‹ã¨ã—ã¦ã‚‚&lt;code&gt;:scale&lt;/code&gt;ãŒæ°—ã«ãªã‚Šã¾ã™ã‚ˆã­ã€‚&lt;code&gt;scale&lt;/code&gt;ã‚’2ã«ã—ã¦ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; 58:       0FB6547901       MOVZX EDX, BYTE PTR [RCX+RDI*2+1]  ; no-arg-parsing entry point
; 5D:       48D1E2           SHL RDX, 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯ã„ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å®šæ•°å€ã™ã‚‹ã‚ˆã†ã§ã™ã­ã€‚&lt;/p&gt;

&lt;h1 id=&#34;sseã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸&#34;&gt;SSEã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸&lt;/h1&gt;

&lt;p&gt;ã‚¤ãƒ³ãƒ†ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ã‚‹SSEã¨ã¯Streaming SIMD Extensionsã®ç•¥ã§ã™ã€‚ã˜ã‚ƒã‚SIMDã¯ä½•ã‹ã¨ã„ã†ã¨Simple Instruction Mulitple Dataã®ç•¥ã§ã€1å‘½ä»¤ã§è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®ã€Œè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã€ã¨ã„ã†ã®ã¯64bit2ã¤ã‚„32bit4ã¤ãªã©ã‚’128bitã«ã¾ã¨ã‚ã¦æ¸¡ã—ã¾ã™ã€‚128bitã®å€¤ãªã‚“ã¦ã©ã†ã‚„ã£ã¦ä½œã‚‹ã‚“ã ã‚ˆã£ã¦æ„Ÿã˜ã§ã™ãŒsbcl-1.1.8ã‹ã‚‰å…¥ã£ãŸ&lt;code&gt;sb-ext:%make-simd-pack-*&lt;/code&gt;ãŒå­˜åœ¨ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;VOP-SAMPLE&amp;gt; (%make-simd-pack-ub32 1 2 3 4)
#&amp;lt;SIMD-PACK  01 00 00 00  02 00 00 00  03 00 00 00  04 00 00 00&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚x86_64ãŒãƒªãƒˆãƒ«ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã ã£ãŸã®ã‚’æ€ã„å‡ºã•ã›ã‚‹è¡¨è¨˜ã§ã™ã­ã€‚ub32ã®ä»–ã«ub64ã€singleã€doubleãŒå­˜åœ¨ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ã‚¹ã‚‚&lt;code&gt;*-sse-reg&lt;/code&gt;ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã®ã§ã“ã‚Œã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defknown simd-add ((simd-pack (unsigned-byte 64)) (simd-pack (unsigned-byte 64)))
    (simd-pack (unsigned-byte 32))
    (movable flushable always-translatable)
  :overwrite-fndb-silently t)
(in-package &amp;quot;SB-VM&amp;quot;)
(define-vop (vop-sample::simd-add)
  (:translate vop-sample::simd-add)
  (:policy :fast-safe)
  (:args (x :scs (int-sse-reg))
         (y :scs (int-sse-reg)))
  (:arg-types simd-pack-int simd-pack-int)
  (:results (r :scs (int-sse-reg)))
  (:result-types simd-pack-int)
  (:generator 4
              (move r x)
              (inst padddw r y)))

(in-package :vop-sample)
(defun simd-add (x y)
  (simd-add x y))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯ã„ã€‚ã“ã‚“ãªæ„Ÿã˜ã§ã™ã­ã€‚&lt;code&gt;paddw&lt;/code&gt;ã¯parallel add wordã§ã™ã‹ã­ã€‚ã“ã‚Œã‚’ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã™ã‚‹ã¨æ€ã£ãŸã‚ˆã‚Šå¤§ããªå‘½ä»¤ã«ãªã£ãŸã®ã§å…¨éƒ¨è²¼ã£ã¨ãã¾ã™ã­ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;VOP-SAMPLE&amp;gt; (disassemble #&#39;simd-add)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;; disassembly for SIMD-ADD
; Size: 108 bytes. Origin: #x1006D64A21
; 21:       660F6FC2         MOVDQA XMM0, XMM2                ; no-arg-parsing entry point
; 25:       660FFDC1         PADDW XMM0, XMM1
; 29:       49896C2440       MOV [R12+64], RBP                ; thread.pseudo-atomic-bits
; 2E:       4D8B5C2418       MOV R11, [R12+24]                ; thread.alloc-region
; 33:       498D5320         LEA RDX, [R11+32]
; 37:       493B542420       CMP RDX, [R12+32]
; 3C:       7740             JNBE L2
; 3E:       4989542418       MOV [R12+24], RDX                ; thread.alloc-region
; 43:       498D530F         LEA RDX, [R11+15]
; 47: L0:   48C742F165030000 MOV QWORD PTR [RDX-15], 869
; 4F:       48C742F900000000 MOV QWORD PTR [RDX-7], 0
; 57:       660F7F4201       MOVDQA [RDX+1], XMM0
; 5C:       49316C2440       XOR [R12+64], RBP                ; thread.pseudo-atomic-bits
; 61:       7402             JEQ L1
; 63:       cc09             break 9                          ; pending interrupt trap
; 65: l1:   488be5           mov rsp, rbp
; 68:       f8               clc
; 69:       5d               pop rbp
; 6a:       c3               ret
; 6b:       cc0a             break 10                         ; error trap
; 6d:       02               byte #x02
; 6e:       19               byte #x19                        ; invalid-arg-count-error
; 6f:       9a               byte #x9a                        ; rcx
; 70:       cc0a             break 10                         ; error trap
; 72:       04               byte #x04
; 73:       32               byte #x32                        ; object-not-simd-pack-error
; 74:       fe1b01           byte #xfe, #x1b, #x01            ; rdx
; 77:       cc0a             break 10                         ; error trap
; 79:       04               byte #x04
; 7a:       32               byte #x32                        ; object-not-simd-pack-error
; 7b:       fe9b03           byte #xfe, #x9b, #x03            ; rdi
; 7e: l2:   6a20             push 32
; 80:       bac0854200       mov edx, 4359616                 ; alloc_tramp
; 85:       ffd2             call rdx
; 87:       5a               pop rdx
; 88:       80ca0f           or dl, 15
; 8b:       ebba             jmp l0
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãªã«ã‚„ã£ã¦ã‚‹ã®ã‚„ã‚‰ã€‚&lt;/p&gt;

&lt;h1 id=&#34;å‡ºæ¥ãªã‹ã£ãŸã“ã¨&#34;&gt;å‡ºæ¥ãªã‹ã£ãŸã“ã¨&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;PCMPESTRI&lt;/code&gt;ã‚’ä½¿ã£ã¦ã¿ãŸã‹ã£ãŸã®ã§ã™ãŒæ‰±ã„ãŒãƒˆãƒªãƒƒã‚­ãƒ¼ãªã®ã§æ–­å¿µã—ã¾ã—ãŸã€‚å…·ä½“çš„ã«è¨€ã†ã¨æ“ä½œã™ã‚‹å€¤ã‚’æ ¼ç´ã™ã‚‹ãƒ¬ã‚¸ã‚¹ã‚¿ãŒEAXã¨ECXå›ºå®šãªã‚ˆã†ãªã®ã§ã™ã€‚
&lt;code&gt;:temporary&lt;/code&gt;ç¯€ã§å†…éƒ¨ã§ä½¿ã†ãƒ¬ã‚¸ã‚¹ã‚¿ã‚‚è¦æ±‚å‡ºæ¥ã‚‹ã‚ˆã†ãªã®ã§ã™ãŒåæŒ‡ã—ã§ã‚‚ã‚‰ãˆã‚‹ã‚“ã§ã™ã‹ã­ã€‚&lt;/p&gt;

&lt;p&gt;SSEã®ä½¿ã„æ–¹ã¨simple-arrayã‹ã‚‰è¦ç´ ã®é…åˆ—ã‚’å–ã‚Šå‡ºã™æ–¹æ³•ã¾ã§ã¯ç¤ºã—ãŸã®ã§èª°ã‹ã‚„ã£ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;å‚è€ƒè³‡æ–™ã„ã£ã±ã„ç½®ã„ã¨ãã¾ã™ã­ã€‚&lt;/p&gt;

&lt;dl&gt;
&lt;dt&gt;&lt;a href=&#34;http://www.pvk.ca/Blog/2014/08/16/how-to-define-new-intrinsics-in-sbcl/&#34;&gt;How to Define New Intrinsics in SBCL - Paul Khuong mostly on Lisp&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;VOPã®ä½¿ã„æ–¹ã€‚æœ€åˆã®æ–¹ã«å‡ºã¦ããŸaddã®æœ€é©åŒ–ã®ã‚„ã¤ã¨ã‹ã‚‚å‡ºã¦ãã‚‹ã€‚(en)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;http://pvk.ca/Blog/Lisp/hacking_SSE_intrinsics-part_1.html&#34;&gt;Hacking SSE Intrinsics in SBCL (part 1) - Paul Khuong mostly on Lisp&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;SBCLã®simd-packã®å…·ä½“çš„è§£èª¬(en)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;http://www.pvk.ca/Blog/2013/06/05/fresh-in-sbcl-1-dot-1-8-sse-intrinsics/&#34;&gt;Fresh in SBCL 1.1.8: SSE Intrinsics! - Paul Khuong mostly on Lisp&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;SBCLã§VOPã¨SSEã‚’ä½¿ã£ã¦ãƒãƒ³ãƒ‡ãƒ«ãƒ–ãƒ­é›†åˆã‚’è¨ˆç®—ã™ã‚‹(en)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;https://software.intel.com/en-us/node/514244&#34;&gt;Packed Compare Intrinsics&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;Intelã®PCMPESTRIã¨ã‹ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«(en)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/bb531465.aspx&#34;&gt;_mm_cmpestri&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;Microsoftã®PCMPESTRIã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã€‚ã“ã£ã¡ã®æ–¹ãŒåˆ†ã‹ã‚Šã‚„ã™ã„(en)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;http://homepage1.nifty.com/herumi/prog/intel-opt.html&#34;&gt;Intel optimization&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;PCMPISTRIã‚’ä½¿ã£ãŸ&lt;code&gt;strlen&lt;/code&gt;ã®å®Ÿè£…ä¾‹(ja)&lt;/dd&gt;
&lt;dt&gt;&lt;a href=&#34;http://blog.kazuhooku.com/2014/12/improving-parser-performance-using-sse.html&#34;&gt;Kazuho&amp;rsquo;s Weblog: Improving Parser Performance using SSE Instructions (in case of PicoHTTPParser)&lt;/a&gt;&lt;/dt&gt;
&lt;dd&gt;PCMPESTRIã‚’ä½¿ã£ã¦HTTPãƒ‘ãƒ¼ã‚µãƒ¼ã‚’é«˜é€ŸåŒ–ã—ãŸè©±ã€‚ã“ã‚Œã‚’ã‚„ã‚ŠãŸã‹ã£ãŸã€‚(en)&lt;/dd&gt;
&lt;/dl&gt;

&lt;h1 id=&#34;ãŠã‚ã‚Šã«&#34;&gt;ãŠã‚ã‚Šã«&lt;/h1&gt;

&lt;p&gt;ãŠã¤ã‹ã‚Œæ§˜ã§ã—ãŸã€‚ãŸã¾ã«ã¯ä½ãƒ¬ãƒ™ãƒ«ãªã“ã¨ã‚’ã‚„ã£ã¦ã‚‚è‰¯ã„ã‚“ã˜ã‚ƒãªã„ã§ã—ã‚‡ã†ã‹ã€‚&lt;/p&gt;

&lt;p&gt;æ˜æ—¥ã¯nobkzã•ã‚“ã§ã€Shenã«ã¤ã„ã¦ã§ã™ã€‚&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>