<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Lisp on </title>
    <link>/categories/lisp/</link>
    <description>Recent content in Lisp on </description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Mon, 22 Feb 2016 20:19:11 +0900</lastBuildDate>
    <atom:link href="/categories/lisp/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Clojureã§SSPã‚’ä½œã£ãŸè©±</title>
      <link>/slide/ClojuredeSSPwotsukuttahanashi/</link>
      <pubDate>Mon, 22 Feb 2016 20:19:11 +0900</pubDate>
      
      <guid>/slide/ClojuredeSSPwotsukuttahanashi/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Clojureã§SSPã‚’ä½œã£ãŸè©±
----------------------

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Rust, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™


# SSPã¨ã¯
-------
â€»ä»Šå›ä½œã£ãŸã‚‚ã®ã®è©±ãªã®ã§å®Ÿéš›ã¯å°‘ã—é•ã†

* Supplier Side Platform
* ãƒ¡ãƒ‡ã‚£ã‚¢ã‹ã‚‰ã®åºƒå‘Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã¦è¡¨ç¤ºæ¨©ã‚’ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³ã«æ›ã‘ã€è½æœ­ã•ã‚ŒãŸåºƒå‘Šã‚’è¡¨ç¤ºã™ã‚‹
  0. åºƒå‘Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ã¦
  1. å„DSPã«ç«¶ã‚Šã®é€šçŸ¥ã‚’æŠ•ã’ã¦
  2. å…¥æœ­ã‚’å—ã‘å–ã£ã¦
  3. è½æœ­è€…ã¨è½æœ­ä¾¡æ ¼ã‚’æ±ºã‚ã¦
  4. è½æœ­é€šçŸ¥ã‚’å‡ºã™


# ã‚¢ãƒ‰ãƒ†ã‚¯ã‚³ãƒ³ãƒš
---------------

* [ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã‚‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚‚å­¦ã¹ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯ã‚¹ã‚¿ã‚¸ã‚ªã®è‚²æˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã¯ | æ ªå¼ä¼šç¤¾ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](https://www.cyberagent.co.jp/techinfo_detail/id=11380)
* ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å­¦ç”Ÿå‘ã‘ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³
* 3æ—¥é–“ã€3ã€4äººã®ãƒãƒ¼ãƒ ã§ **DSP** ã‚’ä½œã‚‹
* å­¦ç”Ÿã¯7ãƒãƒ¼ãƒ ã€1ãƒãƒ¼ãƒ ã‚ãŸã‚Š2000q/sã‚’æŒãã“ã¨ã«ãªã£ã¦ã‚‹
* å­¦ç”Ÿã®DSPã‚’ç¹‹ããŸã‚ã® **SSP** ãŒå¿…è¦ã«ãªã£ãŸã®ã§ä½œã‚‹ã“ã¨ã«ã€‚


&lt;iframe src=&#34;//www.slideshare.net/slideshow/embed_code/key/92I5tQt6q6IjII&#34; width=&#34;425&#34; height=&#34;355&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34; style=&#34;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&#34; allowfullscreen&gt; &lt;/iframe&gt; &lt;div style=&#34;margin-bottom:5px&#34;&gt; &lt;strong&gt; &lt;a href=&#34;//www.slideshare.net/prir/ss-35918532&#34; title=&#34;æ—¥æœ¬ã«ãŠã‘ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯å¸‚å ´ã¨ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ†ã‚¯äº‹æ¥­ã«ã¤ã„ã¦&#34; target=&#34;_blank&#34;&gt;æ—¥æœ¬ã«ãŠã‘ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯å¸‚å ´ã¨ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ†ã‚¯äº‹æ¥­ã«ã¤ã„ã¦&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href=&#34;//www.slideshare.net/prir&#34; target=&#34;_blank&#34;&gt;CyberAgent, Inc.&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;


# ä½œã‚‹ã‚‚ã®
----------

* å„DSPã«ç«¶ã‚Šã®é€šçŸ¥(HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)ã‚’æŠ•ã’ã‚‹å¤§è¦æ¨¡HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
  + å„DSPãŒ2000q/s x 7ãƒãƒ¼ãƒ  + è½æœ­é€šçŸ¥ = 16000q/s
  + ä¸åº¦2000q/sã«ãªã‚‹ã‚ˆã†ãªåˆ¶å¾¡ã‚‚å¿…è¦
* å…¥æœ­ã‚’å—ã‘ã¦ã®ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³ã€çµæœã®ãƒ­ã‚®ãƒ³ã‚°ãªã©
* ç®¡ç†ç”»é¢


# s7pã«ã¤ã„ã¦
-------------

* ä»Šå›ä½œã£ãŸSSP
* [KeenS/s7p](https://github.com/KeenS/s7p)
* Clojureè£½
* 3æ—¥ãã‚‰ã„ã§ä½œã£ãŸ
* ã‚„ã‚„ç²—ã„éƒ¨åˆ†ã‚‚


# ä»Šæ—¥è©±ã™ã“ã¨
--------------

* ãªãœClojureã‹
* 16000q/så‡ºã™ãŸã‚ã®å·¥å¤«
* 16000q/sã«æŠ‘ãˆã‚‹ãŸã‚ã®åˆ¶å¾¡
* é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹



# ãªãœClojureã‹

&lt;!-- .slide: class=&#34;center&#34; --&gt;


# ãªãœClojureã‹
---------------

* ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ•°ãŒå¤šã„ã®ã§éåŒæœŸIOã¯å¿…é ˆ
* 100msã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹ä»•æ§˜ãªã®ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ã‚‚
* ã‚‚ã¨ã‚‚ã¨ã¯Scala(akka)ã§ä½œã£ãŸs6pãŒã‚ã£ãŸ
* Actorã®è¨­è¨ˆãŒè‰¯ããªã‹ã£ãŸã®ã§é…ã‹ã£ãŸ
* ã‚ã¨éåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒãªã‹ã£ãŸ
* ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æµç”¨ã—ãŸã®ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ãŒçµ‚ã‚ã£ãŸå¾Œå…¬é–‹å‡ºæ¥ãªã‹ã£ãŸ
* åˆ¥è¨€èªã§æ›¸ãç›´ã™ã«ã‚ãŸã£ã¦Go, Clojure, Common Lisp, Rust, ErlangãŒæ¤œè¨ã•ã‚ŒãŸ

# ãªãœClojureã‹
---------------

* Common Lisp: ä¸€ç•ªæ…£ã‚Œã¦ã‚‹ãŒã€éåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ(ã¨futureãƒ©ã‚¤ãƒ–ãƒ©ãƒª)ãŒä½¿ã„ã¥ã‚‰ãã†ãªã®ã§ã‚„ã‚ãŸ
* Rust: ã¨ã‚Šã‚ãˆãšãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯å‡ºãã†ã ã—ä½¿ã„ãŸã‹ã£ãŸãŒéåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒè¦‹ä»˜ã‹ã‚‰ãªã‹ã£ãŸ
* Clojure: ãã“ãã“æ…£ã‚Œã¦ã‚‹ã—é€Ÿãã†ãªéåŒæœŸHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚ã£ãŸã€‚core.asyncã§éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚‚ã—æ˜“ã„
* Erlang: æã‚‰ãä¸€ç•ªå‘ã„ã¦ã‚‹ãŒã€ã»ã¨ã‚“ã©çµŒé¨“ãŒãªã„
* Go: çµæ§‹å‘ã„ã¦ãã†ã ãŒã‚ã¾ã‚ŠçµŒé¨“ãŒãªã„ã®ã§Clojureã‚’é¸ã‚“ã 


# 16kq/så‡ºã™ãŸã‚ã®å·¥å¤«
&lt;!-- .slide: class=&#34;center&#34; --&gt;

# 16kq/så‡ºã™ãŸã‚ã®å·¥å¤«
------------------------
éåŒæœŸIOï¼ˆä¸€éƒ¨åŒæœŸã—ã¡ã‚ƒã£ãŸã‘ã©ï¼‰

``` clojure
(defn work [test req result]
  (-&gt;&gt; @dsps
       (sequence (comp
       ;; å…¨DSPã«POSTã—ã¦ã‹ã‚‰(timeout 100ms)
                  (map (fn [dsp] {:dsp dsp :response (http/post (:url dsp) (json-request-option req))}))
       ;; çµæœã‚’å¾…ã¡åˆã‚ã›ã‚‹
                  (map destruct)
                  ...))
       ...))
    ....
```


# 16kq/så‡ºã™ãŸã‚ã®å·¥å¤«2
------------------------
ä¸€éƒ¨åŒæœŸã—ãŸã®ã§ã¨ã«ã‹ãã‚¹ãƒ¬ãƒƒãƒ‰ã€‚ã‚¹ãƒ¬ãƒƒãƒ‰ã¸ã®ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã¯ãƒãƒ£ãƒãƒ«ã§ä¸€ç™ºè§£æ±ºã€‚

``` clojure
(defn worker [c]
  (thread
   ...))
```

```clojure
(defn make-workers [ch n]
  (doall (map (fn [_] (core/worker ch)) (range n))))
```

``` clojure
 workers (manage/make-workers ch 1024)
```


# 16kq/så‡ºã™ãŸã‚ã®å·¥å¤«3
------------------------
ZeroMQã‚’ä½¿ã£ãŸmaster-slaveæ§‹æˆ
(æœ€çµ‚çš„ã«Slave18å°)

![master-slaveæ§‹æˆå›³](/images/s7p/s7p.svg)



# &lt;span style=&#34;font-size: 90%&#34;&gt;16kq/sã«æŠ‘ãˆã‚‹ãŸã‚ã®åˆ¶å¾¡&lt;/span&gt;
&lt;!-- .slide: class=&#34;center&#34; --&gt;

# &lt;span style=&#34;font-size: 90%&#34;&gt;16kq/sã«æŠ‘ãˆã‚‹ãŸã‚ã®åˆ¶å¾¡&lt;/span&gt;
---------------------------

* DSPã®è²·ã„ä»˜ã‘èƒ½åŠ›ã¨ã„ã†ãƒ“ã‚¸ãƒã‚¹çš„ãªå•é¡Œã§ã¯ãªãã‚µãƒ¼ãƒã®è² è·ã¨ã„ã†æŠ€è¡“çš„ãªå•é¡Œã«ã‚ˆã‚‹åˆ¶å¾¡
* 1ç§’ã§160kã‚¯ã‚¨ãƒªæŠ•ã’ã¦9ç§’ä¼‘ã‚€ã¨ã‹ã¯å‡ºæ¥ãªã„ã€‚ã‚‚ã†å°‘ã—ç´°ã‹ãåˆ¶å¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
* ã—ã‹ã—åˆ¶å¾¡ã‚’ã‚ã¾ã‚Šç´°ã‹ãã—ã™ãã‚‹ã¨ä»Šåº¦ã¯ãã“ã§é…ããªã‚Šãã†ã€‚
* ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿéš›ã«æŠ•ã’ã‚‹Slaveã¯åˆ†æ•£ã—ã¦ã‚‹ã‘ã©çµ±ä¸€ã—ãŸåˆ¶å¾¡ãŒå¿…è¦


# &lt;span style=&#34;font-size: 90%&#34;&gt;16kq/sã«æŠ‘ãˆã‚‹ãŸã‚ã®åˆ¶å¾¡&lt;/span&gt;
---------------------------
Masterå´ã§100msæ¯ã«ã«200å€‹ã ã‘ZeroMQã®ã‚­ãƒ¥ãƒ¼ã«ç©ã‚€

![QPSåˆ¶å¾¡ã®å›³](/images/s7p/qps_control.svg)


# &lt;span style=&#34;font-size: 90%&#34;&gt;16kq/sã«æŠ‘ãˆã‚‹ãŸã‚ã®åˆ¶å¾¡&lt;/span&gt;
---------------------------
å®Ÿè£…ã«ã¯core.asyncã® `chan` ã¨ `timeout` ã‚’ä½¿ç”¨ã€‚(éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ä¾¿åˆ©!)

```Clojure
(defn start-query [sender reqs]
  (let [timer (timer 100)]
    (go-loop []
      (let [t (&lt;! timer)
            took (take @qp100ms @reqs)]
        (doall
         (doseq [req took]
           (zmq/send-str sender (json/generate-string req))))
        (swap! reqs #(drop @qp100ms %))
        (if (and t (not (empty? took)))
          (recur)
          (println &#34;request done&#34;))))
    timer))
```


# é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹
&lt;!-- .slide: class=&#34;center&#34; --&gt;


# é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹
---------------------
## &lt;span style=&#34;font-size: 50%&#34;&gt;ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé…ã„DSPã«SSPã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¼•ãæ‘ºã‚‰ã‚Œã‚‹&lt;/span&gt;
* DSPãŒé€Ÿã‘ã‚Œã°ä½™è£•ã‚’è¦‹ã¦ã‚‚10å°ã‚ã‚Œã°ååˆ†ã ã£ãŸ
* DSPã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«ä»®å®šã‚’ãŠã‘ãªã„ã®ã§ä¸Šé™ã‚®ãƒªã‚®ãƒªã®18å°
* åŒæœŸ: ã€ŒDSPä½œã£ã¦ã‚‹æ™‚ã¯ã¡ã‚‡ã£ã¨ãã‚‰ã„å¾…ã£ã¦ãã‚Œã‚ˆã€ã£ã¦æ€ã£ã¦ãŸã‘ã©SSPé‹ç”¨ã—ãŸã‚‰é…ã„DSPã‚¬ãƒ³ã‚¬ãƒ³åˆ‡ã‚ŠãŸããªã‚‹æ°—æŒåˆ†ã‹ã£ãŸã€

# é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹
---------------------
## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼ãŒå¤§å¤‰
* ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŒãã‚µãƒ¼ãƒã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã©ã†ã™ã‚‹ã‹æ‚©ã‚€
* ã‚µãƒ¼ãƒã‚’ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã™ã‚Œã°SSPã‚‚é€Ÿããªã‚‹ãŒã€æ¤œè¨¼ã«ãªã‚‰ãªã„
* ã‹ã¨ã„ã£ã¦æŠ•ã’ãŸã‚¯ã‚¨ãƒªã‚’æŒã‘ãªã„ã‚µãƒ¼ãƒã«å¯¾ã—ã¦æ¤œè¨¼ã™ã‚‹è¨³ã«ã‚‚ã„ã‹ãªã„
* çµå±€å®‰å…¨å´ã«å€’ã—ãŸãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦‹ç©ã‚Šã«ã€‚


# é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹
---------------------
## &lt;span style=&#34;font-size: 80%&#34;&gt;MasterãŒãƒ­ã‚°åãã™ãã¦Disk Full&lt;/span&gt;
* æœ€åˆã®äºˆå®šã§ã¯Masterã¯ãƒ‡ã‚£ã‚¹ã‚¯ã‚’ãã‚“ãªã«ä½¿ã‚ãªã‹ã£ãŸã®ã§ãƒ‡ã‚£ã‚¹ã‚¯ã®å°ã•ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã ã£ãŸ
* ãƒ‡ã‚£ã‚¹ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç©ºã‘ã¦Masterå†èµ·å‹•ã§å¾©æ—§ã€‚ç„¦ã£ãŸã€‚

# é‹ç”¨ã—ã¦å›°ã£ãŸè©±ã¨ã‹
---------------------
## &lt;span style=&#34;font-size: 60%&#34;&gt;timeoutã—ç¶šã‘ã‚‹DSPãŒã„ã¦Slaveå®Œå…¨æ²ˆé»™&lt;/span&gt;
* ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¯ãƒ­ãƒ¼ã‚ºå¾…ã¡ã§å›ºã¾ã£ã¦ãŸ
* è©²å½“DSPã‚’åˆ‡ã£ãŸä¸Šã§Slaveã®å†èµ·å‹•ã§å¾©æ—§
  * ã‚«ãƒ¼ãƒãƒ«ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‹timeouté »åº¦ã®æ¤œçŸ¥ãŒå¿…è¦ãã†
* timeoutã‚’è€ƒæ…®ã«å…¥ã‚ŒãŸæ§‹æˆã«ã—ã¦ãŸç­ˆãªã®ã§æƒ³å®šå¤–ã ã£ãŸ

# ã¾ã¨ã‚
---------

* Clojureã§SSPä½œã£ãŸã‚ˆ
* Clojureä½¿ãˆã°éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒç°¡å˜ã«å‡ºæ¥ã‚‹ã‚ˆ
* é‹ç”¨ã£ã¦å¤§å¤‰ã ã‚ˆ


# å‚è€ƒ
-------

* [KeenS/s7p: sexp version of s6p; a toy SSP.](https://github.com/KeenS/s7p)
* [Clojureã§DSPã‚’ä½œã£ãŸè©± | Îºeenã®Happy HacÎºing Blog](http://keens.github.io/slide/ClojuredeDSPwotsukuttahanashi/)
* [KeenS/b11d: A toy DSP](https://github.com/KeenS/b11d)
* [ã‚¢ãƒ‰ãƒ†ã‚¯ã‚³ãƒ³ãƒš | æ ªå¼ä¼šç¤¾ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](https://www.cyberagent.co.jp/recruit/fresh/program_detail/id=11303&amp;season=2016)
* [ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã‚‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚‚å­¦ã¹ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯ã‚¹ã‚¿ã‚¸ã‚ªã®è‚²æˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã¯ | æ ªå¼ä¼šç¤¾ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ](https://www.cyberagent.co.jp/techinfo_detail/id=11380)

&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>readlineã®ä½œã‚Šæ–¹</title>
      <link>/post/readlinenotsukurikata/</link>
      <pubDate>Sun, 14 Feb 2016 22:37:35 +0900</pubDate>
      
      <guid>/post/readlinenotsukurikata/</guid>
      <description>

&lt;p&gt;Îºeenã§ã™ã€‚ãªã‚“ã‹ä¼ç·šã£ã½ã„ã‚‚ã®å›åã—ã¨ã„ãŸæ–¹ãŒè‰¯ã„ã‹ãªã¨æ€ã£ã¦Linuxã£ã½ã„è©±ã§ã‚‚ã€‚&lt;/p&gt;

&lt;p&gt;readlineã£ã¦ä¾¿åˆ©ã§ã™ã‚ˆã­ã€‚
ã§ã‚‚Cã§æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‹ã‚‰ä»–ã®è¨€èªã‹ã‚‰ä½¿ãŠã†ã¨æ€ã†ã¨é¢å€’ã ã£ãŸã‚Šä½¿ãˆãªã‹ã£ãŸã‚ŠGPLv3ã®æ‰€ç‚ºã§ä½¿ãˆãªã‹ã£ãŸã‚Šã—ã¾ã™ã‚ˆã­ã€‚
ãã“ã§ã‚ã‚‹ç¨‹åº¦POSIXã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ‰±ã‚ã›ã¦ãã‚Œã‚‹è¨€èªã§ã®readlineã®ä½œã‚Šæ–¹ã§ã‚‚ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰:58de41bc5e8c50f42088984a9312e8c7&#34;&gt;ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰&lt;/h1&gt;

&lt;p&gt;readlineã®ä»•çµ„ã¿è‡ªä½“ã¯ç°¡å˜ã§ã€å…¨ã¦ã®æ–‡å­—å…¥åŠ›ã‚’å—ã‘å–ã£ã¦ã€&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;readlineã®åˆ¶å¾¡ã‚­ãƒ¼ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãªã‚‰æŒ‡å®šã®åˆ¶å¾¡ã‚’è¡Œãªã†&lt;/li&gt;
&lt;li&gt;æ™®é€šã®æ–‡å­—ãªã‚‰ãã®ã¾ã¾ç”»é¢ã«è¡¨ç¤ºã™ã‚‹&lt;/li&gt;
&lt;li&gt;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãªã‚‰ &lt;code&gt;^W&lt;/code&gt; ãªã©ã¨ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—è¡¨ç¤ºã™ã‚‹&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã“ã‚Œã ã‘ã§ã™ã€‚ã—ã‹ã—ãã†ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ã‚ãªãŸã®ãŠæ°—ã«å…¥ã‚Šã®è¨€èªã§ &lt;code&gt;readchar&lt;/code&gt; ã£ã½ã„é–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨åˆ†ã‹ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ä¸€æ–‡å­—å…¥åŠ›ã—ãŸã ã‘ã§ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å…¥åŠ›æ–‡å­—ãŒæ¸¡ã•ã‚Œãªã„ã€‚ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦åˆã‚ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® &lt;code&gt;readchar&lt;/code&gt; é–¢æ•°ãŒè¿”ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;å…¥åŠ›ã—ãŸæ–‡å­—ãŒãã®ã¾ã¾ã‚¨ã‚³ãƒ¼ãƒãƒƒã‚¯ã•ã‚Œã‚‹ã€‚ã™ãªã‚ã¡ã€ &lt;code&gt;â†&lt;/code&gt; ã‚’æŠ¼ã—ã¦ã‚‚ &lt;code&gt;^[[D&lt;/code&gt; ãŒå…¥åŠ›ã•ã‚Œã¦ã—ã¾ã„ã€åˆ¶å¾¡ä¸Šä¸éƒ½åˆã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç§ã¯æ˜”ã¯ã“ã‚Œã‚‰ã®æŒ™å‹•ãŒé©åˆ‡ãªé–¢æ•°ãŒãªã„ã‹ã‚‰ã ã¨æ€ã£ã¦ã¾ã—ãŸã€‚ã—ã‹ã—ã€ãã†ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ã“ã®ã‚ˆã†ãªæŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è²¬ä»»ã§ã‚‚ã§ã‚‚ã‚·ã‚§ãƒ«ã®è²¬ä»»ã§ã‚‚ãªãã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®è²¬ä»»ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¯å¤šå½©ãªãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚Šã€ãã‚Œã«ã‚ˆã£ã¦æŒ™å‹•ãŒå¤‰ã‚ã‚‹ã®ã§ã™ã€‚
ã¤ã¾ã‚Šã€1.ã®æŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã®æŒ™å‹•ã€2.ã®æŒ™å‹•ã‚’ã™ã‚‹ã®ã¯ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®æŒ™å‹•ãªã®ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;tcgetattr-ã¨-tcsetattr:58de41bc5e8c50f42088984a9312e8c7&#34;&gt;&lt;code&gt;tcgetattr&lt;/code&gt; ã¨ &lt;code&gt;tcsetattr&lt;/code&gt;&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ å´ã‹ã‚‰å¤‰æ›´å‡ºæ¥ã¾ã™ã€‚ãã‚Œã‚’è¡Œãªã†ã®ãŒ &lt;code&gt;tcgetattr(3)&lt;/code&gt; ã¨ &lt;code&gt;tcsetattr(3)&lt;/code&gt; ã§ã™ã€‚
ã–ã£ãã‚Šè¨€ã†ã¨ &lt;code&gt;tcgetattr&lt;/code&gt; ã§ç¾åœ¨ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã‚³ãƒ³ãƒ•ã‚£ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–å¾—ã—ã¦ã€ãã‚Œã‚’æ‰€æœ›ã®ãƒ¢ãƒ¼ãƒ‰ã«æ›¸ãæ›ãˆã€ &lt;code&gt;tcsetattr&lt;/code&gt; ã‚’ä½¿ã£ã¦åæ˜ å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›ã¯ã‚«ãƒãƒ‹ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã¨ã‚¨ã‚³ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’offã«ã—ãŸã„ã®ã§ã™ã”ã„é›‘ãªã‚³ãƒ¼ãƒ‰ã ã¨ã“ã†æ›¸ã‘ã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(require &#39;sb-posix)
(let* ((stdin 0)
       (termios (sb-posix:tcgetattr stdin))
       (lflag (sb-posix:termios-lflag termios)))
  (setf lflag (logand lflag (lognot sb-posix:icanon)))
  (setf lflag (logand lflag (lognot sb-posix:echo)))
  (setf (sb-posix:termios-lflag termios) lflag)
  (sb-posix:tcsetattr stdin sb-posix:tcsadrain termios))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã—ã‹ã—ã€ã“ã‚Œã¯é›‘ã™ãã¾ã™ã€‚ãªãœãªã‚‰readlineã‚’å®Ÿè¡Œã—çµ‚ã‚ã£ãŸå¾Œã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å…ƒã®çŠ¶æ…‹ã«å¾©å…ƒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚
ãã†ã—ãªã„ã¨readlineã™ã‚‹ã¤ã‚‚ã‚Šã®ãªã„å…¥åŠ›é–¢æ•°ãŒäºˆæœŸã›ã¬æŒ™å‹•ã‚’ã™ã‚‹ã§ã—ã‚‡ã†ã€‚
ã‚ã‚‹ã„ã¯Lispãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã—ãŸå¾Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¾ã§å½±éŸ¿ãŒåŠã³ã¾ã™ã€‚
ãªã®ã§ &lt;strong&gt;å¿…ãš&lt;/strong&gt; å‡¦ç†ãŒçµ‚ã‚ã£ãŸã‚‰ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®çŠ¶æ…‹ã‚’å¾©å…ƒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€Common Lispã§ã¯ã“ã®ã€Œå¿…ãšã€ã¯ &lt;code&gt;unwind-protect&lt;/code&gt; ã‚’ä½¿ã£ãŸ &lt;code&gt;with-&lt;/code&gt; ãƒã‚¯ãƒ­ã§å®Ÿç¾ã™ã‚‹ã®ãŒå¸¸å¥—æ‰‹æ®µã§ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã¯ã“ã®ã‚ˆã†ã«ãªã‚‹ã§ã—ã‚‡ã†ã‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro with-readline-mode (&amp;amp;body body)
  (let ((stdin       (gensym &amp;quot;stdin&amp;quot;))
        (old-termios (gensym &amp;quot;old-termios&amp;quot;))
        (new-termios (gensym &amp;quot;new-termios&amp;quot;))
        (lflag       (gensym &amp;quot;lflag&amp;quot;)))
    `(let* ((,stdin 0)
            (,old-termios (sb-posix:tcgetattr ,stdin))
            (,new-termios (sb-posix:tcgetattr ,stdin))
            (,lflag (sb-posix:termios-lflag ,new-termios)))
       (unwind-protect
            (progn
              (setf ,lflag (logand ,lflag (lognot sb-posix:icanon)))
              (setf ,lflag (logand ,lflag (lognot sb-posix:echo)))
              (setf (sb-posix:termios-lflag ,new-termios) ,lflag)
              (sb-posix:tcsetattr ,stdin sb-posix:tcsadrain ,new-termios)
              ,@body)
        (sb-posix:tcsetattr ,stdin sb-posix:tcsadrain ,old-termios)))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã§&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(with-readline-mode
  (format t &amp;quot;~a~%&amp;quot; (read-char)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãªã©ã¨ã™ã‚‹ã¨ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰ãŒå¤‰ã‚ã£ãŸã“ã¨ãŒå®Ÿæ„Ÿå‡ºæ¥ã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;å°šã€ç¹°ã‚Šè¿”ã™ã¨ã“ã‚Œã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®è¨­å®šã®è©±ãªã®ã§Emacså†…ã‹ã‚‰è©¦ãã†ã¨ã—ã¦ã‚‚æ­£å¸¸ã«å‹•ä½œã—ãªã„ç­ˆã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹:58de41bc5e8c50f42088984a9312e8c7&#34;&gt;ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€Common Lispã®æ¨™æº–ã«ãªã„æ‹¡å¼µæ©Ÿèƒ½ãŒå¿…è¦ãªã®ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´ã ã‘ã§ã€ã‚ã¨ã¯å¥½ãå‹æ‰‹å‡ºæ¥ã‚‹ã®ã§ã™ãŒç§ã‚‚å°‘ã—åµŒã£ãŸéƒ¨åˆ†ãŒã‚ã‚‹ã®ã§ãã“ã ã‘ã€‚&lt;/p&gt;

&lt;p&gt;readlineã«æ¬²ã—ã„æ©Ÿèƒ½ã¯ãªã‚“ã§ã—ã‚‡ã†ã‹ã€‚è‰²ã€…ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ã¾ãšã¯ &lt;code&gt;â†&lt;/code&gt; ã€ &lt;code&gt;â†’&lt;/code&gt; ã§ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã‚’ã—ãŸã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚
å®Ÿã¯ã“ã‚ŒãŒå¤§è½ã—ç©´ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;â†&lt;/code&gt; ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¯ãªã‚“ã¨3æ–‡å­—å…¥åŠ›ã•ã‚Œã¾ã™ã€‚ã™ãªã‚ã¡ã€ Escæ–‡å­—ã® &lt;code&gt;^[&lt;/code&gt; ã€æ™®é€šã®ASCIIæ–‡å­—ã® &lt;code&gt;[&lt;/code&gt; ã€ãã—ã¦å¤§æ–‡å­—ã® &lt;code&gt;D&lt;/code&gt; ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã—ã¦ã‚«ãƒ¼ã‚½ãƒ«ã®ç§»å‹•æ–‡å­—ã‚’å—ã‘ã¦ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç§»å‹•ã™ã‚‹ã«ã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãã®ã¾ã¾Escæ–‡å­—ã® &lt;code&gt;^[&lt;/code&gt; ã€æ™®é€šã®ASCIIæ–‡å­—ã® &lt;code&gt;[&lt;/code&gt; ã€ãã—ã¦å¤§æ–‡å­—ã® &lt;code&gt;D&lt;/code&gt; ã‚’å…¥åŠ›ã—ã¦ã‚ã’ã‚Œã°å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãªã®ã§ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defconstant left &amp;quot;[d&amp;quot;)
(defconstant right &amp;quot;[c&amp;quot;)

(defun left ()
  (format t &amp;quot;~a&amp;quot; left)
  (force-output))

(defun right ()
  (format t &amp;quot;~a&amp;quot; right)
  (force-output))


(defun readline ()
  (let ((line &#39;()))
    (flet ((self-insert (char)
             (format t &amp;quot;~c&amp;quot; char)
             (setf line (cons char line))
             (force-output)))
      (with-readline-mode
       (loop
          (let* ((char (read-char))
                 (code (char-code char)))
            (case code
              ; escape
              ((#b11011)
               (let* ((char (read-char))
                      (code (char-code char)))
                 ;; (write-line &amp;quot;called&amp;quot;)
                 ;; (format t &amp;quot;~a~%&amp;quot; char)
                 ;; (format t &amp;quot;~a~%&amp;quot; code)
                 (case char
                   ((#\[)
                    (let* ((char (read-char))
                           (code (char-code char)))
                      (case char
                        ((#\c) (right))
                        ((#\d) (left)))))
                   ((t)
                    (self-insert #\escape)
                    (self-insert char)))))
              ((#b1010)
               (return-from readline (coerce (reverse line) &#39;string)))
              (t (self-insert char)))))))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;case&lt;/code&gt; ã‚’ãƒã‚¹ãƒˆã—ã¦ã„ãã®ã¯ãƒ€ãƒ«ã„ã—æ‹¡å¼µæ€§ãŒãªã„ã®ã§ç¾å®Ÿçš„ã«ã¯trieæœ¨ã‚’ä½¿ã†ã“ã¨ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒå˜ç´”ã«ã¯ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã§readlineã‚’ä½œã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s Happy HacÎºking!&lt;/p&gt;

&lt;h1 id=&#34;ä»˜éŒ²a-ä¼ç·š:58de41bc5e8c50f42088984a9312e8c7&#34;&gt;ä»˜éŒ²A: ä¼ç·š&lt;/h1&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;é©å½“ã«é­šã¨é‡èœç‚’ã‚ãŸã‚‰ã‚ªã‚µãƒ¬ã£ã½ããªã£ãŸ &lt;a href=&#34;https://t.co/9IIzhIGjzd&#34;&gt;pic.twitter.com/9IIzhIGjzd&lt;/a&gt;&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/698821538686984192&#34;&gt;2016, 2æœˆ 14&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; é­šã¯ä½•ï¼Ÿã‚¿ãƒ©ï¼Ÿã ã£ãŸã‚‰å­£ç¯€ç‰©ã ã—ã€æ—¬ã®é±ˆã¨é‡èœã®ã‚½ãƒ†ãƒ¼ã€è©³è§£Linuxã‚«ãƒ¼ãƒãƒ«ã‚’æ·»ãˆã¦ã€‚ã¨å‘½åã—ã‚ˆã†&lt;/p&gt;&amp;mdash; Shinnosuke Takeda (@cnosuke) &lt;a href=&#34;https://twitter.com/cnosuke/status/698824048319410176&#34;&gt;2016, 2æœˆ 14&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h1 id=&#34;ä»˜éŒ²b-pure-rubyãªreadlineã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰:58de41bc5e8c50f42088984a9312e8c7&#34;&gt;ä»˜éŒ²B: Pure Rubyãªreadlineã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h1&gt;

&lt;p&gt;åŠªåŠ›ãŒå¿…è¦ã¨ã„ã†ã“ã¨ãŒèª­ã¿è§£ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/ConnorAtherton/rb-readline/blob/master/lib/rbreadline.rb&#34;&gt;rb-readline/rbreadline.rb at master Â· ConnorAtherton/rb-readline&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Common Lispã§é«˜é€Ÿè¡Œåˆ—æ¼”ç®—</title>
      <link>/post/Common_Lispdekousokugyouretsuenzan/</link>
      <pubDate>Thu, 04 Feb 2016 23:47:34 +0900</pubDate>
      
      <guid>/post/Common_Lispdekousokugyouretsuenzan/</guid>
      <description>

&lt;p&gt;Îºeenã§ã™ã€‚Common Lispã‹ã‚‰ç·šå½¢ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ãƒã‚¹ãƒˆã§æ¯”è¼ƒã«Common Lispã®ã‚³ãƒ¼ãƒ‰ãŒå‡ºã•ã‚Œã¦ã„ãŸã®ã§ã™ãŒã‚‚ã†å°‘ã—æ”¹è‰¯å‡ºæ¥ãã†ã ã£ãŸã®ã§å°‘ã—ã°ã‹ã‚Šé«˜é€ŸåŒ–ã—ã¦ã¿ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ãã®ãƒã‚¹ãƒˆã¯ã“ã¡ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://d.hatena.ne.jp/masatoi/20160204/1454519281&#34;&gt;Common Lispã§è¡Œåˆ—æ¼”ç®—: LLA(Lisp Linear Algebra)ã‚’ä½¿ã† - ç¿¡ç¿ ã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«åµã‚’ç”Ÿã‚€ã‹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;åœ§å€’çš„ã«Common LispãŒé…ã„ã§ã™ã­ã€‚ãã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã‹ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://tanakahx.hatenablog.com/entry/2015/09/25/070000&#34;&gt;Python (NumPy) ã¨ Common Lisp (LLA) ã§è¡Œåˆ—ç©ã®å®Ÿè¡Œé€Ÿåº¦ã‚’æ¯”è¼ƒã™ã‚‹ - ä¸ç¢ºå®šç‰¹ç•°ç‚¹&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;è¡Œåˆ—è¨ˆç®—(GEMM)éƒ¨åˆ†ã‚’æŠœãå‡ºã™ã¨ã“ã†ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun simple-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))
      (dotimes (row rows)
        (dotimes (col cols)
          (dotimes (k cols)
            (incf (aref result row col)
                  (* (aref ma row k) (aref mb k col))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã‚’&lt;code&gt;*N*&lt;/code&gt; = 256, ã§100å›ç¹°ã‚Šè¿”ã—ãŸã‚‰&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   4.688 seconds of real time
;;   4.692000 seconds of total run time (4.688000 user, 0.004000 system)
;;   100.09% CPU
;;   13,564,728,093 processor cycles
;;   26,216,000 bytes consed

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã®ã“ã¨ã€‚ã¾ã‚ã€ã¾ã é«˜é€ŸåŒ–ã®ä½™åœ°ã¯ã‚ã‚Šãã†ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹&lt;/h1&gt;

&lt;p&gt;å†…å´ã®ãƒ«ãƒ¼ãƒ—ã‚’ã¿ã‚‹ã¨ã“ã†ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;          (dotimes (k cols)
            (incf (aref result row col)
                  (* (aref ma row k) (aref mb k col))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;incf&lt;/code&gt;ã‚’ã°ã‚‰ã™ã¨ã“ã†ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;          (dotimes (k cols)
            (setf (aref result row col)
                  (+ (aref result row col) (* (aref ma row k) (aref mb k col)))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å€¤ã¨ã—ã¦å‚ç…§ã—ã¦ã„ã‚‹æ–¹ã®&lt;code&gt;(aref result row col)&lt;/code&gt;ã¯&lt;code&gt;k&lt;/code&gt;ã«ä¾å­˜ã—ãªã„ã®ã§ãƒ«ãƒ¼ãƒ—ã®å¤–ã«å‡ºã›ã¾ã™ã€‚
æ›¸ãè¾¼ã‚“ã§ã„ã‚‹æ–¹ã¯å ´æ‰€ã ã‹ã‚‰ä»•æ–¹ãªã„ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun caching-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((cell (aref result row col)))
           (dotimes (k cols)
             (setf (aref result row col)
              (+ cell (* (aref ma row k) (aref mb k col)))))
           )))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ã¨ã‚‹ã¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; 3.971 seconds of real time
;; 3.972000 seconds of total run time (3.972000 user, 0.000000 system)
;; 100.03% CPU
;; 11,491,319,119 processor cycles
;; 26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2016-02-28 è¿½è¨˜:&lt;/p&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; data-lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã¨ã“ã‚ã€resultã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«kã¯ä½¿ã£ã¦ãªã„ã‘ã©ã€kãŒé€²ã‚€ã”ã¨ã«å¯¾è±¡ã®è¦ç´ ã¯å¤‰åŒ–ã—ã¦ã‚‹ã¯ãšãªã®ã§ã€ã“ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã—ã‹ãŸã¯ã¾ãšã„ã®ã§ã¯?&lt;/p&gt;&amp;mdash; goskevich (@gos_k) &lt;a href=&#34;https://twitter.com/gos_k/status/700622885933613056&#34;&gt;2016å¹´2æœˆ19æ—¥&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§ã“ã‚Œã¯é–“é•ã£ã¦ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€å…ˆç¨‹ã®å†…å´ã®ãƒ«ãƒ¼ãƒ—ã€ä»•äº‹ãŒå°‘ãªã„ã§ã™ã­ã€‚å°ã•ãªä»•äº‹ã‚’ãƒãƒãƒãƒãƒ«ãƒ¼ãƒ—ã—ã¦ã‚‹ã¨ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆãŒåµ©ã¿ã¾ã™ã€‚
1å›ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ä»•äº‹ã‚’å¢—ã‚„ã™ã¹ãã€ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚’ã—ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ã‚³ãƒ”ãƒšã¯ãƒ€ãƒ«ã„ã®ã§ã¾ãšã¯ãƒã‚¯ãƒ­ã‚’ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro dotimes-unroll ((i n unroll) &amp;amp;body body)
  (let ((n_      (gensym &amp;quot;n&amp;quot;)))
    `(let ((,n_ ,n))
       (do ((,i 0))
           ((&amp;lt; ,n_ (the fixnum (+ ,unroll ,i)))
            (do ((,i ,i (the fixnum (1+ ,i))))
                ((&amp;lt; ,n_ (the fixnum (1+ ,i))))
              ,@body
              ))
         ,@(loop :repeat unroll :append (append body `((setq ,i (the fixnum (1+ ,i))))))))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°‘ã—è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(dotimes-unroll (i 10 3)
  (format t &amp;quot;~%~a&amp;quot;) i)
0
1
2
3
4
5
6
7
8
9
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ˆã—ã‚ˆã—ã€‚&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯ã“ã‚Œã‚’ä½¿ã£ã¦ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun loop-unroll-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((cell (aref result row col)))
           (dotimes-unroll (k cols 16)
             (setf (aref result row col)
              (+ cell (* (aref ma row k) (aref mb k col))))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ«æ•°ã¯16ãŒä¸€ç•ªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‡ºãŸã‚ˆã†ã§ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   3.847 seconds of real time
;;   3.848000 seconds of total run time (3.848000 user, 0.000000 system)
;;   [ Run times consist of 0.012 seconds GC time, and 3.836 seconds non-GC time. ]
;;   100.03% CPU
;;   11,128,993,432 processor cycles
;;   26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¾›ã†ã˜ã¦é€Ÿããªã£ã¦ã‚‹â€¦ã€‚å› ã¿ã«ã“ã‚Œã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯CPUã®å‘½ä»¤ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®çŠ¶æ³ã«ä¾å­˜ã™ã‚‹ã®ã§ä½•åº¦ã‹è©¦ã™ã¨ã“ã‚Œã‚ˆã‚Šé€Ÿã„ã‚¹ã‚³ã‚¢ãŒå‡ºã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Evaluation took:
  3.338 seconds of real time
  3.340000 seconds of total run time (3.332000 user, 0.008000 system)
  [ Run times consist of 0.020 seconds GC time, and 3.320 seconds non-GC time. ]
  100.06% CPU
  9,657,259,219 processor cycles
  26,248,768 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã—ãªã„&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€æœ€åˆã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãŸæ™‚ã«æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹æ–¹ã® &lt;code&gt;(aref result row col)&lt;/code&gt; ã¯å ´æ‰€ã ã‹ã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‡ºæ¥ãªã„ã¨ã„ã„ã¾ã—ãŸã€‚ã¾ã‚ã€ãã‚Œã¯æ­£ã—ã„ã®ã§ã™ãŒãƒ«ãƒ¼ãƒ—ã®ä¸­ã§æ¯å›æ›¸ãè¾¼ã‚€å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ¬ã‚¸ã‚¹ã‚¿ä¸Šã§è¨ˆç®—ã‚’æ¸ˆã¾ã›ã¦æœ€å¾Œã«æ›¸ãè¾¼ã‚“ã§ã‚ã’ã‚Œã°ååˆ†ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun on-register-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let ((rows (array-dimension ma 0))
        (cols (array-dimension mb 1)))
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (col cols)
          (let ((res (aref result row col)))
           (dotimes-unroll (k cols 16)
             (setf res
                   (the single-float (+ res (* (aref ma row k) (aref mb k col))))))
           (setf (aref result row col) res))))
      result)))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;; Evaluation took:
;;   2.302 seconds of real time
;;   2.304000 seconds of total run time (2.300000 user, 0.004000 system)
;;   [ Run times consist of 0.008 seconds GC time, and 2.296 seconds non-GC time. ]
;;   100.09% CPU
;;   6,662,273,812 processor cycles
;;   26,216,000 bytes consed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ãŠï¼æ€¥ã«é€Ÿããªã‚Šã¾ã—ãŸã€‚ &lt;code&gt;(* 100 (- (/ 4.688 2.302) 1))&lt;/code&gt; â‰’ 103ã€ 100%è¿‘ã„é«˜é€ŸåŒ–ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãŠã‚ã‚Šã«:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ãŠã‚ã‚Šã«&lt;/h1&gt;

&lt;p&gt;ç‰¹ã«æ·±ã„æ„å‘³ã¯ãªã‹ã£ãŸã®ã§ã™ãŒãƒ‘ã‚¿ãƒ˜ãƒã«è¼‰ã£ã¦ã„ãŸã‚„ã¤ã‚’è©¦ã—ã¦ã¿ãŸãã¦éŠã‚“ã§ã¿ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;æ™®é€šã«è¡Œåˆ—è¨ˆç®—ã—ãŸã„ãªã‚‰ç·šå½¢ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ã£ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒãƒ¼ãƒˆ:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ãƒãƒ¼ãƒˆ&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°ã®éƒ¨åˆ†ã‚’ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆã§èª¬æ˜ã—ã¾ã—ãŸãŒä»–ã«ã‚‚1ãƒ«ãƒ¼ãƒ—å†…ã®å‘½ä»¤æ•°ãŒå¢—ãˆã‚‹ã¨çµ„ã¿åˆã‚ã›ãƒ‘ã‚ºãƒ«ã®ãƒ”ãƒ¼ã‚¹ãŒå¢—ãˆã‚‹ã®ã§æœ€é©åŒ–ã•ã‚Œã‚„ã™ããªã‚Šã¾ã™ã€‚ã¾ã‚ã€SBCLã¯è¦—ãç©´æœ€é©åŒ–ã‚’ã»ã¨ã‚“ã©ã—ãªã„ã®ã§ã‚ã¾ã‚Šæ„å‘³ã‚ã‚Šã¾ã›ã‚“ãŒã€‚æ°—ã«ãªã‚‹æ–¹ã¯ãƒ‡ã‚£ã‚¹ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚&lt;/li&gt;
&lt;li&gt;ã“ã®ã‚ã¨ã€ &lt;code&gt;(aref mb k col)&lt;/code&gt; ãŒCPUã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡é§„ã«ã—ã¦ã„ã‚‹ã¨ã„ã†è©±ã‹ã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚ºæ¯ã«è¡Œã€åˆ—ã‚’åˆ†ã‘ã¦è¨ˆç®—ã™ã‚‹ã‚„ã‚Šæ–¹ã‚’ç´¹ä»‹ã—ã‚ˆã†ã¨ã—ãŸã®ã§ã™ãŒé€†ã«é…ããªã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ä»˜éŒ²Aã«ã‚³ãƒ¼ãƒ‰ã‚’ç½®ã„ã¦ãŠãã¾ã™ã€‚ã†ãƒ¼ã‚€ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬å½“ã¯ã•ã‚‰ã«ã“ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ¯ã«ã‚¹ãƒ¬ãƒƒãƒ‰ã«è¨ˆç®—ã‚’æŠ•ã’ã¦ä¸¦åˆ—åŒ–ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§é«˜é€ŸåŒ–ã—ãªã‹ã£ãŸã®ã§èãˆã¦è«¦ã‚ã¾ã—ãŸã€‚&lt;/li&gt;
&lt;li&gt;ãƒ‘ã‚¿ãƒ˜ãƒçš„ã«ã¯SIMDã‚‚ä½¿ã†ã®ã§ã™ãŒæ·±å¤œã«è¿‘ä»˜ã„ã¦ãã¦é¢å€’ã«ãªã£ãŸã®ã§ã“ã®è¾ºã§ã‚„ã‚ã¾ã—ãŸã€‚Common Lisp(SBCL)ã‹ã‚‰SIMDå‘½ä»¤ã‚’ä½¿ã†ã«ã¯&lt;a href=&#34;http://keens.github.io/blog/2014/12/02/vopdeyou-bu/&#34;&gt;ç§ã®éå»ã®ã‚¨ãƒ³ãƒˆãƒª&lt;/a&gt;ã‚’å‚ç…§ã—ã¦ä¸‹ã•ã„ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ°—ã§è¡Œåˆ—è¨ˆç®—ã‚’ã—ãŸã„ãªã‚‰ä»Šå›ã® $O(n^3)$ ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã ã‘ã§ãªãStrassenã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„Coppersmith-Winogradã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚‚æ¤œè¨ã™ã¹ãã§ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;ä»˜éŒ²a:ac3da300d14ff6fe33746d6ed93b7e0b&#34;&gt;ä»˜éŒ²A&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun segmented-gemm (ma mb)
  &amp;quot;Common Lispã®ã¿ã‚’ä½¿ã£ãŸè¡Œåˆ—ç©ã®è¨ˆç®—&amp;quot;
  (declare (optimize (speed 3) (debug 0) (safety 0)))
  (declare (type (simple-array single-float (* *)) ma mb))
  (let* ((segment 16)
         (rows (array-dimension ma 0))
         (cols (array-dimension mb 1))
         (colseg (floor cols segment))
         ktmp coltmp
         k col
         )
    (declare (type fixnum rows cols))
    (let ((result (make-matrix rows cols)))
      (declare (type (simple-array single-float (* *)) result))

      (dotimes (row rows)
        (dotimes (ci colseg)
          (setf coltmp (the fixnum (* ci segment)))
          (dotimes (ki colseg)
            (setf ktmp (the fixnum (* ki segment)))
           (dotimes (cs segment)
             (setf col (the fixnum (+ coltmp cs)))
             (let ((res (aref result row col)))
               (dotimes (ks segment)
                 (setf k (the fixnum (+ ktmp ks)))
                 (setf res
                       (the single-float (+ res (* (aref ma row k) (aref mb k col))))))
               (setf (aref result row col) res))))))
      result)))
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Lisp Meetup3å‘¨å¹´ã«å¯„ã›ã¦</title>
      <link>/post/Lisp_Meetup3shuunenniyosete/</link>
      <pubDate>Wed, 27 Jan 2016 23:40:11 +0900</pubDate>
      
      <guid>/post/Lisp_Meetup3shuunenniyosete/</guid>
      <description>&lt;p&gt;Îºeenã§ã™ã€‚æ˜¨æ—¥ã€&lt;a href=&#34;http://lisp.connpass.com/event/25546/&#34;&gt;Lisp Meetup #36&lt;/a&gt;ãŒè¡Œãªã‚ã‚Œã¾ã—ãŸã€‚1å›ãƒ†ãƒƒã‚¯ãƒˆãƒ¼ã‚¯ã‚’æŒŸã‚“ã§ã‚‹ã®ã§ã“ã‚Œã§ã¡ã‚‡ã†ã©ä¸¸3å¹´ã€æ¯æœˆLisp MeetupãŒè¡Œã‚ã‚ŒãŸã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Lisp Meetupã¯&lt;a href=&#34;http://shibuya.lisp-users.org/&#34;&gt;Shibuya.lisp&lt;/a&gt;ãŒåŸºæœ¬ã€æ¯æœˆé–‹å‚¬ã—ã¦ã„ã‚‹è‰ã®æ ¹æ´»å‹•ã§ã€LisperåŒå£«ã®äº¤æµã‚’ç›®çš„ã¨ã—ã¦ä¸»ã«å¸Œæœ›è€…ã«ã‚ˆã‚‹ãƒˆãƒ¼ã‚¯ã‚’ãƒ¡ã‚¤ãƒ³ã¨ã—ãŸä¼šã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;æ¯æœˆCommon Lispã€Clojureã€Schemeå›ã§ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ã„ã¦ã€è¿‘é ƒã¯Schemeå›ã«SchemerãŒæ¥ãªã„ã“ã¨ã‹ã‚‰Schemeå›ã‚’æ¸›ã‚‰ã—ã¦é‹ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
æœ€åˆã«è¿°ã¹ãŸé€šã‚ŠLisp Meetupã ã‘ã§36å›ã€ä¸¸3å¹´æ´»å‹•ã—ã¦ãã¾ã—ãŸã€‚ã“ã“æœ€è¿‘ã¯å®šå“¡ã«ã‚®ãƒªã‚®ãƒªã¾ã§äººãŒé›†ã¾ã‚‹ãã‚‰ã„ã®ç››æ³ã§ä½•ã‚ˆã‚Šã§ã™ã€‚
ã“ã“ã¾ã§ç¶™ç¶šã—ãŸã“ã¨ã‚’ç¥ã£ã¦è¨˜å¿µã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã‚’ä½œã‚Šã¾ã—ãŸã€‚ç§ã¯ã»ã¨ã‚“ã©ä½•ã‚‚ã—ã¦ã¾ã›ã‚“ãŒã€‚@potix2ã•ã‚“ã«æ„Ÿè¬ã€‚&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;ä»Šæ—¥ã®Lisp Meet Upã¯3å‘¨å¹´è¨˜å¿µã§ã™ã­ã€‚å…ˆç¨‹ã‚¹ãƒ†ãƒƒã‚«ãƒ¼å±Šãã¾ã—ãŸã€‚ &lt;a href=&#34;https://t.co/IRKkKVnkeU&#34;&gt;pic.twitter.com/IRKkKVnkeU&lt;/a&gt;&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/691875297940148224&#34;&gt;2016, 1æœˆ 26&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;ç§ãŒåˆã‚ã¦å‚åŠ ã—ãŸã®ã¯ç¬¬7å›ã‹ã‚‰ã€é‹å–¶ã«ãªã£ãŸã®ãŒ1å¹´å¾Œã®ç¬¬19å›ã‹ã‚‰(ã®ç­ˆ)ã€‚
2å¹´åŠã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä¼šå ´ã«é€šã£ã¦æ°—ä»˜ã„ãŸã‚‰ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ç¤¾å“¡ã«ãªã£ã¦ã€ä¸€å‹‰å¼·ä¼šãŒã“ã“ã¾ã§å¤§ããäººç”Ÿã«å½±éŸ¿ã™ã‚‹ã®ã‹ã¨æ„Ÿæ…¨ã«è€½ã‚‹æ¬¡ç¬¬ã§ã™ã€‚
ä½•ã‚’å¤§è¢ˆè£Ÿã«ã€ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°çµŒé¨“ãŒèª¿å­ã«ä¹—ã£ã¦ããŸæ™‚ã¨Lisp Meetupã«å‚åŠ ã—å§‹ã‚ãŸæ™‚æœŸãŒé‡ãªã‚‹ã®ã§å€‹äººçš„ã«ã¯æ„Ÿæ…¨ã«è€½ã‚‹ã ã‘ã®ã‚‚ã®ãŒã‚ã‚‹ã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ä»–ã®ãƒ¡ã‚¸ãƒ£ãƒ¼ãªè¨€èªã®å‹‰å¼·ä¼šã§ã‚‚ä¸­ã€…èã‹ãªã„3å‘¨å¹´ã¨ã‚‚ãªã‚‹ã¨ã¾ãŸåˆ¥ç¨®ã®å•é¡Œã‚‚å‡ºã¦ãã‚‹è¨³ã§ã™ã€‚
ãã®1ã¤ãŒã€Œå›ºå®šåŒ–ã€å•é¡Œã§ã™ã€‚1åº¦ã‚‚Lisp Meetupã«æ¥ãŸã“ã¨ã®ãªã„æ–¹ã¯ã“ã†æ€ã†è¨³ã§ã™: ä½•åº¦ã‚‚å›ã‚’é‡ã­ã‚‹å†…ã«ãƒ¡ãƒ³ãƒãƒ¼ãŒå›ºå®šåŒ–ã•ã‚Œã¦ä¸€è¦‹ã•ã‚“ãŠæ–­ã‚Šãªé›°å›²æ°—ã«ãªã£ã¦ã‚‹ã‚“ã˜ã‚ƒãªã„ã‹ã¨ã€‚
å®Ÿéš›ã®ã¨ã“ã‚Lisp Meetupã«ã¯ãã‚“ãªé›°å›²æ°—ã¯ãªãã€ä½•åº¦ã‚‚æ¥ã¦ã‚‹äººã‚‚ã„ã‚Œã°ä¹…ã—ã¶ã‚Šã«æ¥ãŸäººã€æœ€è¿‘ã‚ˆãæ¥ã‚‹äººã€åˆã‚ã¦æ¥ã‚‹äººè‰²ã€…ã„ã‚‹è¨³ã§ã™ã€‚
å®Ÿæƒ…ãŒã©ã†ã‚ã‚Œã€ãŠå°»ã®æ•°å­—ãŒå¤§ãã„ã ã‘ã§ä¸€ç•ªæ¥ã¦æ¬²ã—ã„åˆå¿ƒè€…ãŒæ¥ãªããªã‚‹ãªã‚‰ã¨ã€ä¸€åº¦ã¯åå‰ã‚’å¤‰ãˆã¦é€£ç•ªã‚’ãƒªã‚»ãƒƒãƒˆã—ã‚ˆã†ã‹ã¨ã‚‚è©±ã•ã‚Œã¾ã—ãŸãŒçµå±€ä»Šã®Lisp Meetupã®ã¾ã¾ã§ã„ã¾ã™ã€‚
Lisp Meetupã¨ã„ãˆã°ç§ã®ã‚ˆã†ã«ã‚ˆãåˆ†ã‹ã‚‰ãªã„ç™ºè¡¨ã‚’ã—ã¦ã¦ã‚‚æš–ã‹ãå—ã‘å…¥ã‚Œã¦ãã‚Œã‚‹å„ªã—ã„äººé”ã®é›†ã‚Šãªã®ã§ã™ãŒã€ã¨ã¯ã„ãˆå¤–ã‹ã‚‰è¦‹ã¦ã€Œåˆã‚ã¦ã®å‹‰å¼·ä¼šã§Lisp Meetupã¯æ€–ã„ã€ãªã©ã¨è¨€ã‚ã‚Œã‚‹ã¨ä¸­ã€…è€ƒãˆã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ã¾ã‚ã€ãã‚Œã§ã‚‚åˆå¿ƒè€…ã‚„åˆå‚åŠ ã®äººã¯æ¯å›æ•°äººã¯æ¥ã¦ã‚‹ã®ã§ã“ã‚Œä»¥ä¸Šå¢—ã‚„ãã†ã¨ã™ã‚‹ã¨ã“ã‚Œã‚ˆã‚Šå¤§ããªä¼šå ´ã‚’ç¢ºä¿ã™ã‚‹å¿…è¦ãŒã‚ã£ã¦ä¸­ã€…ãƒãƒ¼ãƒ‰ãƒ«ã¯é«˜ã„ã®ã§ã™ãŒã€‚åˆå¿ƒè€…ã¯å¤§æ­“è¿ã¨ã„ã†ã“ã¨ã¯ä¼ãˆã¦ãŠã“ã†ã‹ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€æ¬¡å›ã¯Clojureå›ã§ã™ã€‚ãã‚ãã‚Schemeå›ã‚’â€¦ã¨æ€ã£ãŸã®ã§ã™ãŒç™ºè¡¨è€…ãŒé›†ã‚Šãã†ã«ãªã„ã®ã§è¦‹é€ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;å°‘ã—æ°—ã®æ—©ã„è©±ã§ã™ãŒæ¥æœˆ2æœˆã® &lt;a href=&#34;https://twitter.com/hashtag/lispmeetup?src=hash&#34;&gt;#lispmeetup&lt;/a&gt; ã§Schemeã‚’ãƒ†ãƒ¼ãƒã«ã™ã‚‹ã¨ã—ãŸã‚‰ã¿ãªã•ã‚“ã©ã†ã§ã™ã‹&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/688627343112278017&#34;&gt;2016, 1æœˆ 17&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;3æœˆã«ã¯é–‹å‚¬ã—ã‚ˆã†ã‹ã¨è©±ã—åˆã‚ã‚Œã¦ã„ã‚‹æœ€ä¸­ãªã®ã§Schemerå„ä½ã€SICPèª­æ›¸ä¸­ã®å„ä½ã¯æº–å‚™ã‚’ã—ã¦é–‹å‚¬ã—ã¦æ¬²ã—ã„ã‚ªãƒ¼ãƒ©ã‚’å‡ºã—ã¦é ‚ã‘ã‚‹ã¨é–‹å‚¬æ±ºå®šã®å¾ŒæŠ¼ã—ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§æ¥æœˆä»¥é™ã‚‚Lisp Meetupã‚’ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœ€è¿‘ä½œã£ã¦ã‚‹Lispã®è©±</title>
      <link>/post/saikintsukutteruLispnohanashi/</link>
      <pubDate>Sun, 20 Dec 2015 22:40:16 +0900</pubDate>
      
      <guid>/post/saikintsukutteruLispnohanashi/</guid>
      <description>&lt;p&gt;ã“ã®ã‚¨ãƒ³ãƒˆãƒªã¯&lt;a href=&#34;http://qiita.com/advent-calendar/2015/lisp&#34;&gt;Lisp Advent Calendar 2015&lt;/a&gt;21æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;Îºeenã§ã™ã€‚æœ€è¿‘ã‚ã¾ã‚ŠLispã‚’æ›¸ã„ã¦ãªãã¦ãƒã‚¿ãŒãªã„ã®ã§æœ€è¿‘ä½œã£ã¦ã‚‹Lispã®è©±ã§ã‚‚ã—ã‚ˆã†ã‹ã¨ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/KeenS/kappaLisp&#34;&gt;ÎºLisp&lt;/a&gt;ã¨ã„ã„ã¾ã™ã€‚ã¾ã ã¾ã å®Œæˆã«ã¯ç¨‹é ã„ã§ã™ã€‚ç¾åœ¨ã€&lt;a href=&#34;https://github.com/KeenS/kappaLisp/blob/master/src/eval.rs#L378&#34;&gt;ã“ã“ã‚‰è¾º&lt;/a&gt;ãã‚‰ã„ã®å¼ãªã‚‰è©•ä¾¡å‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®Lispã¯SKKè¾æ›¸ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹Så¼ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ä½œã‚‰ã‚Œã¾ã—ãŸã€‚
SKKã¯æ§˜ã€…ãªå ´æ‰€ã«ç§»æ¤ã•ã‚Œã¦ã„ã‚‹ã®ã§ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§å‹•ã„ã¦ä»–ã®è¨€èªã¨å”èª¿ãŒå‡ºæ¥ã‚‹è¨€èªã§ä½œã‚‹ã®ãŒæœ›ã¾ã—ã„ã®ã§ã™ãŒã€ä»Šå›ã¯Rustã‚’é¸ã³ã¾ã—ãŸã€‚
æœ€åˆã¯Cã«ã—ã‚ˆã†ã‹ã¨æ€ã£ãŸã®ã§ã™ãŒã¡ã‚‡ã„ã¨Rustã‚’è©¦ã—ã¦ã¿ã‚ˆã†ã‹ã¨(å½“æ™‚Rustã»ã¨ã‚“ã©æ›¸ã„ãŸã“ã¨ãŒãªã„åˆå¿ƒè€…)ã€‚&lt;/p&gt;

&lt;p&gt;SKKã«æ›¸ã‹ã‚Œã¦ã„ã‚‹Så¼ã‚’å‡¦ç†å‡ºæ¥ã‚‹Lispå‡¦ç†ç³»ã¯ã‚ã‚‹ã®ã§ã™ãŒGPLã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ãŠã‚Šã€ãã‚Œã‚’ä½¿ã£ãŸiOSã‚¢ãƒ—ãƒªã‚’AppStoreã«ç™»éŒ²å‡ºæ¥ãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚‹ãã†ã§ã™ã€‚
ãªã®ã§MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§ä½œã‚Šå§‹ã‚ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€Lispå‡¦ç†ç³»ãã‚‰ã„ç°¡å˜ã«ä½œã‚Œãã†ãªã‚‚ã®ã§ã™ãŒã€ã„ãã¤ã‹ã®ç‚¹ã§è©°ã¾ã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ãã‚‚ãã‚‚RustãŒé›£ã—ã„&lt;/li&gt;
&lt;li&gt;é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ãŒæ€ã†ã‚ˆã†ã«æ‰±ãˆãªã„&lt;/li&gt;
&lt;li&gt;ã‚„ã‚ã†ã¨ã—ãŸäº‹ãŒborrow checkã«å¼•ã£æ›ã‹ã£ã¦å‡ºæ¥ãªã‹ã£ãŸ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ã“ã®è©°ã¾ã£ãŸç‚¹ã¯RustãŒæ‚ªã„è¨³ã§ã¯ãªãã¦å˜ã«ç§ãŒRustã«åˆã‚ã›ãŸè¨­è¨ˆãŒå‡ºæ¥ãªã‹ã£ãŸã ã‘ã§ã™ã­ã€‚ãã‚ãã‚Rustã«ã‚‚å°‘ã—ã¥ã¤ã§ã™ãŒæ…£ã‚Œã¦æ¥ãŸã®ã§ã©ã“ã‹ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦é€²ã‚ã¦ã„ããŸã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å¿œç¾çŠ¶ã§ã‚‚é€²ã‚ã‚ˆã†ã¨æ€ãˆã°é€²ã‚ã‚Œã‚‹ã®ã§ã™ãŒ&lt;a href=&#34;https://github.com/KeenS/kappaLisp/blob/master/src/eval.rs#L232&#34;&gt;ã“ã“&lt;/a&gt;ã®ã‚ˆã†ã«æ˜ã‚‰ã‹ã«ã‚¤ã‚±ã¦ãªã„ã‚³ãƒ¼ãƒ‰ãŒç¶šãã®ã§é€²ã‚ã‚‹ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³èµ·ãã¾ã›ã‚“ã‚ˆã­ã€‚&lt;/p&gt;

&lt;p&gt;è¨­è¨ˆã¨ã‹ã®è©±ã‚’ã™ã‚‹ã¨ã€æœ€çµ‚çš„ã«ã¯C APIã§Så¼ã®æ–‡å­—åˆ—ã‚’å—ã‘å–ã£ãŸã‚‰ãã‚Œã‚’è©•ä¾¡ã—ãŸçµæœã®æ–‡å­—åˆ—ã‚’è¿”ã™é–¢æ•°ã‚’æ™’ã›ã°ã„ã„ã‹ãªã€ã¨æ€ã£ã¦ã¾ã™ã€‚
ã¡ã‚ƒã‚“ã¨iOSã¸ã®ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚å‡ºæ¥ã¾ã™ã—Obj-C, SwiftåŒæ–¹C FFIãŒã‚ã‚‹ã®ã§ãã‚Œã§ååˆ†ã§ã—ã‚‡ã†ã€‚(CF &lt;a href=&#34;http://qiita.com/moriturus/items/1190614dcbbe31ecfc2f&#34;&gt;http://qiita.com/moriturus/items/1190614dcbbe31ecfc2f&lt;/a&gt; , &lt;a href=&#34;http://safx-dev.blogspot.jp/2014/06/rustios.html&#34;&gt;http://safx-dev.blogspot.jp/2014/06/rustios.html&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;ãƒ‘ãƒ¼ã‚µã¯æ‰‹æ›¸ãã§ã€å®Ÿè¡Œã¯ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã€Emacs Lispã«å‰‡ã£ã¦Lisp2ã®ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚¹ã‚³ãƒ¼ãƒ—ã§ã™ã€‚è¨­è¨ˆãŒã‚¯ã‚½ãªã®ã§ãƒ¡ãƒ¢ãƒªç®¡ç†ã‚‰ã—ã„ãƒ¡ãƒ¢ãƒªç®¡ç†ã¯ã‚„ã£ã¦ã¾ã›ã‚“ãŒRustã®ãƒ¡ãƒ¢ãƒªç®¡ç†ã®ãŠé™°ã§ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã¯ã—ã¦ã¾ã›ã‚“ã€‚
ã¡ã‚ƒã‚“ã¨è¨­è¨ˆã—ã¦Reference Countãªãƒ¡ãƒ¢ãƒªç®¡ç†ã§ã‚‚ã—ã‚ˆã†ã‹ã¨ã€‚ãƒ•ãƒƒãƒˆãƒ—ãƒªãƒ³ãƒˆã®è»½ã•å¤§äº‹ã€‚&lt;/p&gt;

&lt;p&gt;å…¨ç„¶ã¾ã¨ã¾ã‚Šã¾ã›ã‚“ãŒã„ã¤ã‹ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ã¦AquaSKKã‚„FlickSKKã«å–ã‚Šè¾¼ã¾ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã®ã§ãã®æ™‚ã«ã¯è£ã§ã“ã®LispãŒå‹•ã„ã¦ã‚‹ã‹ã‚‚ã¨æ€ã„å‡ºã—ã¦ã‚ã’ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Clojureã§Reactive Messaging Pattern</title>
      <link>/post/ClojuredeReactive_Messaging_Pattern/</link>
      <pubDate>Sat, 19 Dec 2015 22:30:19 +0900</pubDate>
      
      <guid>/post/ClojuredeReactive_Messaging_Pattern/</guid>
      <description>

&lt;p&gt;ã“ã®ã‚¨ãƒ³ãƒˆãƒªã¯&lt;a href=&#34;http://qiita.com/advent-calendar/2015/clojure&#34;&gt;Clojure Advent Calendar 2015&lt;/a&gt;ã®16æ—¥ç›®ã®è¨˜äº‹ã§ã™ï¼ˆå¤§é…åˆ»ï¼‰&lt;/p&gt;

&lt;p&gt;Îºeenã§ã™ã€‚ã“ã“ã®ã¨ã“ã‚ä½“èª¿å„ªã‚Œãšã€ã¾ãŸã€ç‰¹ã«é¢ç™½ã„ãƒã‚¿ã‚‚ãªãClojure Advent Calendarã«é…åˆ»ã—ãŸã“ã¨ã‚’ãŠè©«ã³ç”³ã—ä¸Šã’ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ä»Šæ—¥ã¯Reactive Messaging Patternã‚’Clojureã®core.asyncã§ã‚„ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚Reactive Messaging Pattersã¯ã€Java/Scalaå‘ã‘Actorã‚·ã‚¹ãƒ†ãƒ ã®&lt;a href=&#34;http://akka.io/&#34;&gt;Akka&lt;/a&gt;ã®ä½œè€…ãŒè‘—ã—ãŸæœ¬ã€&lt;a href=&#34;http://www.amazon.co.jp/Reactive-Messaging-Patterns-Actor-Model-ebook/dp/B011S8YC5G&#34;&gt;Amazon.co.jp: Reactive Messaging Patterns with the Actor Model: Applications and Integration in Scala and Akka&lt;/a&gt;ã§æ›¸ã‹ã‚Œã¦ã„ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;éå¸¸ã«èˆˆå‘³æ·±ã„æœ¬ãªã®ã§ã™ãŒScalaåŠã³Akkaåˆå¿ƒè€…ã®ç§ã«ã¯ä¸­ã€…è¾›ã„ã®ã§ä¸€æ—¦Clojureã§è©¦ã—ã¦ã¿ã‚ˆã†ã‹ã¨ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã“ã‚ã§ã€Akkaã¨Clojureã®core.asynkã«ã¯è‹¥å¹²ã®ãƒ¢ãƒ‡ãƒ«ã®é•ã„ãŒã‚ã‚Šã¾ã™ã€‚è©³ã—ãã¯&lt;a href=&#34;http://blog.paralleluniverse.co/2015/05/21/quasar-vs-akka/&#34;&gt;ã“ã“&lt;/a&gt;ã¨ã‹ã«ã‚ã‚‹ã®ã§ã™ãŒã€ä¸€ç•ªå¤§ããã¯éåŒæœŸ/åŒæœŸãƒ¢ãƒ‡ãƒ«ã®é•ã„ãŒã‚ã‚Šã¾ã™ã€‚
Akkaã®å ´åˆã¯Actorã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã£ã¦ã‚‚å±Šã„ãŸã¨ã„ã†ä¿éšœã¯ãªã(ã€Œãã®ç¬é–“ã«ã€å±Šã„ã¦ãªã„ã ã‘ã§ãªãã€å±Šãå‰ã«ActorãŒå†èµ·å‹•ã—ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãƒ­ã‚¹ãƒˆã—ã¦ã—ã¾ã†!)ã€ã¾ãŸã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å—ä¿¡ã‚‚&lt;code&gt;receive&lt;/code&gt;ã¨ã„ã†ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨æ„ã—ã¦ãã“ã§ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã†ã„ã†é•ã„ãŒã‚ã‚‹ä¸­ã§ã©ã‚Œã ã‘Clojureã«ç¿»è¨³å‡ºæ¥ã‚‹ã‹å¤šå°‘ä¸å®‰ã§ã™ãŒãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã™ã€‚å°šã€åŸæ›¸ã«ã¯æ§˜ã€…ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã®ã§ã™ãŒæµçŸ³ã«æœ¬ä¸€å†Šåˆ†å…¨éƒ¨ã¯ç´¹ä»‹ã—åˆ‡ã‚Œãªã„ã®ã§é¢ç™½ãã†ã§ã‹ã¤Clojureã§ã‚‚å½¹ç«‹ã¡ãã†ãªã‚‚ã®ã ã‘ç´¹ä»‹ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã¯åŸæ›¸ã®ã‚‚ã®ã‚’Clojureã«ç¿»è¨³ã—ãŸã‚‚ã®ã§ã¯ãªãã€ç§ãŒå‹æ‰‹ã«æ›¸ã„ãŸã‚‚ã®ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒã«ã™ã‚‹ã®ã¯é›°å›²æ°—ç¨‹åº¦ã«ç•™ã‚ã¦ã€å®Ÿéš›ã‚’çŸ¥ã‚ŠãŸã‹ã£ãŸã‚‰åŸæ›¸ã‚’èª­ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›ã€&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;(defproject reactive-message-patterns &amp;quot;0.1.0-SNAPSHOT&amp;quot;
  :description &amp;quot;FIXME: write description&amp;quot;
  :url &amp;quot;http://example.com/FIXME&amp;quot;
  :license {:name &amp;quot;Eclipse Public License&amp;quot;
            :url &amp;quot;http://www.eclipse.org/legal/epl-v10.html&amp;quot;}
  :dependencies [[org.clojure/clojure &amp;quot;1.7.0&amp;quot;]
                 [org.clojure/core.async &amp;quot;0.2.374&amp;quot;]])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã„ã†ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã§è©¦ã—ã¾ã—ãŸã€‚ã¾ãŸã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯&lt;a href=&#34;https://github.com/KeenS/reactive-message-patterns&#34;&gt;ã“ã¡ã‚‰&lt;/a&gt;ã§å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;messaging-with-actors:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Messaging With Actors&lt;/h1&gt;

&lt;h2 id=&#34;pipes-and-filters:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Pipes And Filters&lt;/h2&gt;

&lt;p&gt;ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ¥ã‚‹éš›ã«ã€ãã®ã¾ã¾å—ã‘å–ã‚‹ã®ã§ã¯ãªãä¸€æ—¦Filterç”¨ã®Actorã§å¤‰æ›ã‚„validationã‚’ã‹ã‘ã¦æœ¬å‡¦ç†ã«å…¥ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;del&gt;Clojureãªã‚‰&lt;code&gt;filter&amp;lt;&lt;/code&gt;/&lt;code&gt;filter&amp;gt;&lt;/code&gt;/ transducerã§ç¬æ®º&lt;/del&gt; Filterå‡¦ç†ã‚’Actorã«åˆ†é›¢ã™ã‚‹ã“ã¨ã§ä¸¦åˆ—æ€§ã‚„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ€§ãŒä¸ŠãŒã‚Šã¾ã™ã€‚åŸæ›¸ã®ä¾‹ã§ã¯ã¾ãšDecrypt Filterã‚’å™›ã¾ã›ã¦Authenticate Filterã§èªè¨¼å‡ºæ¥ãŸã‚‰ De-dup Filterã§é‡è¤‡ã‚’å–ã‚Šé™¤ã„ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã«ã—ã¦ã‹ã‚‰å‡¦ç†ã‚’å§‹ã‚ã‚‹ã€ã¨ã†ã„ã†ã‚ˆã†ã«éå¸¸ã«å®Ÿç”¨çš„ãªä¾‹ãŒå‡ºã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã¾ãŸã€(transformã§ãªãã€ç¯©ã„åˆ†ã‘ã®)Filterã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§Filterã—ãŸå¾Œã®å‡¦ç†ã€ä¾‹ãˆã°invalidãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ¥ãŸã‚‰ãƒ­ã‚°ã«å‡ºã™ãªã©ã®æŸ”è»Ÿæ€§ã‚’å¾—ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã™ã”ã„é©å½“ã§ã™ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ¥ãŸã‚‰ãã‚Œã‚’2å€ã™ã‚‹filterã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;(use &#39;clojure.core.async)

(defn filter-actor
  ([f]
   (let [in (chan)
         out (chan)]
     (do
       (filter-actor f in out)
       [in out])))
  ([f in out]
   (go-loop []
     (if-let [v (&amp;lt;! in)]
       (if-let [ret (f v)]
         (if (&amp;gt;! out ret)
           (recur)))
       (close! out)))))

(let [[in out] (filter-actor (fn [x] (* x 2)))]
  (go
    ;; producer
    (doseq [v (range 1 10)]
      (&amp;gt;! in v))
    (close! in))
  (go-loop []
    ;; consumer
    (if-let [v (&amp;lt;! out)]
      (do
        (println v)
        (recur))
      (close! out))))

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°¡å˜ã§ã™ã­ã€‚ãƒãƒ£ãƒãƒ«ãŒçµ‚ã‚ã£ãŸã‹ã©ã†ã‹èª¿ã¹ã‚‹ã®ã«ä¸€ã€…&lt;code&gt;if-let&lt;/code&gt;ã‚’ä½¿ã†ã®ãŒé¢å€’ã§ã™ãŒãƒªã‚¹ãƒˆã«å¯¾ã™ã‚‹å†å¸°é–¢æ•°ã‚‚ãã‚“ãªæ„Ÿã˜ãªã®ã§ã¾ã‚ã€ã“ã†ã„ã†ã‚‚ã‚“ãªã‚“ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ãã®ä»–:258416a532a86ac327ddeb3b653d90b7&#34;&gt;ãã®ä»–&lt;/h2&gt;

&lt;p&gt;ä»–ã«ã‚‚Messaging With Actorsã«ã¯Message Router, Message Translator, Message Endpointsãªã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¼‰ã£ã¦ã„ã‚‹ã®ã§ã™ãŒå‰²æ„›ã—ã¾ã™ã€‚ç‰¹ã«Message Translatorã¯å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã€MQ, SQLãªã©)ã¨ã®ã‚„ã‚Šã¨ã‚Šã®è©±ãªã®ã§ç°¡å˜ã«è©¦ã™ã«ã¯å°‘ã—é‡ã™ãã‚‹ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;messaging-channels:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Messaging Channels&lt;/h1&gt;

&lt;p&gt;ã“ã®ç« ã«ã¯ActoråŒå£«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚„ã‚Šã¨ã‚Šã®æ–¹æ³•ãŒè‰²ã€…æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚
Point-to-Point Channel, Publish-Subscribe Channel, Datatype Channel, Invalid Message Channel, Dead Letter Channel, Guaranteed Delivery, Channel Adapter, Message Bridge, Message Busã€‚
ä¸­ã€…å¤šãã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¼‰ã£ã¦ã„ã‚‹ã®ã§ã™ãŒä¸€éƒ¨ã¯Akkaå›ºæœ‰ã§ã‚ã£ãŸã‚ŠClojureã«ã¯å¿…è¦ãªã‹ã£ãŸã‚Šã—ã¾ã™ã®ã§ã€ç§ãŒèˆˆå‘³ã‚’æŒã£ãŸã‚‚ã®ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&#34;publish-subscribe:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Publish-Subscribe&lt;/h2&gt;

&lt;p&gt;å®šç•ªã§ã™ã­ã€‚æ¦‚å¿µè‡ªä½“ã®èª¬æ˜ã¯ä¸è¦ã¨æ€ã„ã¾ã™ã€‚core.asyncã ã¨ã©ã†ãªã‚‹ã®ã‹ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚&lt;code&gt;pub&lt;/code&gt;ã¨&lt;code&gt;sub&lt;/code&gt;ã‚’ä½¿ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;(let [publisher (chan)
      publication (pub publisher :topic)
      subscriber1 (chan)
      subscriber2 (chan)]
  (sub publication :delete subscriber1)
  (sub publication :create subscriber1)

  (sub publication :update subscriber2)
  (sub publication :read subscriber2)

  ;; start subscribers before publish start
  (go-loop [] (when-let [v (&amp;lt;! subscriber1)] (printf &amp;quot;I&#39;m One, got %s\n&amp;quot; (:type v)) (recur)))
  (go-loop [] (when-let [v (&amp;lt;! subscriber2)] (printf &amp;quot;I&#39;m Two, got %s\n&amp;quot; (:type v)) (recur)))

  (go (onto-chan publisher [{:topic :update, :type &amp;quot;dog&amp;quot;}
                            {:topic :create, :type &amp;quot;cat&amp;quot;}
                            {:topic :read  , :type &amp;quot;fox&amp;quot;}]))
  )
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãŠã‚‚ã¡ã‚ƒã®ã‚ˆã†ãªä¾‹ã§ã™ãŒã“ã‚Œã§å‹•ãã‚ˆã†ã§ã™ã€‚å› ã¿ã«åŸæ›¸ã§ã¯ã“ã“ã«çµæ§‹ãªãƒšãƒ¼ã‚¸æ•°ãŒå‰²ã‹ã‚Œã¦ã„ã¦ã€åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã‚’å¿µé ­ã«ã€ç•°ãªã‚‹ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹è©±ãªã©ã‚‚æ‰±ã£ã¦ã„ã¾ã™ã€‚core.asyncã ã¨ãã“ã¾ã§ã¯å‡ºæ¥ãã†ã«ãªã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;h2 id=&#34;invalid-message-channel:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Invalid Message Channel&lt;/h2&gt;

&lt;p&gt;ã¨ã‚ã‚‹Actorã«äºˆæœŸã—ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã„ãŸã‚‰ã©ã†ã—ã¾ã—ã‚‡ã†ã‹ã€‚ãã®ã¾ã¾æ¨ã¦ã¾ã™ã‹ï¼Ÿã‚‚ã—ã‹ã—ãŸã‚‰ãƒã‚°ã‚’æ½°ã›ã‚‹å¥½æ©Ÿã‹ã‚‚ã—ã‚Œãªã„ã®ã«ãã®ã¾ã¾æ¨ã¦ã‚‹ã«ã¯å‹¿ä½“ãªã™ãã¾ã™ã€‚
ã‹ã¨ã„ã£ã¦å…¨ã¦ã®Actorã«ãƒ‡ãƒãƒƒã‚°ç”¨ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦ã„ã¦ã¯åŸ’ãŒæ˜ã‹ãªã„ã©ã“ã‚ã‹ã‚³ãƒ¼ãƒ‰ãŒè¤‡é›‘åŒ–ã—ã¦ã—ã¾ã„ã¾ã™ã€‚ãã“ã§Invalid Massage Channelã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ã‚ã‚‹Actorã«äºˆæœŸã—ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã„ãŸæ™‚ã«ã€å…¨ã¦ã‚’æ”¾ã‚ŠæŠ•ã’ã‚‹ãƒãƒ£ãƒãƒ«ã‚’ç”¨æ„ã—ã¦ãŠã„ã¦ã€ãã®å…ˆã®Actorã§ãƒ­ã‚°ã‚’å‡ºã™ãªã‚Šã™ã‚‹ã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›ã¯&lt;code&gt;:price&lt;/code&gt;ã‚¿ã‚°ã®ã¤ã„ã¦ã„ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã„ãŸæ™‚ã«invalid actorã«æ”¾ã‚ŠæŠ•ã’ã€ãƒ­ã‚°ã‚’å‡ºã™ã‚‚ã®ã‚’ä½œã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;(defn invalid [data]
  {:data data
   :from (Thread/currentThread)})

(let [invalid-chan (chan)
      in (chan)
      tax 0.08]
  ;; invalid message processor
  (go-loop []
    (when-let [{data :data from :from} (&amp;lt;! invalid-chan)]
      (printf &amp;quot;invalid data %s from %s from\n&amp;quot; data from)
      (recur)))

  ;; main processing actor
  (go-loop []
    (when-let [v (&amp;lt;! in)]
      (if-let [price (:price v)]
        (printf &amp;quot;price: %f\n&amp;quot; (* price (+ 1 tax)))
        (&amp;gt;! invalid-chan (invalid v)))
      (recur)))

  (go (onto-chan in [{:goods &amp;quot;ã¯ã˜ã‚ã¦ã®Clojure&amp;quot;
                      :price 1900}
                     {:goods &amp;quot;ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°Clojure&amp;quot;
                      :price 3400}
                     {:goods &amp;quot;ã¸ã³&amp;quot;
                      :description &amp;quot;ã«ã‚‡ã‚ã«ã‚‡ã‚&amp;quot;}])))

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;from&lt;/code&gt;ã«ã¤ã„ã¦ã¯Actorãªã‚‰ã‚¢ã‚¯ã‚¿ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‘ã¦ä½•ã‹ã—ã‚‰ã®æƒ…å ±ã‚’ã¨ã‚Œã‚‹ã®ã§ã™ãŒ&lt;code&gt;go&lt;/code&gt;ã«å¯¾ã™ã‚‹ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒåˆ†ã‹ã‚‰ãªã‹ã£ãŸã®ã§ä»£ã‚ã‚Šã«ã‚¹ãƒ¬ãƒƒãƒ‰æƒ…å ±ã‚’ä½¿ã„ã¾ã—ãŸã€‚
ç§ã¯ã“ã®ç« ã‚’èª­ã‚“ã æ™‚ã«ã„ãŸãå®Œå‹•ã—ã¾ã—ãŸã€‚ãƒ­ã‚°ã®æ‰±ã„ã‚’é›†ç´„å‡ºæ¥ã‚‹ã—åœ°å‘³ã«IOã—ã¦éåŒæœŸãƒ¢ãƒ‡ãƒ«ã®ã‚¢ã‚¯ã‚¿ãƒ¼ã®é‚ªé­”ã«ãªã‚‹ãƒ­ã‚°ã‚’ãã‚Œãã‚Œã®ã‚¢ã‚¯ã‚¿ãƒ¼ã«æŒãŸãªãã¦æ¸ˆã‚€ã€‚
ã—ã‹ã—ã“ã‚Œã®ActorãŒè½ã¡ãŸã‚‰ã€ã¨ã‹ã“ã®Actorè‡ªèº«ã«invalidãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ¥ãŸã‚‰ã€ã¨ã‹è‰²ã€…è€ƒãˆãŸããªã‚Šã¾ã™ã€‚è©³ã—ãã¯åŸæ›¸ã‚’èª­ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ãã®ä»–-1:258416a532a86ac327ddeb3b653d90b7&#34;&gt;ãã®ä»–&lt;/h2&gt;

&lt;p&gt;ã“ã®ç« ã«ã¯ä»–ã«ã‚‚å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨é€£æºã™ã‚‹Message Adapterã€å¤–éƒ¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã¨é€£æºã™ã‚‹Message Bridgeã€è¤‡æ•°ã®ã‚·ã‚¹ãƒ†ãƒ é–“ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚„ã‚Šã¨ã‚Šã™ã‚‹Message Busãªã©ãŒè¼‰ã£ã¦ã„ã¾ã™ãŒå‰²æ„›ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;message-construction:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Message Construction&lt;/h1&gt;

&lt;p&gt;ã“ã®ç« ã«ã¯Command Message, Document Message, Event Message, Request-Reply, Return Address, Correlation Identifire, Message Sequence, Message Expiration, Format Indicatorãªã©ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è‡ªä½“ã«ã¾ã¤ã‚ã‚‹è©±é¡ŒãŒè¼‰ã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;del&gt;ç–²ã‚Œã¦ããŸãŸã‚&lt;/del&gt; Akkaã‚„Scalaç‰¹æœ‰ã®è©±é¡ŒãŒå¤šã„ã®ã§1ã¤ã ã‘ã«çµã‚Šã¾ã™ã€‚ã€‚ã¾ã‚ã€ã ã„ãŸã„Erlangã¨ã‹ã‚„ã£ã¦ãŸã‚‰è‡ªç„¶ã¨è¦šãˆã‚‹ã‚„ã¤ã‚‰ã§ã™ã€‚&lt;/p&gt;

&lt;h2 id=&#34;document-message:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Document Message&lt;/h2&gt;

&lt;p&gt;Command Messageã‚„Event Messageã¯è‰¯ãè¦‹ã¾ã™ãŒã€Document Messageã¨ã¯ã©ã®ã‚ˆã†ãªã‚‚ã®ã§ã—ã‚‡ã†ã‹ã€‚åŸæ›¸ã«ã¯ã“ã†æ›¸ã„ã¦ã‚ã‚Šã¾ã™&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Use a Document Message to convey information to a receiver, but without indicating how the data should be used.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ã€Œå—å–å´ã«æƒ…å ±ã‚’ä¼ãˆã¯ã™ã‚‹ãŒã€ãã®æƒ…å ±ãŒã©ã®ã‚ˆã†ã«æ‰±ã‚ã‚Œã‚‹ã¹ãã‹ã‚’æŒ‡ç¤ºã—ãªã„æ™‚ã«Document Messageã‚’ä½¿ã„ã¾ã™ã€Command Messageã«ä»˜éšã™ã‚‹æƒ…å ±ã§ã‚‚ãªãEvent Messageã«ä»˜éšã™ã‚‹æƒ…å ±ã§ã‚‚ãªããŸã å˜ãªã‚‹æƒ…å ±ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã¯ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ãƒ€ãƒ—ã‚¿ã®ã‚ˆã†ãªæ‰€ã§ä½¿ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;(let [db [{:id 1 :name &amp;quot;Aho&amp;quot;} {:id 2 :name &amp;quot;Ulman&amp;quot;} {:id 3 :name &amp;quot;Sethi&amp;quot;}]
      in (chan)]
  (go-loop []
    (when-let [[id return] (&amp;lt;! in)]
      (&amp;gt;! return (some #(when (= id (:id %) ) %) db))
      (recur)))

  (let [chan-cache (chan)]
    (go-loop [id 1]
      (&amp;gt;! in [id chan-cache])
      (when-let [res (&amp;lt;! chan-cache)]
        (println res)
        (recur (+ id 1))))))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¤‡æ•°ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã‚‹ã“ã¨ã‚’è€ƒãˆã‚‹ã¨åŒæ–¹å‘ãƒãƒ£ãƒãƒ«ãŒã‚ã‚‹ã‹ã‚‰ã¨ã„ã£ã¦ãã‚Œ1ã¤ã‚’ä½¿ã†ã®ã¯è‰¯ããªã„ã§ã—ã‚‡ã†ã€‚æ··ç·šã—ã¦ã—ã¾ã„ã¾ã™ã€‚ä»Šå›ã¯è¿”ä¿¡ç”¨ã®ãƒãƒ£ãƒãƒ«è‡ªèº«ã‚‚ä¸€ç·’ã«é€ã£ã¦ã—ã¾ã£ã¦ãã“ã«Documentã‚’è²°ã†ã“ã¨ã«ã—ã¾ã—ãŸã€‚
Actorãªã‚‰Actor ID(Ref)ã‚’é€ã‚‹ã“ã¨ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h1 id=&#34;message-routing:258416a532a86ac327ddeb3b653d90b7&#34;&gt;Message Routing&lt;/h1&gt;

&lt;p&gt;ã“ã®ç« ã¯ä¸»ã«Akkaã®ã‚¯ãƒ©ã‚¹ã‚¿ã€åˆ†æ•£å®Ÿè¡Œã«é–¢ã‚‹å†…å®¹ã§ã™ã€‚ãã‚Œè‡ªä½“éå¸¸ã«èˆˆå‘³æ·±ã„ã®ã§ã™ãŒClojureã ã¨è©¦ã›ãªã„ã®ã§é£›ã°ã—ã¾ã™ã€‚
ã¾ã‚ã€å®Ÿéš›ã«ã¯ã‚¯ãƒ©ã‚¹ã‚¿ã‚’çµ„ã¾ãªãã¦ã‚‚ã„ãã¤ã‹ã®actorã‚’ä½¿ã£ã¦actorç¾¤åŒå£«ã§ã‚„ã‚Šã¨ã‚Šã‚’ã™ã‚Œã°ã„ã„ã®ã§ã™ãŒæº–å‚™ãŒä¸­ã€…é¢å€’ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å¿œæ‰±ã‚ã‚Œã¦ã„ã‚‹ãƒˆãƒ”ãƒƒã‚¯ã‚’æ‹¾ã†ã¨Content Based Router, Message Filter, Dynamic Router, Recipient List, Splitter,
Aggregator, Resequencer, Composed Message Processor, Scatter-Gather, Routing-Slip, Process Manager, Message Brokerã§ã™ã€‚
è¦‹ã¦ã®é€šã‚Šéå¸¸ã«æ•°ãŒå¤šãã€ãƒšãƒ¼ã‚¸æ•°ã‚‚ã‹ãªã‚Šå‰²ã‹ã‚Œã¦ã„ã¾ã™ã€‚ãã—ã¦ã€ã‚ˆãä½¿ã„ãã†ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå¤šãè¼‰ã£ã¦ã„ã¾ã™ã€‚Scatter-Gatherã¨ã‹é‡ã„å‡¦ç†ã™ã‚‹æ™‚ã«ä½¿ã„ãã†ãªã‚“ã§ã™ã‘ã©ã­ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãªã©ãªã©:258416a532a86ac327ddeb3b653d90b7&#34;&gt;ãªã©ãªã©&lt;/h1&gt;

&lt;p&gt;ã“ã“ã¾ã§ã§ã€4~7ç« ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚åŸæ›¸ã¯10ç« ã¾ã§ç¶šãã¾ã™(1-3ç« ã¯ä½•æ•…ActorãŒå¿…è¦ãªã®ã‹ãªã©ã‚’å»¶ã€…èªã£ã¦ã¾ã™)ãŒç§ã¯ã“ã®è¾ºã§ç­†ã‚’ç½®ãã“ã¨ã«ã—ã¾ã™ã€‚ç¶šããŒæ°—ã«ãªã‚‹æ–¹ã¯åŸæ›¸ã‚’ãŠèª­ã¿ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;Advent Calendaré…åˆ»ã—ã¦å¤§å¤‰ç”³ã—åˆ†ã‘ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Clojureã§DSPã‚’ä½œã£ãŸè©±</title>
      <link>/slide/ClojuredeDSPwotsukuttahanashi/</link>
      <pubDate>Tue, 27 Oct 2015 21:04:20 +0900</pubDate>
      
      <guid>/slide/ClojuredeDSPwotsukuttahanashi/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Clojureã§DSPã‚’ä½œã£ãŸè©±
----------------------
Lisp Meet Up #3
&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™


# DSPã¨ã¯
--------

* Demand Side Platform
* åºƒå‘Šä¸»ã‹ã‚‰åºƒå‘Šã‚’é›†ã‚ã¦åºƒå‘Šã®è¡¨ç¤ºæ¨©ã‚’ç«¶ã‚Šè½ã—ã€é©åˆ‡ãªåºƒå‘Šã‚’å‡ºã™
  0. åºƒå‘Šä¸»ã‚’é›†ã‚ã¦
  1. ç«¶ã‚Šã®é€šçŸ¥ã‚’å—ã‘å–ã£ã¦
  2. ä¸€ç•ªã‚³ã‚¹ãƒ‘ãŒè‰¯ã•ãã†ãªåºƒå‘Šã‚’é¸ã‚“ã§
  3. å…¥æœ­ã—ã¦
  4. è½æœ­é€šçŸ¥ã‚’å—ã‘å–ã‚‹
  5. è½æœ­ã—ãŸã‚‰åºƒå‘Šã‚’å‡ºã™



# ã²ã¨ã‚ŠDSP
----------

* AdTech Studioã®æ–°å’ç ”ä¿®
* 2ãƒ¶æœˆé–“ã€æ¥­å‹™æ™‚é–“ã®20%ã‚’ä½¿ã£ã¦DSPã‚’ä½œã‚‹
  + å®Ÿè³ª8å–¶æ¥­æ—¥
* æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒç›®çš„
* æœ€å¾Œã«æ–°å’ã®ä½œã£ãŸDSPåŒå£«ã§ç«¶äº‰ã€åˆ©ç›ŠãŒå¾—ç‚¹ã«ãªã‚‹
* ä»–ã«ã¯æœ€çµ‚ç™ºè¡¨ã§ã®å¾—ç‚¹ã‚‚
* **ç ”ä¿®ãªã®ã§å¥½ãã«ã‚„ã£ã¦ã„ã„**
  + Clojureã§æ›¸ãã“ã¨ã«
* ã‚µãƒ¼ãƒãƒ¼ã®ä»–ã¯åºƒå‘Šä¸»ãƒ‡ãƒ¼ã‚¿ã¨å­¦ç¿’ç”¨ãƒ‡ãƒ¼ã‚¿ãŒä¸ãˆã‚‰ã‚Œã‚‹



&lt;iframe src=&#34;//www.slideshare.net/slideshow/embed_code/key/92I5tQt6q6IjII&#34; width=&#34;425&#34; height=&#34;355&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34; style=&#34;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&#34; allowfullscreen&gt; &lt;/iframe&gt; &lt;div style=&#34;margin-bottom:5px&#34;&gt; &lt;strong&gt; &lt;a href=&#34;//www.slideshare.net/prir/ss-35918532&#34; title=&#34;æ—¥æœ¬ã«ãŠã‘ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯å¸‚å ´ã¨ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ†ã‚¯äº‹æ¥­ã«ã¤ã„ã¦&#34; target=&#34;_blank&#34;&gt;æ—¥æœ¬ã«ãŠã‘ã‚‹ã‚¢ãƒ‰ãƒ†ã‚¯å¸‚å ´ã¨ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ†ã‚¯äº‹æ¥­ã«ã¤ã„ã¦&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href=&#34;//www.slideshare.net/prir&#34; target=&#34;_blank&#34;&gt;CyberAgent, Inc.&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;


# ä½œã‚‹ã‚‚ã®
---------

* ç«¶ã‚Šã®é€šçŸ¥ã‚’å—ã‘å–ã£ã¦å…¥æœ­ã™ã‚‹JSON REST API
* è½æœ­ã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹JSON REST API
  + å‰²ã¨ã‚·ãƒ³ãƒ—ãƒ«
* ã€Œä¸€ç•ªã‚³ã‚¹ãƒ‘ãŒè‰¯ã•ãã†ãªåºƒå‘Šã‚’é¸ã¶ã€éƒ¨åˆ†ã¯è‰²ã€…ã¨å·¥å¤«ã™ã‚‹
* ä»Šå›ã¯åºƒå‘Šã‚’å‡ºã™ã¨ã“ã‚ã¾ã§ã¯ã‚„ã‚‰ãªã„
* ã‚¯ãƒªãƒƒã‚¯æƒ…å ±ã¯è½æœ­é€šçŸ¥ã«å…¥ã£ã¦ã‚‹


# b11dã«ã¤ã„ã¦
-------------

* ä»Šå›ä½œã£ãŸDSP
* [KeenS/b11d](https://github.com/KeenS/b11d)
* Clojureè£½
* 5æ—¥ãã‚‰ã„ã§ä½œã£ãŸ
* ã‚ã¾ã‚Šã‚´ãƒ†ã‚´ãƒ†ã—ãªã„æ–¹é‡
  + ä»Šå›ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯ç„¡è¦–ã—ã¦ã„ã„
  + Clojureã«æ…£ã‚Œã¦ãªã„ã®ã§å­¦ç¿’ã‚³ã‚¹ãƒˆã‚‚æŠ‘ãˆãŸã„
* NginXã¨Appã¨MySQLæ§‹æˆ+Î±
* DBã¯ç¶ºéº—ã«è¨­è¨ˆã—ãŸã„
* 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¯ã«DBã‚’å¼•ãã«ã„ãç´ æ•µä»•æ§˜


# WAP
-----

* Compojure
* Sinatra likeãªã‚„ã¤
* ringã®ä¸Šã«ä¹—ã£ã‹ã¦ã‚‹
* ã‹ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ãªéƒ¨é¡ã ãŒJSON REST APIç¨‹åº¦ãªã‚‰ã“ã‚Œã§ååˆ†
* ringãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ã§JSONéƒ¨åˆ†ã‚‚æŠ½è±¡åŒ–
* å­¦ç¿’ã‚³ã‚¹ãƒˆãŒä½ã„ã®ã§æ°—è»½ã«å§‹ã‚ã‚‰ã‚Œã‚‹


# JSONãƒ©ã‚¤ãƒ–ãƒ©ãƒª
--------------

* ring.middleware.json/wrap-json-{body, response}
  + JSON-&gt;ãƒãƒƒãƒ—ã¨ãƒãƒƒãƒ—-&gt;JSON
  + bodyã®æ–¹ã¯ã‚­ãƒ¼ãŒStringã«ãªã‚‹ã®ãŒå¾®å¦™
    - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«ä»•æ–¹ãªã„
  + Content-Typeã‚’æŒ‡å®šã—ãªã„ã¨å‹•ã‹ãªã„ç½ 
* cheshire
  + äº‹å‰ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã®ã«ä½¿ã£ãŸ
  + ringã®JSONãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ä¾å­˜ãªã®ã§ãã®ã¾ã¾ä½¿ã£ãŸ
  + è‡ªç„¶ã§ä½¿ã„æ˜“ã„API


# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
----------------

* java.jdbc
* JDBCã®Clojureå‘ã‘ãƒ©ãƒƒãƒ‘?
* DataSourceã‚’è‡ªåˆ†ã§æ¸¡ã™ã®ã§ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã‚‚ç°¡å˜
* SQLæ‰‹æ›¸ãã—ãŸã‚‰è‰¯ã„æ„Ÿã˜ã«ãƒãƒƒãƒ—ã‚’è¿”ã—ã¦ãã‚Œã‚‹
* Storeã¯ã‚«ãƒ©ãƒ ã¨å€¤ã®å¯¾å¿œã‚’æ‰‹æ›¸ã
* ä¾¿åˆ©ãƒã‚¯ãƒ­ã‚‚ã„ãã¤ã‹


# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
----------------

* eager loadingé¢å€’å•é¡Œ
  + å…¥ã‚Œå­ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜ã™ã‚‹æ–¹ã‚‚é¢å€’ã ã£ãŸ
  + ORMã®ä¾¿åˆ©ã•ã‚’å®Ÿæ„Ÿã€‚
* bulk inserté›£ã—ã„å•é¡Œ
  + å®Ÿè¡Œæ™‚å¯å¤‰é•·å¼•æ•°é›£ã—ã„
* ORMã¯XXXã‚’ä½¿ã†ã‹Javaã®ã‚„ã¤ã‚’ãã®ã¾ã¾ä½¿ã†?
* Javaã¯XMLã•ãˆæˆ‘æ…¢ã™ã‚Œã°å‰²ã¨è‰¯ã„å¥´æƒã£ã¦ã‚‹
* ã—ã‹ã—ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ãƒãƒƒãƒ—ã§æ¬²ã—ã„ã‹ã‚‚


# é‹ç”¨
-----

* warã«å›ºã‚ã¦Tomcat vs ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãªfat jar
* ä»Šå›ã¯fat jarã‚’é¸æŠ
* ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ã ã¨supervisordã¨ã‹ã§ã®ç®¡ç†ãŒæ¥½
* Tomcatã®é‹ç”¨çµŒé¨“ãŒãªã„
* Jettyä¸­ã€…å„ªç§€ã‚‰ã—ã„
* jstatã‚’ä½¿ã£ã¦Mackerelã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–ã£ãŸ


# éåŒæœŸåŒ–
---------

* core.async/goã§æ‰‹è»½ã«éåŒæœŸ
* DBã¸ã®æ›¸ãè¾¼ã¿ã‚’éåŒæœŸã«ã—ãŸ
* DBæ›¸ãè¾¼ã¿ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã‚‚500ã«ãªã‚‰ãªã„ææ€–
* æœ€åˆã®æ–¹ã§æ”¯æ‰•ã„ã‚’è¨˜éŒ²å‡ºæ¥ã¦ãªãã¦äºˆç®—ç®¡ç†ãŒæ­»äº¡
  + äºˆç®—ç®¡ç†å¤±æ•—ãƒšãƒŠãƒ«ãƒ†ã‚£ã§ã€å¤§åˆ†ç‚¹æ•°å¼•ã‹ã‚ŒãŸã‚‰ã—ã„
* goroutineã§ã®ä¾‹å¤–å‡¦ç†ã©ã†ã‚„ã‚‹ã‚“ã ã‚ã†ã€‚


# é–‹ç™ºç’°å¢ƒ
---------

* nREPL + Emacs + CIDER
* è£œå®Œã®è¨­å®šä¸Šæ‰‹ãã„ã‹ãªã‹ã£ãŸ
* è«¸ã€…åœ°å‘³ã«ä¸ä¾¿
* èµ·å‹•é…ã„
* Emacså´ã‹ã‚‰nREPLç«‹ã¡ä¸Šã’ãŸã„
* ã‚µãƒ¼ãƒãƒ¼ã®ãƒ©ã‚¤ãƒ–ãƒªãƒ­ãƒ¼ãƒ‰æ¬²ã—ã„
* æ­£è§£ãŒæ¬²ã—ã„



# ãã®ä»–Clojureã«ã¤ã„ã¦
---------------------

* ã‚³ãƒ³ã‚¹ã®Carã‚’å–ã‚‹ã®ã«`hd`ã‹`head`ã‹`car`ã‹åˆ†ã‹ã‚“ãªã‹ã£ãŸ
  + çµå±€ã©ã‚Œã§ã‚‚ãªãã¦`first`ã ã£ãŸ
* å¼•æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãŒä¾¿åˆ©
  + JSON REST APIã ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ä½•ã‚’æœŸå¾…ã—ã¦ã‚‹ã®ã‹åˆ†ã‹ã‚Šã¥ã‚‰ã„
  + ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ãªã‚‹
* ã‚„ã£ã±Javaã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ãˆã‚‹ã®ä¾¿åˆ©


# è½ç©‚æ‹¾ã„
---------

* ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
  + ãŠå®¶èŠ¸
* ã€Œä¸€ç•ªã‚³ã‚¹ãƒ‘ãŒè‰¯ã•ãã†ãªåºƒå‘Šã‚’é¸ã‚“ã§å…¥æœ­ã€ã§çµ±è¨ˆã‹æ©Ÿæ¢°å­¦ç¿’ãŒå¿…è¦
  + 1å›è¡¨ç¤ºã—ãŸæ™‚ã®åç›Šã®æœŸå¾…å€¤ã‚’è¨ˆç®—ã™ã‚‹
* ä»Šå›ã¯äº‹å‰ãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆã‚’ä½¿ã£ãŸ
  + ç†æƒ³çš„ã«ã¯æ©Ÿæ¢°å­¦ç¿’ã€‚æ™‚é–“å¤‰åŒ–ã«ã¤ã„ã¦ã„ã‘ã‚‹
* In Appã§ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å­¦ç¿’å‡ºæ¥ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ€ã£ãŸã‚ˆã‚Šãªã„
  + åˆ†æ•£å‡¦ç†å‘ã‘ã®å¤§è¢ˆè£Ÿãªã®ãŒå¤šã„
  + Weka? liblinear-java?
* å¾Œã§è€ƒãˆãŸã‚‰Incanterä½¿ãˆã°ã‚ˆã‹ã£ãŸ


# ã¾ã¨ã‚
-------

* çµ¦æ–™è²°ã„ãªãŒã‚‰Lispæ›¸ã„ãŸ
* Clojureã§DSPä½œã£ãŸ
* Clojureã§æ©Ÿæ¢°å­¦ç¿’ã—ãŸã‹ã£ãŸã‘ã©é–“ã«åˆã‚ãªã‹ã£ãŸ


# å‚è€ƒ
------

* [Internal of b11d | Îºeenã®Happy HacÎºing Blog](//KeenS.github.io/slide/Internal_of_b11d/)

&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Internal of b11d</title>
      <link>/slide/Internal_of_b11d/</link>
      <pubDate>Mon, 19 Oct 2015 21:33:00 +0900</pubDate>
      
      <guid>/slide/Internal_of_b11d/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Internal of b11d
----------------------
ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ–°å’ç ”ä¿®  
ã²ã¨ã‚ŠDSPæœ€çµ‚ç™ºè¡¨ä¼š

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + AMoAdã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼ˆï¼Ÿï¼‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + è¶£å‘³ã§Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™
 + ä»•äº‹ã§Scalaã¨Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™


# ä»Šå›ä½œã£ãŸã‚‚ã®
----------------

* b11d (ã¶ã‚‰ã£ãã‚“ã©ã”ãƒ¼ã‚‹ã©)
* Clojure (compojure + middleware)è£½
  + + NginX + MySQL + Supervisord
* å‡ºæ¥ã‚‹é™ã‚Šã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹ã‚ˆã†ã«ä½œã£ãŸ
  + 310è¡Œ
* ãƒ‡ãƒ—ãƒ­ã‚¤ãã®ä»–ã¯ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
* ç›£è¦–ã¯mackerel


# ã‚·ãƒ³ãƒ—ãƒ«ã¨ã„ã†ã“ã¨
-------------------

* ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯çŠ¶æ…‹ã‚’æŒãŸãªã„
* IOä»¥å¤–å‰¯ä½œç”¨ã‚’æŒãŸãªã„
* ã¤ã¾ã‚Šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æŒãŸãªã„
  + ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸Šã®æ„å‘³ã—ã‹ãªã„
  + æ—©éãã‚‹æœ€é©åŒ–ã¯è«¸æ‚ªã®æ ¹æº
* ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆãŒå®¹æ˜“
* compojureã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ä¸Šæ‰‹ãä½¿ã£ãŸ


# ã‚·ãƒ³ãƒ—ãƒ«ã¨ã„ã†ã“ã¨2
--------------------

* ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã ã„ãŸã„ç¬¬4æ­£è¦å½¢ï¼ˆï¾€ï¾Œï¾ï¾ï¼‰
  + å…¨ã¦ã®ã‚«ãƒ©ãƒ ã¯`NOT NULL`
  + åºƒå‘Šä¸»ã®æ‰€ã ã‘æ‹¡å¼µæ€§ã‚’æŒãŸã›ã‚‹ãŸã‚ã«ç¬¬1æ­£è¦å½¢ã«è½ã¨ã—ãŸ
  + 1åºƒå‘Šä¸»ã«å¯¾ã—ã¦è¤‡æ•°ã®åºƒå‘ŠãŒæŒã¦ã‚‹ã‚ˆã†ã«ãªã‚‹
* å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚‚å…¨éƒ¨ä»˜ã‘ã‚‹
* ãƒ‡ãƒ¼ã‚¿ãŒç¶ºéº—ãªã®ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã®ã‚„ã‚‹ã“ã¨ãŒå°‘ãªã„
* åˆ†æã™ã‚‹æ™‚ã«ã‚‚æ´»ãã‚‹ç­ˆ


# ãƒ‡ãƒ—ãƒ­ã‚¤
---------

* å…¨ã¦ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å‡ºæ¥ã‚‹
* æ‰‹ä½œæ¥­ã‚’ç„¡ãã—ã¦ãƒŸã‚¹ã‚’ç„¡ãã™
  + ã€Œã‚ã‚Œï¼Ÿè¨­å®šæ›¸ãæ›ãˆãŸã®ã«åæ˜ ã•ã‚Œã¦ãªã„ã€ â†’ ã€Œå†èµ·å‹•å¿˜ã‚Œã¦ãŸã€ã¨ã‹ã‚’é˜²ã
* â˜†ç§˜ä¼â˜†ã®ã‚·ã‚§ãƒ«ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯æº€è¼‰ï¼ 
* ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ1jarã«åã¾ã‚‹ã®ã§ãƒ‡ãƒ—ãƒ­ã‚¤ãŒæ¥½ã€‚


# ç›£è¦–
------

* mackerelã§è‰²ã€…ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
* Linux, NginX, MySQL, JVM, ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
* ã»ã¨ã‚“ã©Mackerelã«ä¹—ã£ã‹ã‚‹ã“ã¨ã§æœ¬è³ªçš„ã§ãªã„ã“ã¨ã«åŠ´åŠ›ã‚’å‰²ã‹ãªã„
  + æœ¬è³ª = æ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç†è§£ã™ã‚‹ã“ã¨
* ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­»æ´»ç›£è¦–ã«ã¯supervisord
  + æœ¬å½“ã¯systemdã§ã‚„ã‚ŠãŸã‹ã£ãŸã‘ã©Ubuntuã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã‹ã£ãŸ


# è½ç©‚æ‹¾ã„
----------

* DBã¸ã®æ›¸ãè¾¼ã¿ã¯éåŒæœŸã€‚Clojureãªã‚‰ç°¡å˜ã«æ›¸ã‘ã‚‹
  + `(go ...)` ã§å›²ã‚€ã ã‘
* ã ã„ãŸã„1700qpsã€‚ãƒ‡ãƒ¼ã‚¿ãŒå¢—ãˆã‚‹ã¨å¤šåˆ†ã‚‚ã†ã¡ã‚‡ã„ä¸‹ãŒã‚‹ã€‚
  + ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã«ä¾å­˜ã—ãªã„é€Ÿåº¦ã€‚ã‚‚ã†å°‘ã—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚‚å‡ºã‚‹ã€‚
* ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒã«ã¯çµ„è¾¼ã¿jettyã‚’ä½¿ã£ãŸã€‚
  + War + Tomcatã§ã‚‚å‡ºæ¥ã‚‹ãŒãƒ‡ãƒ—ãƒ­ã‚¤/é‹ç”¨ãŒæ¥½ãªã®ã§ã“ã¡ã‚‰ã‚’æ¡ç”¨
* ã‚³ã‚¢æ•°ã«å¯¾ã—ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã®ã§ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã‚‚å‡ºæ¥ã‚‹
* CTRäºˆæ¸¬ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’ åºƒå‘Šä¸»xã‚µã‚¤ãƒˆxUA ã§çµ±è¨ˆã‚’å–ã£ã¦ä½¿ã†
  + é€”ä¸­ã‹ã‚‰ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã§å¤‰åŒ–ã‚’ã¤ã‘ã‚‹


# æ”¹å–„ç‚¹ã¨ã‹ä»Šå¾Œã¨ã‹
---------

* win rate, å…¥æœ­/è½æœ­ä¾¡æ ¼, CTRã¨ã‹ã‚’mackerelã§ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã—ãŸã‹ã£ãŸ
* ç®¡ç†ç”»é¢çš„ãªã®å¿…è¦ï¼Ÿ
* ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãƒˆãƒ©ãƒ¬ãƒ³ã‚¹æ€§ã¯ãªã„ã®ã§ãã®è¾º
  + MySQLãŒæ­»ã¬ã¨ãƒ¤ãƒã„ã€‚
* ãƒ›ãƒƒãƒˆãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‹ã£ãŸ
* æŠ˜è§’JVMã ã—æ©Ÿæ¢°å­¦ç¿’ã—ãŸã‹ã£ãŸ
* Unix Domain Socketä½¿ã†ã®å¿˜ã‚Œã¦ãŸ
* ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å…¥ã‚Œã‚‹ã®å¿˜ã‚Œã¦ãŸâ€¦â€¦â€¦orz

&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>ãƒã‚¯ãƒ­ã«ã¤ã„ã¦æ•´ç†ã—ã¦ã¿ã‚‹</title>
      <link>/post/makuronitsuiteseirishitemiru/</link>
      <pubDate>Sat, 04 Jul 2015 15:34:46 +0900</pubDate>
      
      <guid>/post/makuronitsuiteseirishitemiru/</guid>
      <description>

&lt;p&gt;ä½•æ•…LisperãŒãƒã‚¯ãƒ­ã«ã¤ã„ã¦èªã‚‹ã®ã‹ã€‚Lisperã¨è­°è«–ã—ã¦ã¿ã¦ã‚‚æº€è¶³ã®ã„ãç­”ã‚’å¾—ãŸäººã¯ãã‚“ãªã«ã„ãªã„ã¨æ€ã†ã€‚
ãã‚Œã¯Lisperè‡ªèº«ä¾¿åˆ©ã¨ã¯æ€ã£ã¦ã„ã¦ã‚‚ä½•ãŒä¾¿åˆ©ãªã®ã‹ã‚’æ„è­˜ã—ã¦ãªãã¦ä»–äººã«ä¸Šæ‰‹ãèª¬æ˜å‡ºæ¥ãªã„ã‹ã‚‰ã˜ã‚ƒãªã„ã‹ã¨æ€ã£ãŸã€‚
ã¡ã‚‡ã£ã¨æ€ã„ã¤ã„ãŸç¯„å›²ã§ã¾ã¨ã‚ã¦ã¿ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;æœ€è¿‘ã§ã¯ãƒã‚¯ãƒ­ã‚·ã‚¹ãƒ†ãƒ ã‚’æŒã¤è¨€èªã¯çã—ããªã„ã€‚Rust, Scala, Template Haskell, Mirahãªã©ãªã©ã€‚æœ€åˆã«Common Lispã®ãƒã‚¯ãƒ­ã¨ä»–ã®è¨€èªã®ãƒã‚¯ãƒ­ã¨ã®é•ã„ã‚’å°‘ã—è€ƒãˆã¦ã¿ãŸã„ã€‚&lt;/p&gt;

&lt;h1 id=&#34;unless:791da514bc52e2606dbc134b8c6e6cf7&#34;&gt;Unless&lt;/h1&gt;

&lt;p&gt;ã¾ãšã€unlessã‚’ãƒã‚¯ãƒ­ã§æ›¸ãã“ã¨ã‚’è€ƒãˆã¦ã¿ãŸã„ã€‚å˜ç´”ã«ifã«notã‚’ã¤ã‘ã‚Œã°ã„ã„ã€‚&lt;/p&gt;

&lt;p&gt;Common Lispã§ã¯ã“ã†ãªã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(if (not foo-p)
    bar)

(defmacro unless (cond then)
  `(if (not ,cond)
       ,then))

(unless foo-p
  bar)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Rustã ã¨ã“ã†ãªã‚‹ã ã‚ã†ã‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-rust&#34;&gt;
if ! isFoo {
    bar;
}

macro_rules! unless {
    ($cond:expr, $then:stmt) =&amp;gt; {{
        if ! $cond {
            $then
        }
    }};
}

unless!(isFoo, {
    bar;
})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚ã‚‹ã„ã¯mirahã ã¨ã“ã†ãªã‚‹ã€‚unlessãŒäºˆç´„èªãªã®ã§_unlessã«ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;if ! isFoo
  bar
end

macro def _unless(cond, block:Block)
  quote{
    if ! `cond`
      `block.body`
    end
  }
end

_unless isFoo do
  bar
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¡ãªã¿ã«Cã ã¨ã“ã†å‡ºæ¥ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-C&#34;&gt;if(! is_foo)
  bar;

#define unless(cond) if(!(cond))

unless(is_foo)
  bar;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã•ã¦ã€ä¸Šã®ãƒã‚¯ãƒ­ãŸã¡ã‚’è¦‹æ¯”ã¹ã¦æ¬²ã—ã„ã€‚Common Lispã®ãƒã‚¯ãƒ­ã¨Cã®ãƒã‚¯ãƒ­ã¯é•å’Œæ„Ÿãªãæ–°ãŸãªåˆ¶å¾¡æ§‹é€ ã‚’ä½œã‚ŒãŸã®ã«å¯¾ã—ã¦Rustã¨Mirahã¯ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—ãŒå‰¥ãå‡ºã—ã«ãªã£ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§æ³¨æ„ã—ã¦æ¬²ã—ã„ã®ã¯Cã¯ã¨ã‚‚ã‹ãCommon Lispã€Rustã€Mirahã®ãƒã‚¯ãƒ­ã¯å…¨ã¦å¼•æ•°ã«å¿…è¦ãªæ§‹æ–‡æœ¨ã‚’ã¨ã£ã¦ãã®ã¾ã¾ç”¨æ„ã—ãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ã¦ã¯ã‚ã¦ã„ã‚‹ã ã‘ã ã€‚ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã«é•ã„ã¯ãªã„ã€‚
ä½•ãŒé•ã†ã‹ã¨ã„ã†ã¨ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—ã®æ§‹æ–‡ãŒåˆ¶å¾¡æ§‹é€ ã®æ§‹æ–‡ã¨åŒã˜ã‹é•ã†ã‹ã¨ã„ã†ç‚¹ã ã‘ã ã€‚ç§ã®çŸ¥ã‚‹ç¯„å›²ã§ã¯ãã®ã‚ˆã†ãªæ§‹æ–‡ã‚’ã—ãŸè¨€èªã¯Lispã—ã‹ãªã„ã€‚ã ã‹ã‚‰ã€ŒLispã®ã€ãƒã‚¯ãƒ­ãªã®ã ã€‚&lt;/p&gt;

&lt;p&gt;ã‚‚ã†ä¸€ã¤ã€‚ã©ã®ãƒã‚¯ãƒ­å®šç¾©ã‚‚ååˆ†ç›´æ„Ÿçš„ã«èª­ã‚ãŸã¨æ€ã†ã€‚ã“ã®ç¯„å›²ãªã‚‰ &lt;strong&gt;Så¼ã ã‹ã‚‰ãƒã‚¯ãƒ­ãŒç°¡å˜ã«ãªã‚‹ã¨ã„ã†ã“ã¨ã¯ãªã„&lt;/strong&gt; ã¨æ€ã†ã€‚åˆ¥ã«Så¼ã§ãªãã¦ã‚‚quasiquoteãŒã‚ã‚Œã°ååˆ†èª­ã¿æ˜“ã„ãƒã‚¯ãƒ­ãŒæ›¸ã‘ã‚‹ã€‚&lt;/p&gt;

&lt;h1 id=&#34;case:791da514bc52e2606dbc134b8c6e6cf7&#34;&gt;Case&lt;/h1&gt;

&lt;p&gt;caseã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’è€ƒãˆã‚ˆã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defun fun1 (x)
  (let ((y (case x
             ((:foo) (hoge &amp;quot;foo&amp;quot;))
             ((:bar) (hoge &amp;quot;bar!&amp;quot;)))))
    ...))


(defun fun2 (x)
 (let ((y (case x
            ((:foo) (hoge &amp;quot;foo&amp;quot;))
            ((:baz) (hoge &amp;quot;baz!&amp;quot;)))))
   ...))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã®ã‚ˆã†ã«ä¼¼ãŸã‚ˆã†ãªã€ã—ã‹ã—å¾®å¦™ã«é•ã†caseãŒå¿…è¦ã«ãªã£ãŸã‚ˆã†ãªæ™‚ã«å¿…è¦ã ã‚ã†ã€‚ã“ã®æ™‚ã€&lt;code&gt;&#39;(:foo (hoge &amp;quot;foo&amp;quot;) :bar (hoge &amp;quot;bar!&amp;quot;))&lt;/code&gt;ã®ã‚ˆã†ã«ãƒªãƒ†ãƒ©ãƒ«ã§ãã®ã¾ã¾æ›¸ã„ã¦ã—ã¾ã£ã¦ã¯æŠ½è±¡åŒ–ã™ã‚‹æ„å‘³ãŒãªããªã‚‹ã€‚ä¾‹ãˆã°ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«Key-Valueãƒšã‚¢ã‚’å…¥ã‚Œã¦å¿…è¦ãªæ™‚ã«å…¥ã‚ŒãŸã‚Šå‰Šé™¤ã—ãŸã‚Šã™ã‚Œã°ã‚ˆã„ã€‚ãã®ã‚ˆã†ãªãƒã‚¯ãƒ­ã¯ã“ã†æ›¸ã‘ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;(defmacro case-table (key hash)
  `(case ,key
     ,@(loop
          :for k :being :the :hash-key :of hash :using (hash-value v)
          :collect `((,k) ,v))))

(defparameter *table*)
(setf (gethash :foo *table*) &#39;(hoge &amp;quot;foo&amp;quot;))
(setf (gethash :bar *table*) &#39;(hoge &amp;quot;bar!&amp;quot;))

(defun fun1 (x)
  (let ((y (case-table x #.*table*)))
    ...))

(remhash :bar *table*)
(setf (gethash :baz &#39;(hoge &amp;quot;baz!&amp;quot;)))


(defun fun2 (x)
  (let ((y (case-table x #.*table*)))
    ...))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å—ã‘å–ã£ã¦ãƒªã‚¹ãƒˆã‚’è¿”ã™æ™®é€šã®loopãƒã‚¯ãƒ­ã®åŠ›ã‚’ãƒã‚¯ãƒ­å±•é–‹æ™‚ã«ã‚‚ä½¿ãˆã‚‹ã€‚ã¾ãŸã€ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯&lt;code&gt;&#39;(hoge &amp;quot;foo&amp;quot;)&lt;/code&gt;ãªã©ã®ãŸã ã®ãƒªã‚¹ãƒˆã‚’çªã£è¾¼ã‚“ã ãŒãã‚Œã‚’ãã®ã¾ã¾ASTã¨ã—ã¦ã‚‚ä½¿ã£ã¦ã„ã‚‹ã€‚
Common Lispã®ãƒã‚¯ãƒ­ã®ã‚‚ã†1ã¤ã®è‰¯ã„ã¨ã“ã‚ã¯ãƒã‚¯ãƒ­ã®å±•é–‹æ™‚ã«ã‚‚Common Lispã®æ©Ÿèƒ½ãŒãƒ•ãƒ«ã§ä½¿ãˆã‚‹ã¨ã“ã‚ã§ã‚ã‚Šã€ãƒã‚¯ãƒ­ã®å¼•æ•°ã«å—ã‘å–ã‚‹ã®ãŒæ§‹æ–‡æœ¨ã§ã‚ã‚Šãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚‚ã‚ã‚‹Så¼ãªã¨ã“ã‚ã ã€‚ã“ã“ã§ã¯ &lt;strong&gt;Så¼ã®åŒå›³åƒæ€§ãŒé‡è¦ãªãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã«ãªã£ã¦ã„ã‚‹&lt;/strong&gt; ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;(case-table x #.*table*)&lt;/code&gt; ã§ä½¿ã£ã¦ã„ã‚‹ &lt;code&gt;#.&lt;/code&gt; ã¯ &lt;em&gt;ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­&lt;/em&gt; ã¨ã„ã£ã¦ãƒã‚¯ãƒ­å±•é–‹(ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚)ã‚ˆã‚Šå‰(ãƒªãƒ¼ãƒ‰æ™‚ã€æ§‹æ–‡è§£ææ™‚)ã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã ã€‚ã“ã®ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã¯eval-when-readã¨ã„ã£ã¦ãƒªãƒ¼ãƒ‰æ™‚ã«
å€¤ã‚’è©•ä¾¡ã™ã‚‹ã€‚ãã®çµæœã€&lt;code&gt;case-table&lt;/code&gt;ã«æ¸¡ã‚‹ã®ãŒ &lt;code&gt;&#39;*table*&lt;/code&gt;ã¨ã„ã†ã‚·ãƒ³ãƒœãƒ«ã§ãªã&lt;code&gt;*table*&lt;/code&gt;ã«æŸç¸›ã•ã‚Œã¦ã„ã‚‹ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãªã‚‹ã€‚å› ã¿ã« &lt;em&gt;ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒã‚¯ãƒ­&lt;/em&gt; ã¨ã„ã†ãƒã‚¯ãƒ­å±•é–‹ãŒçµ‚ã‚ã£ãŸå¾Œã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã‚‚ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ãƒã‚¯ãƒ­1ã¤ã§ã¯ãªããƒã‚¯ãƒ­ã®å‰å¾Œã«å‹•ä½œã™ã‚‹ãƒã‚¯ãƒ­ã‚‚ã‚ã£ã¦ã“ãåˆã‚ã¦æŸ”è»Ÿæ€§ã‚’æ‰‹ã«ã—ã¦ã„ã‚‹ã€‚ã‚ã¾ã‚Šãã®ç‚¹ã¯è­°è«–ã•ã‚Œã¦ãªã„ã®ã§ã¯ãªã„ã ã‚ã†ã‹ã€‚&lt;/p&gt;

&lt;h1 id=&#34;common-lispã®è¨­è¨ˆ:791da514bc52e2606dbc134b8c6e6cf7&#34;&gt;Common Lispã®è¨­è¨ˆ&lt;/h1&gt;

&lt;p&gt;ã•ã¦ã€å„ã€…è¨€èªã«ã¯äºˆç´„èªã‚„~æ§‹æ–‡ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã¨æ€ã†ã€‚ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©æ§‹æ–‡ãªã©ã€‚Common Lispã«ã‚‚ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã¨ã„ã†åå‰ã§&lt;a href=&#34;http://www.lispworks.com/documentation/HyperSpec/Body/03_ababa.htm&#34;&gt;25&lt;/a&gt;å€‹å­˜åœ¨ã™ã‚‹ã€‚
é©šãã¹ãã“ã¨ã«ã€ã“ã“ã¾ã§ã«å‡ºã¦ããŸCommon Lispã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã¯3ã¤ã—ã‹å‡ºã¦ã“ãªã„ã€‚ifã¨letã¨quoteã ã€‚setfã‚„loopã€defunã€defmacroã€caseã€defparameterãªã‚“ã‹ã¯ãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;defunã¾ã§ãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¯ãƒ¦ãƒ¼ã‚¶ãŒãã®æ°—ã«ãªã‚Œã°é–¢æ•°å®šç¾©ã®æ§‹æ–‡ã«æ‰‹ã‚’å…¥ã‚ŒãŸã‚Šã‚‚å‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚
æ™®é€šã€ãã‚“ãªã“ã¨ã‚’ã—ãŸã‚‰é˜¿é¼»å«å–šã ãŒCommon Lispãªã‚‰å®‰å…¨ã«å‡ºæ¥ã‚‹ã€‚ãƒã‚¯ãƒ­ã‚‚ã‚·ãƒ³ãƒœãƒ«ã«æŸç¸›ã•ã‚Œã¦ã„ã‚‹ã®ã§æ–°ãŸã«ãƒã‚¯ãƒ­ã§ä¸Šæ›¸ãã—ãŸã‚·ãƒ³ãƒœãƒ«ã‚’åå‰ç©ºé–“ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãªã‘ã‚Œã°ä»Šã¾ã§é€šã‚Šã®defunã‚„loopãŒä½¿ãˆã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã‚‚ã†1ã¤ã€æ™®æ®µä½¿ã†ã‚‚ã®ãŒãƒã‚¯ãƒ­ã§å‡ºæ¥ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã¯ãƒã‚¯ãƒ­ã‚’è¢«ã›ã¦ãªã„æ©Ÿèƒ½ã¯ç›¸å½“ä½ãƒ¬ãƒ™ãƒ«ã ã¨ã„ã†ã“ã¨ã ã€‚ãƒã‚¯ãƒ­ã•ãˆæ›¸ã‘ã°å…¨ãæ–°ã—ã„è¨€èªæ©Ÿèƒ½ã‚’è¿½åŠ å‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã§ã‚ã‚Šã€ã‚ã‚‹ã„ã¯&lt;a href=&#34;http://cl21.org/&#34;&gt;å…¨ãæ–°ã—ã„è¨€èªã‚‚ä½œã‚Œã¦ã—ã¾ã†&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®ã‚ˆã†ãªè¨­è¨ˆã¯ãƒã‚¯ãƒ­ã§åˆ¶å¾¡æ§‹é€ ã¾ã§ã‚‚ä½œã‚Œã‚‹ã‹ã‚‰å‡ºæ¥ã‚‹ã®ã ã€‚é–¢æ•°å®šç¾©æ§‹æ–‡ã‚’ãƒã‚¯ãƒ­ã§å®šç¾©ã—ã¦ã„ã‚‹è¨€èªã¯Lispä»¥å¤–ã«ç§ã¯çŸ¥ã‚‰ãªã„ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨common-lisp:791da514bc52e2606dbc134b8c6e6cf7&#34;&gt;ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨Common Lisp&lt;/h1&gt;

&lt;p&gt;ã¨ã“ã‚ã§ã€ãƒã‚¯ãƒ­ã«é™ã‚‰ãªã„ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ãŸã„ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ããƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãã“ã¨ã ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å®Ÿè¡Œå½¢å¼ã«è‡³ã‚‹ã¾ã§ã®é–“ã«æ§˜ã€…ãªä¸­é–“å½¢å¼ã‹ã‚‰ä¸­é–“å½¢å¼ã«å¤‰æ›ã•ã‚Œã‚‹ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯ãã®ã©ã“ã‹ã®å½¢å¼ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã¨åŒç¾©ã«ãªã‚‹ã€‚é€šå¸¸ã€å‡¦ç†ç³»å†…éƒ¨ã§ä½¿ã†å½¢å¼ã¯å¤‰ãªã“ã¨ã‚’ã•ã‚Œã‚‹ã¨å›°ã‚‹ã®ã§ã‚ã¾ã‚Šå¤–éƒ¨ã«å…¬é–‹ã—ãŸããªã„ã€‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¨±ã™ã¨ã—ã¦ã‚‚æ§‹æ–‡è§£æãªã©ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«è¿‘ã„éƒ¨åˆ†ã«ãªã‚‹ã ã‚ã†ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹ãˆã°yaccã‚„lexã®ã‚ˆã†ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã€rubyã‚„Dã®ã‚ˆã†ãªæ–‡å­—åˆ—ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯å…¬é–‹APIã§ã‚ã‚‹ã¨ã“ã‚ã®ãƒ‘ãƒ¼ã‚µã ã‘ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§å®‰å…¨æ€§ã¯é«˜ã„ã€‚ã—ã‹ã—æ–‡å­—åˆ—ã ã‘ã ã¨æ§‹é€ ãŒãªã„ã®ã§æ›¸ãå´ã¯ã¤ã‚‰ã„ã€‚ä¸€å¿œã€Common Lispã«ã‚‚readé–¢æ•°ã¨evalé–¢æ•°ãŒã‚ã‚‹ã®ã§Common Lispã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰æ–‡å­—åˆ—ã‚’åã„ã¦readã—ã¦evalã™ã‚Œã°æ–‡å­—åˆ—ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯å‡ºæ¥ã‚‹ã€‚ç‰¹ã«å¬‰ã—ããªã„ã®ã§ã‚„ã‚‰ãªã„ãŒã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡ã¯ãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒã‚ã‚‹ã€‚Cã®ãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µãªã©ã€‚Common Lispã§ã‚‚ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã§å¯èƒ½ã ã€‚ä¾‹ãˆã°æ­£è¦è¡¨ç¾ãƒªãƒ†ãƒ©ãƒ«ã‚’ä½œã£ãŸã‚Šã¨ã‹ã®ä¾‹ãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡ã¯ASTãƒ™ãƒ¼ã‚¹ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒã‚ã‚‹ã€‚ãƒã‚¯ãƒ­ã ã€‚ã“ã‚Œã¯ä»Šã¾ã§è¦‹ã¦ããŸã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã‚ˆã‚Šå…ˆã¯ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã¯ã‚ã¾ã‚Šè¨€ã‚ãªã„æ°—ãŒã™ã‚‹ã€‚JITã¨å‘¼ã¶ã®ã§ã¯ãªã„ã‹ã€‚Common Lispã«ã‚‚evalé–¢æ•°ã‚„compileé–¢æ•°ãŒã‚ã‚‹ã‹ã‚‰ãã†ã„ã†ã“ã¨ã‚‚å‡ºæ¥ã‚‹ã€‚æ­£è¦è¡¨ç¾ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã‚“ã‹ãŒä½¿ã£ã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ç§ãŒè¨€ã„ãŸã„ã®ã¯Common Lispã«ã¯ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ©Ÿæ§‹ãŒä¸€æ¯ã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã¯ãªã„ã€‚read, eval, compileâ€¦ã€‚æ°—ä»˜ã„ãŸã‹ã‚‚ã—ã‚Œãªã„ãŒã€Lispã¯Lispè‡ªèº«ã§å‡ºæ¥ã¦ã„ã‚‹ã€‚
Lispã‚’æ›¸ãã¨ãã€Lispã‚’æ›¸ã„ã¦ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã—Lispã‚’æ§‹æˆã™ã‚‹Lispã‚’æ›¸ã„ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã„ãã‚‰ã§ã‚‚ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå‡ºæ¥ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã¾ã¨ã‚:791da514bc52e2606dbc134b8c6e6cf7&#34;&gt;ã¾ã¨ã‚&lt;/h1&gt;

&lt;p&gt;ä½•ã‚„ã‚‰Common Lispè³›ç¾æ­Œã«ãªã£ã¦ã—ã¾ã£ãŸãŒä¸€å¿œã¾ã¨ã‚ã¦ãŠãã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç°¡å˜ãªãƒã‚¯ãƒ­å®šç¾©ãªã‚‰Så¼ã§ã‚ã‚‹å¿…è¦ã¯ãªã„&lt;/li&gt;
&lt;li&gt;è¤‡é›‘ãªãƒã‚¯ãƒ­å®šç¾©ãªã‚‰Så¼ã§ã‚ã‚‹ã¨æ›¸ãæ˜“ã„ã€‚æã‚‰ãä»–ã®æ§‹æ–‡ã§ã‚‚æ›¸ã‘ãªã„ã“ã¨ã¯ãªã„ã€‚&lt;/li&gt;
&lt;li&gt;ãƒã‚¯ãƒ­å‘¼ã³å‡ºã—æ§‹æ–‡ã¯Så¼ã§ãªã„ã¨é‡å¤§ãªé•ã„ãŒã‚ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ãƒã‚¯ãƒ­ä»¥å¤–ã«ã‚‚ãƒªãƒ¼ãƒ‰ãƒã‚¯ãƒ­ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©ä»–ã®è¨€èªæ©Ÿèƒ½ãŒã‚ã£ã¦ã“ããƒã‚¯ãƒ­ãŒæ´»ãã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;è¨€èªæ©Ÿèƒ½ã ã‘ã§ãªããƒã‚¯ãƒ­ã‚’å‰æã¨ã—ãŸè¨­è¨ˆã‚‚é‡è¦ã§ã‚ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;Lispã¯Så¼ã§å‡ºæ¥ã¦ã„ã‚‹ä»¥å‰ã«Lispã§å‡ºæ¥ã¦ã„ã‚‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ã‚ãªãŸã®çŸ¥ã‚‰ãªã„Shebang</title>
      <link>/post/anatanoshiranaishebang/</link>
      <pubDate>Fri, 26 Jun 2015 23:24:44 +0900</pubDate>
      
      <guid>/post/anatanoshiranaishebang/</guid>
      <description>

&lt;p&gt;Îºeenã§ã™ã€‚æœ€è¿‘ã¯ä½•æ•…ã‹Blackå›ã£ã¦å‘¼ã°ã‚Œã¾ã™ã€‚Shebangã®æ›¸ãæ–¹ã«ã¯ã„ãã¤ã‹ã‚ã£ã¦ã€ãã‚Œã‚’åˆ©ç”¨ã—ãŸãµã¨é¢ç™½ã„æ–¹æ³•ã‚’æ€ã„ä»˜ã„ãŸã®ã§å…±æœ‰ã‚’ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ã”å­˜çŸ¥Shebangã¨ã„ãˆã°&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/sh
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã®ã‚ˆã†ã«ãƒ•ã‚¡ã‚¤ãƒ«ã®1è¡Œç›®ãŒ&lt;code&gt;#!&lt;/code&gt;ã‹ã‚‰å§‹ã¾ã£ã¦ã„ã‚‹ã¨ã‚·ã‚§ãƒ«ãŒãã‚Œä»¥é™ã®æ–‡å­—åˆ—ã‚’å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹åã¨ã—ã¦æœã—ã¦å®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§ã™ãŒã€å®Ÿã¯&lt;code&gt;#!&lt;/code&gt;ã¯å”¯ä¸€ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;#!&lt;/code&gt;ãŒãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã«ãªã‚‹å‰ãªã®ã‹ãã‚‚ãã‚‚ã‚·ã‚§ãƒ«ã«ã‚³ãƒ¡ãƒ³ãƒˆãŒãªã‹ã£ãŸæ™‚ä»£ã®ã‚‚ã®ãªã®ã‹ã¯çŸ¥ã‚Šã¾ã›ã‚“ãŒæ˜”ã¯&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;: /bin/sh
...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨&lt;code&gt;:&lt;/code&gt;ã§å§‹ã‚ã¦ã„ãŸã‚‰ã—ã„ã§ã™ã€‚å› ã¿ã«&lt;code&gt;:&lt;/code&gt;ã¯ã€Œä½•ã‚‚ã—ãªã„ã‚³ãƒãƒ³ãƒ‰ã€ã§ã™ã€‚å®Ÿè³ªçš„ã«ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æ‰±ã£ãŸã‚Šå‰¯ä½œç”¨ã®ã‚ã‚‹å¤‰æ•°å±•é–‹ã ã‘ã‚’è¡Œãªã£ãŸã‚Šãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã ã£ãŸã‚Šã®ç”¨é€”ã§ä½¿ã‚ã‚Œã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã•ã¦ã€ã‚·ã‚§ãƒ«ã¯å…¨ã¦æ–‡å­—åˆ—ãªã®ã§ã‚¯ã‚©ãƒ¼ãƒˆã—ã¦ã‚‚ã—ãªãã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã—ã¦ã‚‚ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ãã‚Œã¾ã™ã€‚ãªãœã‚ã–ã‚ã–ã‚¯ã‚©ãƒ¼ãƒˆã™ã‚‹ã‹ã¨ã„ã†ã¨&lt;a href=&#34;//KeenS.github.io/blog/2014/12/08/ge-tochu-li-xi-potaburunacommon-lispshi-xing-ke-neng-huairuwozuo-ru/&#34;&gt;å‰²ã¨å‡¦ç†ç³»ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªCommon Lispå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ | Îºeenã®Happy HacÎºing Blog&lt;/a&gt;ã®ã‚ˆã†ã«åˆ¥ã®è¨€èªã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹æ™‚ã«æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã«ãªã£ã¦ãã‚Œã‚‹ã¨å˜ç´”ã«ç„¡è¦–ã•ã‚Œã‚‹ã®ã§äº’æ›æ€§ãŒé«˜ã¾ã‚‹ã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§å®Œå…¨ç‰ˆãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªCommon Lispå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã†ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;

#|
run_if_exists(){
 command -v $1 &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exec &amp;quot;$@&amp;quot;
}
 run_if_exists cl &amp;quot;$0&amp;quot; &amp;quot;$@&amp;quot;
 run_if_exists sbcl --noinform --no-sysinit --no-userinit --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists clisp -norc --quiet --silent -on-error exit  &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ecl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists mkcl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists alisp -qq -#! &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ccl --no-init --quiet --batch --load &amp;quot;$0&amp;quot;  --eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 run_if_exists abcl --noinform --noinit --nosystem --batch --load &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists lisp -quiet -noinit -batch -load &amp;quot;$0&amp;quot; -eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 echo &amp;quot;No lisp implementation found&amp;quot;
 exit 1
|#

(write-line (lisp-implementation-type))
(force-output)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;abclã¨cclãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚ã‚ã¨CIMã‚‚æœã™ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚roswellã¯ä½œè€…ã«è¨Šã„ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ã¡ãªã¿ã«ã€shebangã®è§£é‡ˆã¯ã‚·ã‚§ãƒ«ã«ä¾å­˜ã™ã‚‹ã®ã§ã™ãŒã€B Shell, csh, tcsh, dash, Bash, zshã§å‹•ä½œç¢ºèªã—ã¾ã—ãŸã€‚å¤ã„æ©Ÿèƒ½ãªã®ã§æ–°ã—ã„ã‚·ã‚§ãƒ«ã»ã©åˆ‡ã‚Šæ¨ã¦ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã£ãŸã®ã§ã™ãŒBashã‚„zshãŒå¤§ä¸ˆå¤«ã ã£ãŸã®ã§è‰¯ã‹ã£ãŸã§ã™ã€‚
ä¸€å¿œéæ¨å¥¨ãªæ°—ãŒã—ã¾ã™ãŒã“ã‚Œã—ã‹æ–¹æ³•ãŒãªã„ã®ã§ä»•æ–¹ãªã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§ã¿ãªã•ã‚“ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ›¸ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h1 id=&#34;è¿½è¨˜:97aff0076544159c37193ad080a89d0a&#34;&gt;è¿½è¨˜&lt;/h1&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; shebangã®è§£é‡ˆã¯ã‚·ã‚§ãƒ«ã˜ã‚ƒãªãã¦OSã®exec()ãŒã‚„ã‚Šã¾ã™ã€‚ã§ã€#!ã‚„èªè­˜ã§ãã‚‹ãƒã‚¤ãƒŠãƒªä»¥å¤–ã¯ã€exec()ãŒã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ãŸå¾Œã§ã‚·ã‚§ãƒ«ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãªã‚‰ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦å®Ÿè¡Œã£ã¦ã‚„ã£ã¦ã¾ã™ã€‚ãªã®ã§å…ˆé ­ãŒ:ã®å ´åˆã¯(ç¶š&lt;/p&gt;&amp;mdash; Kilo Kawai (@anohana) &lt;a href=&#34;https://twitter.com/anohana/status/614551978526445570&#34;&gt;2015, 6æœˆ 26&lt;/a&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; shebangã¨ã—ã¦ã§ã¯ãªãã€ã‚·ã‚§ãƒ«ãŒã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã—ã¦èª­ã‚“ã§ã‚‹ã ã‘ãªã®ã§ã€ãã®å¾Œã«/bin/shã¨ã‹æ›¸ã„ã¦ã‚ã£ã¦ã‚‚é–¢ä¿‚ãªã„ã¯ãš (ã‚·ã‚§ãƒ«ã«ã‚ˆã£ã¦ã¯ãã“ã‚‚è¦‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒ)&lt;/p&gt;&amp;mdash; Kilo Kawai (@anohana) &lt;a href=&#34;https://twitter.com/anohana/status/614552151759589376&#34;&gt;2015, 6æœˆ 26&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§å®Ÿé¨“ã—ã¦ã¿ãŸã¨ã“ã‚ã€å…ˆé ­ã®&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;&lt;/code&gt;ã¯ã©ã®ã‚·ã‚§ãƒ«ã‚‚èª­ã¿é£›ã°ã™æ¨¡æ§˜(ã¤ã¾ã‚Šã€&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/usr/bin/ruby&amp;quot;&lt;/code&gt;ã¨æ›¸ã„ã¦ã‚‚rubyãŒå®Ÿè¡Œã•ã‚Œã‚‹è¨³ã§ã¯ãªã„)ã€‚&lt;/p&gt;

&lt;p&gt;ã§ã€å…ˆç¨‹ã® å®Œå…¨ç‰ˆã‹ã‚‰&lt;code&gt;&amp;quot;:&amp;quot; &amp;quot;/bin/sh&amp;quot;&lt;/code&gt;ã‚’å–ã‚Šé™¤ã„ã¦&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lisp&#34;&gt;#|
run_if_exists(){
 command -v $1 &amp;gt; /dev/null 2&amp;gt;&amp;amp;1 &amp;amp;&amp;amp; exec &amp;quot;$@&amp;quot;
}
 run_if_exists cl &amp;quot;$0&amp;quot; &amp;quot;$@&amp;quot;
 run_if_exists sbcl --noinform --no-sysinit --no-userinit --script &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists clisp -norc --quiet --silent -on-error exit  &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ecl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists mkcl -norc -q -shell &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists alisp -qq -#! &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists ccl --no-init --quiet --batch --load &amp;quot;$0&amp;quot;  --eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 run_if_exists abcl --noinform --noinit --nosystem --batch --load &amp;quot;$0&amp;quot; -- &amp;quot;$@&amp;quot;
 run_if_exists lisp -quiet -noinit -batch -load &amp;quot;$0&amp;quot; -eval &#39;(quit)&#39; -- &amp;quot;$@&amp;quot;
 echo &amp;quot;No lisp implementation found&amp;quot;
 exit 1
|#

(write-line (lisp-implementation-type))
(force-output)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¨ã—ã¦ã‚‚å‹•ã„ãŸã®ã§ã“ã‚ŒãŒæœ€çµ‚ç‰ˆã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å¤§å­¦ã®è¬›ç©¶ã§MINIXæœ¬ã‚„ã£ãŸã©ã“ã‚ã‹execã®ã¨ã“ã‚è‡ªåˆ†ã®æ‹…å½“ã ã£ãŸã®ã«æ¥ã‹ã—ã„ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Common Lispå‡¦ç†ç³»æ‹¡å¼µã®æ¢æ±‚ SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆ</title>
      <link>/slide/Common_Lispshorikeikakuchounotankyuu_SBCLnomaruchisureddosapo_to/</link>
      <pubDate>Sat, 20 Jun 2015 18:30:52 +0900</pubDate>
      
      <guid>/slide/Common_Lispshorikeikakuchounotankyuu_SBCLnomaruchisureddosapo_to/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
### Common Lisp å‡¦ç†ç³»æ‹¡å¼µã®æ¢æ±‚
SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆ

----------------------
Lisp Meet Up #29

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + æ¸‹è°·ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™

# CLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰
----------------------------
## [bordeaux-threads](https://trac.common-lisp.net/bordeaux-threads/wiki/ApiDocumentation)
* è‰²ã€…ãªå‡¦ç†ç³»ã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆã®æŠ½è±¡ãƒ¬ã‚¤ãƒ¤ãƒ¼
* ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰
  + ã‚¹ãƒ¬ãƒƒãƒ‰
  + ãƒ­ãƒƒã‚¯
  + ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãƒ´ã‚¡ãƒªã‚¢ãƒ«


# SBLCã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰

&lt;!-- .slide: class=&#34;center&#34; --&gt;


# SBLCã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰
----------------------------

* ã‚¹ãƒ¬ãƒƒãƒ‰
  + ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã‚¨ãƒ©ãƒ¼
* ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
  + CAS&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* æ’ä»–åˆ¶å¾¡ï¼ˆãƒ­ãƒƒã‚¯ï¼‰
* ã‚»ãƒãƒ•ã‚©
* ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãƒ´ã‚¡ãƒªã‚¢ãƒ«
* ãƒãƒªã‚¢
* ã‚­ãƒ¥ãƒ¼&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* ã‚²ãƒ¼ãƒˆ&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;
* frlock&lt;!-- .element: class=&#34;fragment highlight-red&#34; data-fragment-index=&#34;1&#34; --&gt;


# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ
----------------
è¤‡é›‘ãªå‹•ä½œã¯åŒã˜ãƒ‡ãƒ¼ã‚¿ã«ä¸¦è¡Œã«å‹•ã‹ã™ã¨å£Šã‚Œã†ã‚‹

```
        [var = 1]
[incf]      |      [decf]
 [1]&lt;-------|
  |         |------&gt;[1]
 [2]---&gt;[var = 2]    |
            |        | 
        [var = 0]&lt;--[0]
```

# ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œ
----------------

* `atomic-{incf, decf}`
  + å‹•ä½œå‡ºæ¥ã‚‹å ´æ‰€ãŒé™ã‚‰ã‚Œã¦ã„ã‚‹
* `atomic-{pop, push, update}`
  + CASãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ã‚Œã°ã©ã“ã§ã‚‚


# CASãƒ—ãƒ­ãƒˆã‚³ãƒ«
---------------
* compare and swap
* ã‚¢ãƒˆãƒŸãƒƒã‚¯æ“ä½œã®åŸºæœ¬ä¸­ã®åŸºæœ¬
  + ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ¬ãƒ™ãƒ«ã®ã‚µãƒãƒ¼ãƒˆ
* ã–ã£ãã‚Šè¨€ã†ã¨ä¸¦è¡Œç‰ˆsetf
* `(cas place old new env)`
  + ã‚‚ã—`place`ãŒ`old`ã«ç­‰ã—ã‘ã‚Œã°`new`ã‚’ä»£å…¥
* `(defun (cas foo) (old new))`
  + `cas`ç‰ˆã®`setf`å®šç¾©
* ä»–ã«ã‚‚`setf`ç›¸å½“ã®æ©Ÿèƒ½ã¯æƒã£ã¦ã‚‹

# CASãƒ—ãƒ­ãƒˆã‚³ãƒ«
---------------

```lisp
(defvar *foo* nil)

(defun (cas foo) (old new)
  (cas (symbol-value &#39;*foo*) old new))
```


# ã‚­ãƒ¥ãƒ¼
--------

* æ™®é€šã®ã‚­ãƒ¥ãƒ¼
* ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•
* `enqueue`, `dequeue`ãŒåŸºæœ¬æ“ä½œ
* `dequeue`ãŒå¤šå€¤ã§ã€ãƒ–ãƒ­ãƒƒã‚¯ã—ãªã„
  + ç©ºãªã‚‰ç¬¬äºŒå€¤ãŒnilã«ãªã‚‹


# ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹
---------------

* ã‚­ãƒ¥ãƒ¼ã¨ã»ã¼åŒã˜
* ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•
* `send-message`, `recieve-message`ãŒåŸºæœ¬æ“ä½œ
* `recieve-message`ã¯ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹
  + ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚‚è¨­å®šå‡ºæ¥ã‚‹
* `recieve-message-no-hangã¯dequeue`ã¨åŒã˜æŒ™å‹•
* `recieve-pending-messages`ã‚‚ã‚ã‚‹


# ã‚²ãƒ¼ãƒˆ
--------

* è¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ãŒ1ã¤ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å¾…ã¤æ™‚ã«ä½¿ã†
* `wait-on-gate`, `open-gate`, `close-gate`ãŒåŸºæœ¬æ“ä½œ


```
[gate (closed)]  [T1] [T2] [T3]
     |            |    |    |
     |     wait   |    |    |
     |&lt;----------------+----+
     |            |    .    .
     |     open   |    .    .
[gate (opened)]&lt;--+    .    .
     +----------------&gt;+---&gt;+
         go            |    |
                       V    V
```


# frlock
--------

* Fast Read Lock
* ã¾ãŸã®åã‚’Read-Write Lock
* Read Lockã¯å¤šé‡ã«å–ã‚Œã‚‹ã€‚Write Lockã¯1ã¤ã—ã‹å–ã‚Œãªã„ã€‚
* åŸºæœ¬æ“ä½œã¯`frlock-read`ã¨`frlock-write`
* æ™®é€šã®lockã¨é•ã£ã¦è¤‡æ•°ã®ReadãŒé€Ÿããªã‚‹


# ã¾ã¨ã‚
--------

* SBCLã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚µãƒãƒ¼ãƒˆã¯bordeaux-threadsã‚ˆã‚Šã‚‚ãƒªãƒƒãƒ
* å‡¦ç†ç³»ã®ç‹¬è‡ªã‚µãƒãƒ¼ãƒˆé¢ç™½ã„
* å‡¦ç†ç³»ã«ä¾å­˜ã—ã¦ã—ã¾ã£ã¦ã‚‚ã„ã„ã‚“ã˜ã‚ƒãªã„ã ã‚ã†ã‹
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Clojureã§OpenCV 3.0ã¨æˆ¯ã‚Œã‚‹</title>
      <link>/post/ClojuredeOpenCV3_0totawamureru/</link>
      <pubDate>Sun, 07 Jun 2015 16:56:51 +0900</pubDate>
      
      <guid>/post/ClojuredeOpenCV3_0totawamureru/</guid>
      <description>

&lt;p&gt;Îºeenã§ã™ã€‚å…ˆæ—¥OpenCV 3.0ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã­ã€‚
ã¡ã‚‡ã£ã¨è§¦ã£ã¦ã¿ã‚ˆã†ã¨æ€ã£ãŸã®ã§ã™ãŒå…¬å¼ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒC++ã€Cã€Javaã€Pythonã¨ä¸­ã€…ã¤ã‚‰ã„è¨€èªã°ã£ã‹ã‚Šãªã®ã§æ‰±ã„ã‚„ã™ã„Clojureã‹ã‚‰è§¦ã£ãŸæ™‚ã®ãƒ¡ãƒ¢ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;2ç³»ã¨ã¯APIãŒå¤‰ã‚ã£ã¦ã‚‹éƒ¨åˆ†ã‚‚ã‚ã‚‹ã‚‰ã—ãã€è‹¦åŠ´ã—ã¾ã—ãŸã€‚
Ubuntuã§ã‚„ã£ã¦ã‚‹ã®ã§Macã®äººã¯é©å½“ã«èª­ã¿æ›¿ãˆã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;h1 id=&#34;æº–å‚™:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;æº–å‚™&lt;/h1&gt;

&lt;h2 id=&#34;opencv:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;OpenCV&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://opencv.org/&#34;&gt;å…¬å¼&lt;/a&gt;ã‹ã‚‰OpenCV 3.0ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã¾ã—ã‚‡ã†ã€‚å±•é–‹ã—ã¦ã‹ã‚‰ã¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd opencv-3.0.0
$ cmake .
$ make -j4
$ sudo make -j4 install
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ã§ã—ã¦ãã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&#34;imshow:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;ImShow&lt;/h2&gt;

&lt;p&gt;ã©ã†ã‚‚3.0ã‹ã‚‰Highguiã¨ã„ã†Qtãƒ™ãƒ¼ã‚¹ã®GUIãƒ„ãƒ¼ãƒ«ç¾¤ã®Javaãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒä½œã‚‰ã‚Œãªããªã£ãŸãã†ã§ã™ã€‚Swingä½¿ãˆã¨ã€‚&lt;/p&gt;

&lt;p&gt;ã¨ã„ã†ã“ã¨ã§OpenCVã¨Swingã®ãƒ–ãƒªãƒƒã‚¸ã—ã¦ãã‚Œã‚‹è»½ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒ&lt;a href=&#34;https://github.com/master-atul/ImShow-Java-OpenCV&#34;&gt;ImShow-Java-OpenCV&lt;/a&gt;
ã§ã™ã€‚.javaãƒ•ã‚¡ã‚¤ãƒ«1æšãªã®ã§æœ¬å½“ã«è»½ã„ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;.jarã‚‚ãƒ¬ãƒã‚¸ãƒˆãƒªã«å…¥ã£ã¦ã‚‹ã®ã§ã™ãŒã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚ˆã‚Šå¤ã„ã‚‰ã—ãã€è‡ªåˆ†ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone git@github.com:master-atul/ImShow-Java-OpenCV.git
$ cd ImShow-Java-OpenCV/ImShow_JCV/src
$ javac com/atul/JavaOpenCV/Imshow.java
$ jar -cf Imshow.jar com/atul/JavaOpenCV/Imshow.class
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;lein-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;lein ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ&lt;/h2&gt;

&lt;p&gt;Clojureã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«ã®&lt;a href=&#34;http://leiningen.org/&#34;&gt;Leiningen&lt;/a&gt;ã‚’ä½¿ã„ã¾ã™ã€‚çŸ¥ã‚‰ãªã„äººã¯é©å½“ã«ã‚°ã‚°ã£ã¦ä¸‹ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ã¾ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ lein new opencv-play
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚“ã§ã€mavenã§ã„ã†ã¨ã“ã‚ã®pom.xmlã«ã‚ãŸã‚‹project.cljã‚’ã„ã˜ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd opencv-play
$ cat project.clj
(defproject opencv-play &amp;quot;0.1.0-SNAPSHOT&amp;quot;
  :description &amp;quot;FIXME: write description&amp;quot;
  :url &amp;quot;http://example.com/FIXME&amp;quot;
  :license {:name &amp;quot;Eclipse Public License&amp;quot;
            :url &amp;quot;http://www.eclipse.org/legal/epl-v10.html&amp;quot;}
  :dependencies [[org.clojure/clojure &amp;quot;1.6.0&amp;quot;]])
$ edit project.clj
$ cat project.clj
(defproject opencv-play &amp;quot;0.1.0-SNAPSHOT&amp;quot;
  :description &amp;quot;FIXME: write description&amp;quot;
  :url &amp;quot;http://example.com/FIXME&amp;quot;
  :license {:name &amp;quot;Eclipse Public License&amp;quot;
            :url &amp;quot;http://www.eclipse.org/legal/epl-v10.html&amp;quot;}
  :dependencies [[org.clojure/clojure &amp;quot;1.6.0&amp;quot;]
                 [cider/cider-nrepl &amp;quot;0.9.0-SNAPSHOT&amp;quot;]]
  :jvm-opts [&amp;quot;-Djava.library.path=./lib&amp;quot;]
  :resource-paths [&amp;quot;./lib/opencv-300.jar&amp;quot;
                   &amp;quot;./lib/Imshow.jar&amp;quot;]
  :injections [(clojure.lang.RT/loadLibrary org.opencv.core.Core/NATIVE_LIBRARY_NAME)])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãã—ãŸã‚‰å…ˆç¨‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªé”ã‚’é…ç½®ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ mkdir lib
$ cp /usr/local/share/OpenCV/java/* lib
$ cp /path/to/ImShow-Java-OpenCV/ImShow_JCV/src/Imshow.jar lib
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¤ã„ã§ã«lenaã‚‚å‘¼ã³ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ mkdir img
$ cp /path/to/src/of/opencv-3.0.0/samples/data/lena.jpg img
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;éŠã¶:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;éŠã¶&lt;/h1&gt;

&lt;p&gt;æº–å‚™å®Œäº†ã£ã¦ã“ã¨ã§REPLã‚’èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚ã¡ã‚‡ã£ã¨é…ã„ã§ã™ãŒæˆ‘æ…¢ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ lein repl
Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar 
Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/share/java/jayatanaag.jar 
nREPL server started on port 52301 on host 127.0.0.1 - nrepl://127.0.0.1:52301
REPL-y 0.3.5, nREPL 0.2.6
Clojure 1.6.0
Java HotSpot(TM) 64-Bit Server VM 1.8.0_25-b17
    Docs: (doc function-name-here)
          (find-doc &amp;quot;part-of-name-here&amp;quot;)
  Source: (source function-name-here)
 Javadoc: (javadoc java-object-or-class-here)
    Exit: Control+D or (exit) or (quit)
 Results: Stored in vars *1, *2, *3, an exception in *e

user=&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã®ã¾ã¾REPLã‚’ä½¿ã£ã¦ã‚‚ã„ã„ã§ã™ãŒç§ã¯Emacsã‹ã‚‰&lt;a href=&#34;https://github.com/clojure-emacs/cider&#34;&gt;CIDER&lt;/a&gt;ã§nREPLã«ã¤ãªãã¾ã™ã€‚
REPLã§ã‚‚è£œå®Œã¯åŠ¹ãã®ã§Emacsã‚„ã‚‰ã®ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®šãŒé¢å€’ãªã‚‰ã“ã®ã¾ã¾ã§ã‚‚ååˆ†ã§ã™ã‚ˆã€‚&lt;/p&gt;

&lt;p&gt;ã¾ãšã¯ç”»åƒã®ãƒ­ãƒ¼ãƒ‰ã‹ã‚‰ã€‚2ç³»ã¨ã¯é•ã£ã¦Imagecodecã‚’ä½¿ã†ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (import [org.opencv.imgcodecs Imgcodecs])
org.opencv.imgcodecs.Imgcodecs
user&amp;gt; (def lena (Imgcodecs/imread &amp;quot;img/lena.jpg&amp;quot;))
#&#39;user/lena
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã„ã˜ã‚‹å‰ã«è¡¨ç¤ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (import [com.atul.JavaOpenCV Imshow])
com.atul.JavaOpenCV.Imshow
user&amp;gt; (def is (Imshow. &amp;quot;Lena&amp;quot;))
#&#39;user/is
user&amp;gt; (.showImage is lena)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/images/clojure-opencv/show-lena.png&#34; alt=&#34;lena&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ã‚ˆã—ã‚ˆã—ã€‚è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã­ã€‚ã§ã¯ã“ã®è¾ºã‚’å‚è€ƒã«é¡”èªè­˜ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://qiita.com/woxtu/items/bf39e3d53cbf60396d2c&#34;&gt;Clojure - äºŒæ¬¡å…ƒçµµã®é¡”ã‚’æ¤œå‡ºã™ã‚‹ - Qiita&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ã¾ãšã¯å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (import [org.opencv.core Mat CvType])
org.opencv.core.CvType
user&amp;gt; (import [org.opencv.imgproc Imgproc])
org.opencv.imgproc.Imgproc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‰å‡¦ç†ã®ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«å¤‰æ›ã‹ã‚‰ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®å‡ä¸€åŒ–ã¾ã§ä¸€æ°—ã«ã‚„ã£ã¦ã—ã¾ã„ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (def buffer (Mat. 512 512 CvType/CV_8UC3))
#&#39;user/buffer
user&amp;gt; (Imgproc/cvtColor lena buffer Imgproc/COLOR_RGB2GRAY)
nil
user&amp;gt; (Imgproc/equalizeHist buffer buffer)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã“ã§ä¸€æ—¦ç”»åƒã®ç¢ºèªã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (.showImage is buffer)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;/images/clojure-opencv/gray-hist-lena.png&#34; alt=&#34;gray-hist-lena&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ãµã‚€ãµã‚€ã€‚ã§ã¯ã§ã¯é¡”ã‚’èªè­˜ã—ã¾ã™ã‹ã€‚&lt;/p&gt;

&lt;p&gt;ã¾ãšã¯è‰²ã€…æº–å‚™ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (import [org.opencv.core MatOfRect])
org.opencv.core.MatOfRect
user&amp;gt; (import [org.opencv.objdetect CascadeClassifier])
org.opencv.objdetect.CascadeClassifier
user&amp;gt; (def faces (MatOfRect.))
#&#39;user/faces
user&amp;gt; (def classifier (CascadeClassifier.))
#&#39;user/classifier
user&amp;gt; (.load classifier &amp;quot;/usr/local/share/OpenCV/haarcascades/haarcascade_frontalface_default.xml&amp;quot;)
true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å› ã¿ã«åˆ†é¡å™¨ã®ãƒ‡ãƒ¼ã‚¿ã®ãƒ­ãƒ¼ãƒ‰ã¯æˆåŠŸãŒtrueã§å¤±æ•—ãŒfalseã ãã†ã§ã™ã€‚ä¾‹å¤–æŠ•ã’ãªã„ã‚“ã§ã™ã­ã€‚ãƒãƒã£ãŸã€‚ãƒ‘ã‚¹åã«&lt;code&gt;~&lt;/code&gt;ã‚’ä½¿ã†ã¨(ãƒ›ãƒ¼ãƒ ã‚’çœç•¥è¡¨è¨˜ã™ã‚‹ã¨)ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã™ã‚‹ã‚ˆã†ãªã®ã§ãŠæ°—ã‚’ã¤ã‘ã¦ã€‚&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯å®Ÿè¡Œã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (.detectMultiScale classifier buffer faces)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã•ã¦ã€é¡”ã®ä½ç½®ãŒã¨ã‚ŒãŸã®ã§ç”»åƒã«é‡ã­ã‚‹ã®ã§ã™ãŒã“ã“ã§ã¯Swing(AWT)ã®æç”»ã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
OpenCVã®æç”»ã¯ç”»åƒã«æç”»ã™ã‚‹ã®ã§ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã—ã¦ã‚‚æ®‹ã£ã¦ã„ã‚‹ã®ã«å¯¾ã—ã¦Swingã®ã ã¨è¡¨ç¤ºã—ã¦ã„ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ã«æç”»ã™ã‚‹ã®ã§æ›¸ãå‡ºã—ãŸç”»åƒã«ã¯æ®‹ã‚Šã¾ã›ã‚“ã€‚ã¾ãŸã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã™ã‚Œã°æ¶ˆãˆã‚‹ã®ã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«å®Ÿé¨“ã™ã‚‹ã®ã«å‘ã„ã¦ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€æ—¦æº–å‚™ã€‚ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ãƒ¬ãƒŠã®å…ƒç”»åƒã«æˆ»ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (import [java.awt Rectangle Color])
java.awt.Color
user&amp;gt; (.showImage is lena)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Imshowã®Wndowã¨ã„ã†ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãªãƒ¡ãƒ³ãƒã«JFrameãŒå…¥ã£ã¦ã‚‹ã®ã§ãã‚Œã‚’æ“ä½œã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (def g2 (.getGraphics (.Window is)))
#&#39;user/g2
user&amp;gt; (.setColor g2 Color/GREEN)
nil
user&amp;gt; (doseq [face (.toList faces)]
  (let [rect (Rectangle.)]
    (do
      (.setRect rect (.width face) (.height face) (.x face) (.y face))
      (.draw g2 rect))))
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã¯ã„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/images/clojure-opencv/face-recognized-lena.png&#34; alt=&#34;face recognized lena&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ãƒ‘ãƒãƒ‘ãƒãƒ‘ãƒ&lt;/p&gt;

&lt;p&gt;å› ã¿ã«å››è§’å½¢ã‚’æ¶ˆã™ã«ã¯&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-clojure&#34;&gt;user&amp;gt; (.showImage is lena)
nil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã§ååˆ†ã§ã™ã€‚ãƒŸã‚¹ã£ã¦ã‚‚ä½•å›ã§ã‚‚ã‚„ã‚Šç›´ã›ã¾ã™ã­ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã¾ã¨ã‚:f3a429adc3106e7ec83e1e87bf1a8a30&#34;&gt;ã¾ã¨ã‚&lt;/h1&gt;

&lt;p&gt;å› ã¿ã«3.0ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ¢ã—ã¥ã‚‰ã„ã®ã§ã™ãŒã€masterã«ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://docs.opencv.org/master/&#34;&gt;OpenCV: OpenCV&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;OpenCVã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«æ‰±ãˆã‚‹ã¨æ¥½ã—ã„ã®ã§ã¿ãªã•ã‚“Clojureä½¿ã„ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Transducerã«ã¤ã„ã¦</title>
      <link>/slide/transducernitsuite/</link>
      <pubDate>Wed, 03 Jun 2015 22:29:50 +0900</pubDate>
      
      <guid>/slide/transducernitsuite/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Transducerã«ã¤ã„ã¦
----------------------
ã‚µã‚¤ãƒãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ  
æœã®3åˆ†ã‚¹ãƒ”ãƒ¼ãƒ
&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + æ¸‹è°·ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™

# Transducerã£ã¦ï¼Ÿ
------------------

* Clojure 1.7ã§å…¥ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
* é–¢æ•°ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŒ–ã‚’ç°¡å˜ã«ã™ã‚‹
* å…¥åŠ›ã€å‡ºåŠ›ã«ã¯ä¾å­˜ã—ãªã„


# Reduceé–¢æ•°ã«ã¤ã„ã¦
-------------------

* `reduce: (&#39;a -&gt; &#39;b -&gt; &#39;a) &#39;a -&gt; &#39;b list`
* `(&#39;a -&gt; &#39;b -&gt; &#39;a)` ã§ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’é›†ç´„ã™ã‚‹
* `(reduce + 0 &#39;(1 2 3)) ;=&gt; 6`
* è¦ã¯reduceã¯é–¢æ•°ã‚’ä½¿ã£ã¦é›†ç´„ã™ã‚‹ã€‚

# Transducerã«ã¤ã„ã¦
-------------------

* `transduce:((&#39;a -&gt; &#39;b -&gt; &#39;a) -&gt; (&#39;a -&gt; &#39;b -&gt; &#39;a)) (&#39;a -&gt; &#39;b -&gt; &#39;a) &#39;a -&gt; &#39;b list`
* é›†ç´„é–¢æ•°ã‚’å¤‰æ›ã™ã‚‹é–¢æ•°ã‚‚ã¨ã‚‹
* `(transduce xf + 0 &#39;(1 2 3))`
* transducerã§é›†ç´„ã™ã‚‹å‰ã«å‡¦ç†ã‚’æŒŸã‚ã‚‹

# ã™ã”ã„ã¨ã“ã‚
-------------------------
## ã‚³ãƒ³ãƒãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

* `((&#39;a -&gt; &#39;b -&gt; &#39;a) -&gt; (&#39;a -&gt; &#39;b -&gt; &#39;a))`
* å¤‰æ›é–¢æ•°ã¯å…¥åŠ›ã¨å‡ºåŠ›ãŒåŒã˜ã€‚
* ã¤ã¾ã‚Šå¤‰æ›é–¢æ•°ã‚’åˆæˆå‡ºæ¥ã‚‹
* ex) `(comp (filter odd?) (map inc))`


# ã™ã”ã„ã¨ã“ã‚2
--------------------------
## æ±ç”¨æ€§

* å„é–¢æ•°ã¯å…¥åŠ›ã‚„å‡ºåŠ›ã«ã¤ã„ã¦çŸ¥ã‚‹å¿…è¦ã¯ãªã„
  + ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã§ã¯ãªãè¦ç´ ã«å¯¾ã—ã¦å®šç¾©ã•ã‚Œã‚‹
* ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã ã‘ã§ãªãé…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã€ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€ãƒãƒ£ãƒãƒ«ãªã©ãªã©ã«ã‚‚ä½¿ãˆã‚‹
* ä¸­é–“ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ä½œã‚‰ãªã„
  + é…å»¶ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚„ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã¯å¤§ããªãƒ¡ãƒªãƒƒãƒˆ
* é›†ç´„å…ˆã‚’ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãªã©ã«ã™ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã‚‹
  + é–¢æ•°ã®æ±ç”¨æ€§ãŒä¸ŠãŒã‚‹

# ã™ã”ã„ã¨ã“ã‚3
--------------
## ä¸¦åˆ—/éåŒæœŸ

* core.asyncã‚‚transducerã‚’ã‚µãƒãƒ¼ãƒˆ
* å„å¤‰æ›é–¢æ•°ã‚’ä¸¦åˆ—/éåŒæœŸã«å®Ÿè¡ŒãŒå¯èƒ½
* ã•ã‚‰ã«å„é–¢æ•°ã«å‰²ã‚Šå½“ã¦ã‚‹ãƒ—ãƒ­ã‚»ãƒƒã‚µã®æ•°ã‚‚ç´°ã‹ãåˆ¶å¾¡å‡ºæ¥ã‚‹


&lt;span style=&#34;font-size: 500%;&#34;&gt;å¤‰æ›ã—ã¦&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size: 500%;&#34;&gt;é›†ç´„ã™ã‚‹&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size: 300%;&#34;&gt;ä½•ã‹ã«ä¼¼ã¦ãªã„ï¼Ÿ&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size: 600%;&#34;&gt;MapReduce&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/oza_x86&#34;&gt;@oza_x86&lt;/a&gt; ozaã•ã‚“ã®è¿‘ã—ã„ç’°å¢ƒã¨ã„ã†ã¨Hadoop...å¤šæ®µMapreduceã‚’transdecerã¿ãŸã„ã«ã—ã‚ˆã†ã£ã¦ã¯ãªã—ã¨ã‹ã§ã™ã‹ï¼Ÿ&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/605368356393218048&#34;&gt;2015, 6æœˆ 1&lt;/a&gt;&lt;/blockquote&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; ã¾ã•ã«ãã®é€šã‚Šã§ã™ï¼MapReduce ã«ã¯ Combiner ã¨ã„ã†ä¸­é–“é›†ç´„ã‚’ã™ã‚‹ API ãŒã‚ã‚‹ã®ã§ã™ãŒï¼Œãã‚Œã‚’ã‚‚ã£ã¨æ±ç”¨çš„ã«ã—ã‚ˆã†ã¨ã„ã†è©±ã§ã™ï¼ &lt;a href=&#34;http://t.co/injEiPjePG&#34;&gt;http://t.co/injEiPjePG&lt;/a&gt;&lt;/p&gt;&amp;mdash; oza (@oza_x86) &lt;a href=&#34;https://twitter.com/oza_x86/status/605369771505221633&#34;&gt;2015, 6æœˆ 1&lt;/a&gt;&lt;/blockquote&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/oza_x86&#34;&gt;@oza_x86&lt;/a&gt; ã™ã”ã„æ¥½ã—ãã†ã§ã™ã­ã€‚Clojureå‘ã‘ã®APIãŒtransducerã®ãƒãƒƒã‚°ã‚¨ãƒ³ãƒ‰ã«ãªã£ã¦æ™®æ®µæ›¸ã„ã¦ã‚‹ã‚³ãƒ¼ãƒ‰ãŒãã®ã¾ã¾Hadoopã§å‹•ã„ãŸã‚Šã—ãŸã‚‰ã€ã¨ã‹å¤¢ãŒç„¡é™ã«åºƒãŒã‚Šã¾ã™&lt;/p&gt;&amp;mdash; Îºeen (@blackenedgold) &lt;a href=&#34;https://twitter.com/blackenedgold/status/605370461476646912&#34;&gt;2015, 6æœˆ 1&lt;/a&gt;&lt;/blockquote&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;ja&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/blackenedgold&#34;&gt;@blackenedgold&lt;/a&gt; ãŠãŠï¼Œãã®æ¡ˆã¯è‰¯ã„ã§ã™ã­ï¼ï¼&lt;/p&gt;&amp;mdash; oza (@oza_x86) &lt;a href=&#34;https://twitter.com/oza_x86/status/605370619509637121&#34;&gt;2015, 6æœˆ 1&lt;/a&gt;&lt;/blockquote&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size: 200%;&#34;&gt;Clojure 1.7 + Transducer&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size: 400%;&#34;&gt;Comming Soon&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# å‚è€ƒ
------
* [Clojure 1.7ã®transducersã‚’å‹•ã‹ã—ã¦ã¿ã‚ˆã† - Qiita](http://qiita.com/tokomakoma123/items/1ca3fb0dddc5b901b032)
* [core.async+transducers Shibuya.lisp #21](http://www.slideshare.net/ktsujister/coreasynctransducers-shibuyalisp-21)
* [Hadoop Combinerãƒ¡ãƒ¢(Hishidama&#39;s Hadoop Combiner Memo)](http://www.ne.jp/asahi/hishidama/home/tech/apache/hadoop/Combiner.html)
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>Common Lispã§é™å®šç¶™ç¶šã¨éŠã¶</title>
      <link>/slide/Common_Lispdegenteikeizokutoasobu_/</link>
      <pubDate>Sun, 26 Apr 2015 21:09:07 +0900</pubDate>
      
      <guid>/slide/Common_Lispdegenteikeizokutoasobu_/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# Common Lispã§é™å®šç¶™ç¶šã¨éŠã¶
----------------------
[Lisp Meet Up #27](https://atnd.org/events/64988)

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# About Me
---------
![Îºeenã®ã‚¢ã‚¤ã‚³ãƒ³](/images/icon.png) &lt;!-- .element: style=&#34;position:absolute;right:0;z-index:-1&#34; --&gt;

 + Îºeen
 + [@blackenedgold](https://twitter.com/blackenedgold)
 + Github: [KeenS](https://github.com/KeenS)
 + æ¸‹è°·ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
 + Lisp, ML, Shell Scriptã‚ãŸã‚Šã‚’æ›¸ãã¾ã™


# Agenda
--------

0. cl-contã®ç´¹ä»‹
1. é™å®šç¶™ç¶šã®è©±
2. é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±
3. é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±


# CL-CONTã®ç´¹ä»‹

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# CL-CONT
---------

* Common Lispã®é™å®šç¶™ç¶šãƒ©ã‚¤ãƒ–ãƒ©ãƒª
* çµæ§‹å¤ãã‹ã‚‰ã‚ã‚‹ã£ã½ã„
* å‰²ã¨è‰²ã€…ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ã£ã¦ã‚‹

# CL-CONT
---------

![cl-cont dependers](/images/cl-cont-dependers.png)

# API
-----

* ç¶™ç¶šã‚’åŒºåˆ‡ã‚‹ãƒã‚¯ãƒ­
  + `with-call/cc`
  + `defun/cc`
  + `lambda/cc`
* ç¶™ç¶šã‚’å–å¾—ã™ã‚‹ãƒã‚¯ãƒ­
  + `call/cc`
  + `let/cc`

â€»å¾Œã§èª¬æ˜ã™ã‚‹ã®ã§æ„å‘³ãŒåˆ†ã‹ã‚‰ãªãã¦ã‚‚å•é¡Œãªã„ã§ã™ã€‚


# é™å®šç¶™ç¶šã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# ç¶™ç¶šã¨ã¯
---------

* &#34;ãã®å¾Œ&#34;ã®è¨ˆç®—ã‚’è¡¨ã‚ã™æ¦‚å¿µã€‚
* å€¤ãŒæ±ºå®šã—ãŸå¾Œãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«æˆ»ã‚‹ã¾ã§ã®è¨ˆç®—ã€‚
* SchemeãŒä¸€ç´šå¸‚æ°‘ã¨ã—ã¦æ‰±ãˆã‚‹ã“ã¨ã§æœ‰å
* å€¤ã¨ã—ã¦å–ã‚Šå‡ºã—ãŸæ™‚ã¯0-1å¼•æ•°é–¢æ•°ã¨ã—ã¦æŒ¯ã‚‹èˆã†

# ç¶™ç¶šã¨ã¯
----------
`foo`ã®ç¶™ç¶šã¯ã€`foo`ã‚’è™«é£Ÿã„ã«ã—ãŸã‚‚ã®ã¨æ€ãˆã°è‰¯ã„ã€‚

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      (foo x))))
```

# ç¶™ç¶šã¨ã¯
----------
`foo`ã®ç¶™ç¶šã¯ã€`foo`ã‚’è™«é£Ÿã„ã«ã—ãŸã‚‚ã®ã¨æ€ãˆã°è‰¯ã„ã€‚

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      â–¡)))
```

# ç¶™ç¶šã¨ã¯
----------
ã‚ã¨ã¯ãã‚Œã‚’é–¢æ•°ã«ã™ã‚‹ã ã‘

```lisp
(lambda (k)
  (mapc #&#39;writ-line
        (loop :for x :in list
           :collect (if (evenp x)
                        k))))
```


# é™å®šç¶™ç¶šã¨ã¯
---------

* &#34;ãã®å¾Œ&#34;ã®è¨ˆç®—ã‚’è¡¨ã‚ã™æ¦‚å¿µã€‚
* å€¤ãŒæ±ºå®šã—ãŸå¾Œ *æŒ‡å®šã—ãŸä½ç½®* ã«æˆ»ã‚‹ã¾ã§ã®è¨ˆç®—ã€‚
* ç¶™ç¶šãŒãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã¾ã§æˆ»ã‚‹ã®ã«å¯¾ã—ã¦é™å®šç¶™ç¶šé€”ä¸­ã§æ­¢ã¾ã‚‹ã€‚ãã‚Œã ã‘ã€‚
* éƒ¨åˆ†ç¶™ç¶šãªã©ã®è¨€ã„æ–¹ã‚‚ã‚ã‚‹
  + è‹±èªã‚‚part contã¨delimited contã§åˆ†ã‹ã‚Œã‚‹


# é™å®šç¶™ç¶šã¨ã¯
-------------
å…ˆã®ä¾‹ã‚’`loop`ã¾ã§ã®é™å®šç¶™ç¶šã«ã™ã‚‹ã¨

```lisp
(mapc #&#39;writ-line
      (loop :for x :in list
         :collect (if (evenp x)
                      (foo x))))
```


# é™å®šç¶™ç¶šã¨ã¯
-------------
å…ˆã®ä¾‹ã‚’`loop`ã¾ã§ã®é™å®šç¶™ç¶šã«ã™ã‚‹ã¨

```lisp
(loop :for x :in list
           :collect (if (evenp x)
                        â–¡))
```


# é™å®šç¶™ç¶šã¨ã¯
-------------

```lisp
(lambda (k)
  (loop :for x :in list
     :collect (if (evenp x)
                  k)))
```

# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
æ™®é€šã®ã‚„ã¤

```lisp
(with-call/cc
  (+ 1 (call/cc
        (lambda (k)
          (funcall k 2)))))
```

ã“ã‚Œã¯

```lisp
(+ 1 2)
```

ã¨ç­‰ä¾¡

# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
ä»Šåº¦ã¯ç¶™ç¶šã‚’å‘¼ã°ãªã„ã§ã¿ã‚‹

```lisp
(with-call/cc
  (+ 1 (call/cc (lambda (k) 2))))
```

ã“ã‚Œã¯

```lisp
2
```

ã¨ç­‰ä¾¡

# é™å®šç¶™ç¶šã®æŒ™å‹•
---------------
ã‚‚ã†ã¡ã‚‡ã£ã¨å‘¼ã°ãªã„ä¾‹  
(`(let/cc k ...)` = `(call/cc (lambda (k) ...))`)

```lisp
(with-call/cc
  (write-line &#34;hello&#34;)
  (let/cc k 1)
  (write-line &#34;world&#34;))
```

ã¯

```lisp
(progn
  (write-line &#34;hello&#34;)
  1)
```

ã¨ç­‰ä¾¡


# é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# é™å®šç¶™ç¶šã®ä½¿ã„æ–¹ã®è©±
---------------------

* ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
* ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ç¶ºéº—ã«æ›¸ãæ›ãˆã‚‹
* éæ±ºå®šæ€§è¨ˆç®—
* etc...


## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰

&lt;!-- .slide: class=&#34;center&#34; --&gt;


## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------

* ã¾ãŸã®åã‚’ã‚³ãƒ«ãƒ¼ãƒãƒ³
* ã¾ãŸã®åã‚’å¼·èª¿ã‚¹ãƒ¬ãƒƒãƒ‰



## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------
```lisp
(let (c)
  (setf c (with-call/cc
            (write-line &#34;in thread A 1&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 2&#34;)
            (let/cc k k)
            (write-line &#34;in thread A 3&#34;)))
  (write-line &#34;in main thread 1&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 2&#34;)
  (setq c (funcall c))
  (write-line &#34;in main thread 3&#34;))
```

## ã‚°ãƒªãƒ¼ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰
-----------------
å®Ÿè¡Œçµæœ

```
in thread A 1
in main thread 1
in thread A 2
in main thread 2
in thread A 2
in main thread 3

```


## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ

&lt;!-- .slide: class=&#34;center&#34; --&gt;

## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
----------------------
æœ¬å½“ã¯ã“ã†æ›¸ããŸã„

```lisp
(with-event-loop
    (format t &#34;Hello, ~a!~%&#34; (async-read stream)))
```

## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
----------------------
ã—ã‹ã—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’è¦æ±‚ã—ã¦ãã‚‹

```lisp
(with-event-loop
    (async-read stream (lambda (line)
                         (format t &#34;Hello, ~a!~%&#34; line))))
```

## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®æ›¸ãæ›ãˆ
-----------------------
ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ = é™å®šç¶™ç¶šï¼ˆå¾Œè¿°ï¼‰ãªã®ã§ã“ã†ã—ã¦ã‚„ã‚Œã°è‰¯ã„ã€‚

```lisp
(with-event-loop
    (with-call/cc
      (format t &#34;Hello, ~a!~%&#34;
              (call/cc (lambda (k))
                       (async-read stream k)))))
```

## éæ±ºå®šæ€§è¨ˆç®—

&lt;!-- .slide: class=&#34;center&#34; --&gt;

## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢

* ç¶™ç¶šã‚’é–¢æ•°ã¨ã—ã¦å–ã‚Šå‡ºã—ãŸå¾ŒåŒã˜å‡¦ç†ã‚’ä½•å›ã‚‚å®Ÿè¡Œå‡ºæ¥ã‚‹ã‚“ã˜ã‚ƒã­ï¼Ÿ


## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
è¤‡æ•°å›å‘¼ã³å‡ºã—ã¦ã¿ã‚‹

```lisp
(let (c)
  (setf c (with-call/cc
            (+ 1 (* 2 (- 3 (let/cc k k))))))
  (list (funcall c 1)
        (funcall c 2)
        (funcall c 3)))
```


## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
æ™®é€šã®1å¼•æ•°é–¢æ•°ã¨ã—ã¦ä½¿ã£ã¦ã¿ã‚‹

```lisp
(let (c)
  (setf c (with-call/cc
            (+ 1 (* 2 (- 3 (let/cc k k))))))
  (mapcar c (list 1 2 3)))
```

## éæ±ºå®šæ€§è¨ˆç®—
-------------
### ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢
ãƒã‚¯ãƒ­ã§ãƒ©ãƒƒãƒ—ã—ã¦ã¿ã‚‹

```lisp
(defmacro for (&amp;body expr)
  `(with-call/cc ,@expr))
(defmacro in (m)
  `(let/cc k (apply #&#39;append (mapcar k ,m))))
(defun yield (x) (list x))
(defun unit () nil)
```


## éæ±ºå®šæ€§è¨ˆç®—
-------------
ä½¿ã£ã¦ã¿ã‚‹

```lisp
(for
  (let ((x (in &#39;(1 2 3)))
        (y (in &#39;(a b c))))
    (yield (cons x y))))
```

```
((1 . A) (1 . B) (1 . C) (2 . A) (2 . B) (2 . C) (3 . A) (3 . B) (3 . C))
```


# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±
-------------------

* ç¶™ç¶šã¯0~1å¼•æ•°é–¢æ•°ã¨ã—ã¦å–ã‚Šå‡ºã›ã‚‹ã®ã§ã‚ã£ãŸã€‚
  + å®Ÿã¯æ©Ÿæ¢°çš„ã«å–ã‚Šå‡ºã›ã‚‹
* ç¶™ç¶šã¯å…¨ã¦ã®å¼ã«æš—é»™ã«å­˜åœ¨ã™ã‚‹ã®ã§ã‚ã£ãŸ
  + å…¨ã¦ã®å¼ã‚’ç¶™ç¶šã‚’æ˜ç¤ºçš„ã«ä½¿ã†ã‚ˆã†ã«ã‚‚å‡ºæ¥ã‚‹


# CPSå¤‰æ›

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# CPSå¤‰æ›
---------

* å…¨ã¦ã®é–¢æ•°ã®å¼•æ•°ã‚’1ã¤å¢—ã‚„ã—ã¦ã€ãã“ã§ç¶™ç¶šã‚’å—ã‘å–ã‚‹
* å€¤ã‚’è¿”ã™æ™‚ã¯æš—é»™ã®returnã‚’ä½¿ã†ã®ã§ã¯ãªãæ˜ç¤ºçš„ã«ç¶™ç¶šã‚’å‘¼ã¶
* é–¢æ•°ã‚’å‘¼ã¶æ™‚ã¯å¿…ãšç¶™ç¶šã‚’æ¸¡ã™ã€‚å‘¼ã³å‡ºã—å…ƒã«ã¯è¿”ã£ã¦ã“ãªã„ï¼ˆè‡ªç„¶ã¨æœ«å°¾å†å¸°ã«ãªã‚‹ï¼‰


# CPSå¤‰æ›
---------
ä¾‹ãˆã°

```lisp
(with-call/cc
  (foo (call/cc
        (lambda (k)
          (funcall k 2)))))
```

ã¯ã€å–ã‚Šå‡ºã•ã‚ŒãŸç¶™ç¶šãŒ

```lisp
(lambda (k) (foo k))
```

ã€‚


# CPSå¤‰æ›
---------
ã‚ˆã£ã¦

```lisp
((lambda (k) (foo k)) 2)
```

ã¨å¤‰æ›ã•ã‚Œã‚‹


# CPSå¤‰æ›
---------
å†å¸°é–¢æ•°ã ã¨å°‘ã—é¢å€’

```lisp
(defun fact (n)
  (if (&lt;= n)
      1
      (* n (fact (- n 1))))))

```

ãŒ

```lisp
(defun fact (n c)
  (if (&lt;= n)
      (c 1)
      (fact (- n 1) (lambda (v) (* n v)))))
```

ã¨ãªã‚‹


# CPSå¤‰æ›
---------

* CPSå¤‰æ›ã‚’è¡Œãªã†ã“ã¨ã§ã„ã¤ã§ã‚‚ç¶™ç¶šã‚’å€¤ã¨ã—ã¦ä½¿ãˆã‚‹


# é™å®šç¶™ç¶šã®å®Ÿè£…ã®è©±
-------------------

* CPSå¤‰æ›ã‚’è£ã§è¡Œãªã£ã¦ã„ã‚‹
* è‡ªå‹•ã§å‡ºæ¥ã‚‹ã®ã§ãƒã‚¯ãƒ­ã§å¤‰æ›ã‚’ã—ã¦ã„ã‚‹
  + çµ„ã¿è¾¼ã¿é–¢æ•°ã¯å¤‰æ›´å‡ºæ¥ãªã„ã®ã§ç‰¹åˆ¥æ‰±ã„
  + ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã‚‚æ°—ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹
* `lambda`ãŒä¹±ç«‹ã™ã‚‹ã®ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯é…·ã„ã€‚


# ã¾ã¨ã‚
-------

* cl-contã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã£ã¦ã€é™å®šç¶™ç¶šãŒæ‰±ãˆã‚‹
* é™å®šç¶™ç¶šã¯å‡¦ç†ã‚’ä¸­æ–­ã—ãŸã‚Šå†é–‹ã—ãŸã‚Šç¹°ã‚Šè¿”ã—ãŸã‚Šã«ä½¿ãˆã‚‹
* è£ã§ã¯ãˆã’ã¤ãªã„ã“ã¨ã‚’ã‚„ã£ã¦ã„ã‚‹
* ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¿…è¦ãªã¨ã“ã‚ã§ã¯ä½¿ã£ã¡ã‚ƒãƒ€ãƒ¡


# å‚è€ƒ
------
* [picrin/partcont.scm at master Â· picrin-scheme/picrin](https://github.com/picrin-scheme/picrin)
* [cl-cont | Quickdocs](http://quickdocs.org/cl-cont/)
* [ã‚³ãƒ«ãƒ¼ãƒãƒ³ã‚’Common Lispã§ç°¡å˜ã«å®šç¾© - ã•ãã‚‰ã‚“ã¼ã®lambdaæ—¥è¨˜](http://lambdasakura.hatenablog.com/entry/20111026/1319598590)
* [ç¶™ç¶šæ¸¡ã—ã‚¹ã‚¿ã‚¤ãƒ« - Wikipedia](http://ja.wikipedia.org/wiki/%E7%B6%99%E7%B6%9A%E6%B8%A1%E3%81%97%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB)
* [M.Hiroi&#39;s Home Page / ãŠæ°—æ¥½ Scheme ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å…¥é–€](http://www.geocities.jp/m_hiroi/func/abcscm20.html)
&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>caveman2ã€ningleâ€¦Common Lispã®Webå‘¨ã‚Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å¿«é©ã«ä½¿ã†ãŸã‚ã®ãŸã£ãŸ1ã¤ã®ã‚³ãƒˆ</title>
      <link>/slide/caveman2-ningle...Common-LispnoWebmawarinofure-muwa-kuwokaitekinitsukautatta1tsunokoto/</link>
      <pubDate>Thu, 05 Mar 2015 13:18:44 +0900</pubDate>
      
      <guid>/slide/caveman2-ningle...Common-LispnoWebmawarinofure-muwa-kuwokaitekinitsukautatta1tsunokoto/</guid>
      <description>&lt;section data-markdown
    data-separator=&#34;\n\n&#34;
    data-vertical=&#34;\n\n&#34;
    data-notes=&#34;^Note:&#34;&gt;
&lt;script type=&#34;text/template&#34;&gt;
# caveman2ã€ningleã€dataflyâ€¦Common Lispã®Webå‘¨ã‚Šã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å¿«é©ã«ä½¿ã†ãŸã‚ã®ãŸã£ãŸ1ã¤ã®ã‚³ãƒˆ
----------------------
Clack Meet Up #1  
2015-03-05 @ã‚µãƒ ãƒ©ã‚¤ãƒˆ

&lt;!-- .slide: class=&#34;center&#34; --&gt;

&lt;span style=&#34;font-size:300%&#34;&gt;ãšã£ã¨ä¿ºã®ã‚¿ãƒ¼ãƒ³&lt;/span&gt;

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# å•é¡Œ
------
Common Lispã¯ case

* Sensitive &lt;!--.element: class=&#34;fragment grow&#34; data-fragment-index=&#34;1&#34; --&gt;  
* Insensitive &lt;!--.element: class=&#34;fragment shrink&#34; data-fragment-index=&#34;1&#34; --&gt;

ã©ã£ã¡?

# å•é¡Œ
-------

ã‚ã‚Œï¼Ÿ

```lisp
(eql? &#39;CaseInsensitive &#39;caseinsensitive) ;=&gt; t
```


# å•é¡Œ
-------

ãƒªãƒ¼ãƒ€ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å¤§æ–‡å­—ã«ã™ã‚‹ã ã‘
```lisp
(eql? &#39;|CaseSensitive| &#39;|casesensitive|) ;=&gt; nil
```


# Caveman2
---------

```lisp
@route GET &#34;/hello&#34;
(defun say-hello (&amp;key (|name| &#34;Guest&#34;))
  (format nil &#34;Hello, ~A&#34; |name|))
```

# Ningle
--------

```lisp
(setf (ningle:route *app* &#34;/login&#34; :method :POST)
      #&#39;(lambda (params)
          (if (authorize (getf params :|username|)
                         (getf params :|password|))
            &#34;Authorized!&#34;
            &#34;Failed...Try again.&#34;)))
```

# é¢å€’â€¦
----
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãã®ã¾ã¾ã ãŸã£ã‚‰ã„ã„ã®ã«

# é­”æ³•ã®`readtable-case`

&lt;!-- .slide: class=&#34;center&#34; --&gt;

# é­”æ³•ã®`readtable-case`
-----------------------
```lisp
(setf (readtable-case *readtable*) :invert)
```
ã‚’ä½¿ãˆã°OK  
å‚è€ƒ: [SBCLã§clispã¨ã‹allegroã®modern modeçš„ãªã“ã¨ã‚’ã™ã‚‹ - wasabizã®æ—¥è¨˜](http://wasabiz.hatenablog.com/entry/20120929/1348889601)

# ä¾‹
----
```lisp
CL-USER&gt; :username
:USERNAME
CL-USER&gt; (setf (readtable-case *readtable*) :invert)
:invert
CL-USER&gt; :username
:username
```

# ã¾ã¨ã‚
--------
* `(setf (readtable-case *readtable*) :invert)`ã‚’ä½¿ã†ã¨å¿«é©ã ã‚ˆ


&lt;/script&gt;
&lt;/section&gt;
</description>
    </item>
    
  </channel>
</rss>