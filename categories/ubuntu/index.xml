<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ubuntu on κeenのHappy Hacκing Blog</title>
    <link>http://KeenS.github.io/categories/ubuntu/</link>
    <description>Recent content in Ubuntu on κeenのHappy Hacκing Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 27 Dec 2014 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://KeenS.github.io/categories/ubuntu/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>FreeBSDに移行した</title>
      <link>http://keens.github.io/blog/2014/12/27/freebsd</link>
      <pubDate>Sat, 27 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>http://keens.github.io/blog/2014/12/27/freebsd</guid>
      <description>

&lt;p&gt;κeenです。Ubuntuのaptが古いのが我慢ならなくなってきたのでFreeBSDに移行しました。pkgのsbclが1.2.6ですよ！&lt;/p&gt;

&lt;p&gt;最初は踏ん切りがつかなかったのでメインの500GBのHDDではなく、ジャンクで買った128Gのものにインストール。様々な問題に当ったものの、どうにか使えてます。今はHDD換装してメインになってます。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;問題の半分はKDEを導入したら直った（最初はCinnamon入れようとした。UbuntuではUnity使ってた）&lt;/li&gt;
&lt;li&gt;２日くらいはつぶす覚悟&lt;/li&gt;
&lt;li&gt;Xorgの設定を手で畫くことになるとは&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;良いところ:6815c4bb5244a752c57de70488c4827c&#34;&gt;良いところ&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;速い気がする。ufsのお陰？（HDDの問題？）&lt;/li&gt;
&lt;li&gt;Firefoxが全然CPU食わなくなった（プラグインの問題？）&lt;/li&gt;
&lt;li&gt;pkg使い易い！&lt;/li&gt;
&lt;li&gt;Ubuntuで使ってたソフトウェア大体動く&lt;/li&gt;
&lt;li&gt;portsもある！！&lt;/li&gt;
&lt;li&gt;Dtraceとかjailとか便利そうじゃね？&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;問題:6815c4bb5244a752c57de70488c4827c&#34;&gt;問題&lt;/h1&gt;

&lt;p&gt;たいてい解決or妥協してるのですが、どうにもならない点がいくつか&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;skkservがセグフォる。multiskkserv使えない。今は辞書直読みで対応してる。&lt;/li&gt;
&lt;li&gt;Wifiのデバドラがない。今はUSBのアダプタ使ってる（そっちのドライバはある）&lt;/li&gt;
&lt;li&gt;sleepすると復帰したときにディスプレイが点かない&lt;/li&gt;
&lt;li&gt;メインのHDDにデュアルブートでバックポート出来無かった&lt;/li&gt;
&lt;li&gt;日本語キーボードのモディファイアキーを認識しない: のたうち回ってpolykitの設定とかsysctlとか書いてる内に直った。でもen配列だと無理&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;特に3番が痛い。&lt;/p&gt;

&lt;h1 id=&#34;解決-妥協した問題:6815c4bb5244a752c57de70488c4827c&#34;&gt;解決/妥協した問題&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;インプットメソッド、ログインマネージャ、タイムゾーン: KDEを導入したら直った&lt;/li&gt;
&lt;li&gt;データの移行: fusefs_ext4でUbuntuのHDDマウントしてコピー、権限変更、&lt;code&gt;chmod u+w&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;フォント: &lt;code&gt;sudo pkg install $(pkg search ja-font)&lt;/code&gt;の力技。あとはXorgの設定書いてKDEとFirefoxで好みのフォントを選んだ&lt;/li&gt;
&lt;li&gt;キーボードdvorakにしてるのにqwertyになる: qwertyで妥協。やりたければ&lt;code&gt;sekxkbd&lt;/code&gt;とかあるし&lt;/li&gt;
&lt;li&gt;ロケールが日本語になんなくてFirefoxとかが全部英語: ま、いっか&lt;/li&gt;
&lt;li&gt;タッチパッドでスクロールが出来無い: Xorgの設定書いた。ドライバもなんか設定書いた気がする&lt;/li&gt;
&lt;li&gt;kvmが使えない: むしろBHyVeを試してみるチャンス！開発中のVMMを提供してくれたFreeBSDに圧倒的感謝！！&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;デバドラとかハードウェア周りがつらい。ソフトウェアは統合デスクトップ環境が吸収してくれますね。&lt;/p&gt;

&lt;p&gt;EmacsとFirefoxとThunderbirdが動くので今のところ問題ないですね。今後また問題が出て来るかも。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>UbuntuでEmacsからGPGを透過的に扱う</title>
      <link>http://keens.github.io/blog/2013/12/04/emacs-gpg</link>
      <pubDate>Wed, 04 Dec 2013 00:00:00 +0000</pubDate>
      
      <guid>http://keens.github.io/blog/2013/12/04/emacs-gpg</guid>
      <description>

&lt;p&gt;暗号化といえばGPGですがEmacsからGPGで暗号化されたファイルを編集しようとすると毎回パスワードを訊かれて鬱陶しいです。これはキーリングを登録することで解決できました。&lt;/p&gt;

&lt;h2 id=&#34;step1-keyringに登録する:4c29e36829eecbe9ac0eee4020d73315&#34;&gt;Step1 Keyringに登録する&lt;/h2&gt;

&lt;p&gt;Dashboardから[key]で検索すると[パスワードと鍵]が見付かります。左上の[+]で新たにキーリングを追加します。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://KeenS.github.io/images/2013-12-04-1.png&#34; alt=&#34;こんな感じ&#34; title=&#34;keyring&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;GPGを選択します&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://KeenS.github.io/images/2013-12-04-2.png&#34; alt=&#34;こんな感じ&#34; title=&#34;Selecting GPG&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;必要な情報を入力します。このメールアドレスは実在しなくても作れますが、ブルートフォースかけられたときの警告とかに使われそうなので実在した方が良い気がします。とりあえず後で使うので覚えておいて下さい。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://KeenS.github.io/images/2013-12-04-3.png&#34; alt=&#34;&#39;Input info &amp;quot;こんな感じ&amp;quot;&#34; title=&#34;&#39;Input info &amp;quot;こんな感じ&amp;quot;&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;あとはパスワードのプロンプトが出るので入力して、エントロピーを発生させたら終わりです。&lt;/p&gt;

&lt;h2 id=&#34;step2-ファイルを準備する:4c29e36829eecbe9ac0eee4020d73315&#34;&gt;Step2 ファイルを準備する&lt;/h2&gt;

&lt;p&gt;ここが肝です。ファイルの先頭に&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-*- epa-file-encrypt-to: (my@mailaddress) -*-
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;を挿入します。既存の暗号化されたファイルでも同じです。&lt;/p&gt;

&lt;h2 id=&#34;step3-暗号化する:4c29e36829eecbe9ac0eee4020d73315&#34;&gt;Step3 暗号化する&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;M-x epa-encrypt-file&lt;/code&gt;で暗号化できます。暗号化するファイル名を指定したらキーリングを選べます&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://KeenS.github.io/images/2013-12-04-4.png&#34; alt=&#34;こんな感じ&#34; title=&#34;Selecting GPG&#34; /&gt;
&lt;/p&gt;

&lt;h2 id=&#34;step4-編集する:4c29e36829eecbe9ac0eee4020d73315&#34;&gt;Step4 編集する&lt;/h2&gt;

&lt;p&gt;あとはもう透過的に使えます。でもなんか実験してたらファイル保存できなかった。先にGPGで暗号化してたやつはできたのに。要調査です。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Redmineのインストール</title>
      <link>http://keens.github.io/blog/2013/09/05/install-redmine</link>
      <pubDate>Thu, 05 Sep 2013 00:00:00 +0000</pubDate>
      
      <guid>http://keens.github.io/blog/2013/09/05/install-redmine</guid>
      <description>

&lt;p&gt;私はバイトではプロジェクト管理に &lt;a href=&#34;http://backlog.jp&#34;&gt;Backlog&lt;/a&gt;のサービスを利用してますが、同様のOSSに &lt;a href=&#34;http://redmine.jp&#34;&gt;Redmine&lt;/a&gt;なるものがあると聞いて動かしてみたときのメモ。&lt;/p&gt;

&lt;p&gt;以下、公式の引用。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Redmineはオープンソースのプロジェクト管理ソフトウェアです。&lt;/p&gt;

&lt;p&gt;プロジェクトのタスク管理、進捗管理、情報共有が行えます。SubversionやGitなどのバージョン管理システムとの連携機能も備えており、ソフトウェア開発やwebサイト制作などのITプロジェクトで特に威力を発揮します。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Redmineの管理団体(？)が &lt;a href=&#34;http://hosting.redmine.jp/&#34;&gt;MyRedmine&lt;/a&gt;というホスティングサービスを提供してたりしますが、今回はこれをローカルで動かします。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://redmine.jp/guide/RedmineInstall/&#34;&gt;公式ドキュメント&lt;/a&gt;を参考に作業していきます。&lt;/p&gt;

&lt;p&gt;まずはダウンロード。現在の最新版は2.3.2だそうです。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cd ~/Ruby
$svn checkout http://svn.redmine.org/redmine/branches/2.3-stable redmine
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;んで、グローバルの空間を汚したくないので新たにGemsetを作ります。本来ならbundler仕事なのですが、railsのバージョンとか仕組みの問題が面倒臭そうだったのでGemsetで管理。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$rvm use --create 1.9.3@redmine
$cd redmine
$echo ruby-1.9.3-p448 &amp;gt; .ruby-version
$echo redmine &amp;gt; .ruby-gemset
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;これで~/Ruby/redmineにcdすると自動的にrvmが1.9.3@redmineに切り替えてくれます。&lt;br /&gt;
※注意&lt;br /&gt;
&lt;code&gt;.rvmrc&lt;/code&gt;に&lt;code&gt;rvm use 1.9.3@redmine&lt;/code&gt;と書いてたら怒られます。&lt;code&gt;.ruby-version&lt;/code&gt;と&lt;code&gt;.ruby-gemset&lt;/code&gt;がバージョン管理システムに依存しない新しい書き方だそうです。&lt;/p&gt;

&lt;p&gt;データベースはデフォルトだとMySQLを使う設定になってますがこんなお試しにのためにMySQLを動かしたくないのでSQLiteに変更。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cp config/{database.yml.example, database.yml}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;のあと、database.ymlのproductionの部分を以下のように変更。&lt;/p&gt;

&lt;figure class=&#34;code&#34;&gt;&lt;figcaption&gt;&lt;span&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;table&gt;&lt;tr&gt;
&lt;td class=&#34;gutter&#34;&gt;&lt;pre class=&#34;line-numbers&#34;&gt;&lt;span class=&#34;line-number&#34;&gt;1&lt;/span&gt;
&lt;span class=&#34;line-number&#34;&gt;2&lt;/span&gt;
&lt;span class=&#34;line-number&#34;&gt;3&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;l-Scalar-Plain&#34;&gt;production&lt;/span&gt;&lt;span class=&#34;p-Indicator&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;err&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l-Scalar-Plain&#34;&gt;adapter&lt;/span&gt;&lt;span class=&#34;p-Indicator&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;l-Scalar-Plain&#34;&gt;sqlite3&lt;/span&gt;
&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;err&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l-Scalar-Plain&#34;&gt;database&lt;/span&gt;&lt;span class=&#34;p-Indicator&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;l-Scalar-Plain&#34;&gt;db/redmine.sqlite3&lt;/span&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;あとは&lt;code&gt;bundle install&lt;/code&gt;。(bundlerはインストールされてる前提です)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$bundle install --without development test
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;すると…あれ？RMagickでコケる…。公式ドキュメントには &lt;code&gt;bundle&lt;/code&gt;の&lt;code&gt;--without&lt;/code&gt;に&lt;code&gt;rmagick&lt;/code&gt;を加えろと書いてますが画像扱えないのは悔しいので色々調べた結果、&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$sudo apt-get install libmagic-dev libmagickwand-dev
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で依存関係を満せるようです。これでようやく&lt;code&gt;bundle install&lt;/code&gt;が通ります。&lt;/p&gt;

&lt;p&gt;ここまできたらあとはドキュメント通り。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$rake generate_secret_token
$RAILS_ENV=production rake db:migrate
$RAILS_ENV=production rake redmine:load_default_data
$rails s
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;…あれ？&lt;code&gt;rails s&lt;/code&gt;でコケる。&lt;br /&gt;
これは自分がrailsに慣れてなかったのが問題のようで、正しくは&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$rails s -e production
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;だそうです。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$RAILS_ENV=production rails s
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;としても同じ。これで &lt;a href=&#34;http://localhost:3000&#34;&gt;localhost:3000&lt;/a&gt;にアクセスするとRedmineが開きます。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://KeenS.github.io/images/redmine-home.png&#34; alt=&#34;Redmineのホーム画面&#34; title=&#34;redmine-home&#34; /&gt;
&lt;/p&gt;

&lt;p&gt;因みにAdminのID、パスワードはadminだそうです。&lt;/p&gt;

&lt;p&gt;データベースの設定のexample部分にjenkinsとかいう文字列があったけど連携できるのかなぁ。要調査。&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&#34;補足:a43437a354b8b7517c127327059a51a0&#34;&gt;補足&lt;/h3&gt;

&lt;p&gt;デフォルトのWEBrickだと遅いのでGemfileに&lt;/p&gt;

&lt;figure class=&#34;code&#34;&gt;&lt;figcaption&gt;&lt;span&gt;&lt;/span&gt;&lt;/figcaption&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;table&gt;&lt;tr&gt;
&lt;td class=&#34;gutter&#34;&gt;&lt;pre class=&#34;line-numbers&#34;&gt;&lt;span class=&#34;line-number&#34;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;ruby&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;n&#34;&gt;gem&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&#34;thin&#34;&lt;/span&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;を加えて、&lt;code&gt;bundle install&lt;/code&gt;し直すと自動的にThinを使ってくれるそうです。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>