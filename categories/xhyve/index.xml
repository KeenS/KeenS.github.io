<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Xhyve on κeenのHappy Hacκing Blog</title>
    <link>/categories/xhyve/index.xml</link>
    <description>Recent content in Xhyve on κeenのHappy Hacκing Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-jp</language>
    <atom:link href="/categories/xhyve/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>xhyveでFreeBSD guestを動かす</title>
      <link>/blog/2015/09/16/xhyvedefreebsd_guestwougokasu</link>
      <pubDate>Wed, 16 Sep 2015 21:55:25 +0900</pubDate>
      
      <guid>/blog/2015/09/16/xhyvedefreebsd_guestwougokasu</guid>
      <description>&lt;p&gt;久しぶりですね。κeenです。最近はMacでもまともな仮想環境が整ってきたのでFreeBSDでも動かすかーといって試したやつを共有します。&lt;/p&gt;

&lt;p&gt;
大部分は&lt;a href=&#34;http://blog.holidayworking.org/entry/2015/06/27/xhyve_%E3%81%A7_FreeBSD_%E3%82%92%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%81%9F&#34;&gt;ここ&lt;/a&gt;を参考にしてますが、ちゃんと動きます。&lt;/p&gt;

&lt;h1 id=&#34;xhyveとは&#34;&gt;xhyveとは&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;http://www.pagetable.com/?p=831&#34;&gt;xhyve – Lightweight Virtualization on OS X Based on bhyve | pagetable.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;FreeBSDのBHyVeをMac OS Xに移植したものです。Intel CPUの仮想化フレームワークを使うことで仮想化の実装が（比較的）が楽になるからやろうぜってプロジェクトです。
カーネルレベルでのサポートが必要になりますがyosemiteからHyervisor.frameworkが入っているのでそれが使えます。&lt;/p&gt;

&lt;p&gt;因みに開発はそんなに活発ではないです。&lt;/p&gt;

&lt;h1 id=&#34;動かす&#34;&gt;動かす&lt;/h1&gt;

&lt;h2 id=&#34;xhyveの準備&#34;&gt;xhyveの準備&lt;/h2&gt;

&lt;p&gt;FreeBSDのサポートは既にマージされているのでcloneしてきてそのまま使えます。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;git clone git@github.com:mist64/xhyve.git
cd xhyve
make
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;FreeBSDのイメージの入手
イメージは現在10.2が出ているので&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;fetch http://ftp.freebsd.org/pub/FreeBSD/releases/VM-IMAGES/10.2-RELEASE/amd64/Latest/FreeBSD-10.2-RELEASE-amd64.raw.xz
unxz FreeBSD-10.2-RELEASE-amd64.raw.xz
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で入手出来ます。&lt;/p&gt;

&lt;h2 id=&#34;起動スクリプトの準備&#34;&gt;起動スクリプトの準備&lt;/h2&gt;

&lt;p&gt;参照ブログのままだとハードディスクが読めないのでIMG_HDDにもイメージを指定します。&lt;/p&gt;

&lt;p&gt;名前は何でも良いのですが&lt;code&gt;freebsd.sh&lt;/code&gt;として保存し、&lt;code&gt;chmod +x freebsd.sh&lt;/code&gt;します。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;#!/bin/sh

USERBOOT=&amp;quot;test/userboot.so&amp;quot;
BOOTVOLUME=&amp;quot;FreeBSD-10.2-RELEASE-amd64.raw&amp;quot;
KERNELENV=&amp;quot;&amp;quot;

MEM=&amp;quot;-m 1G&amp;quot;
#SMP=&amp;quot;-c 2&amp;quot;
#NET=&amp;quot;-s 2:0,virtio-net&amp;quot;
#IMG_CD=&amp;quot;-s 3,ahci-cd,/somepath/somefile.iso&amp;quot;
IMG_HDD=&amp;quot;-s 4,virtio-blk,$BOOTVOLUME&amp;quot;
PCI_DEV=&amp;quot;-s 0:0,hostbridge -s 31,lpc&amp;quot;
LPC_DEV=&amp;quot;-l com1,stdio&amp;quot;
#UUID=&amp;quot;-U deadbeef-dead-dead-dead-deaddeafbeef&amp;quot;

build/xhyve -A $MEM $SMP $PCI_DEV $LPC_DEV $NET $IMG_CD $IMG_HDD $UUID -f fbsd,$USERBOOT,$BOOTVOLUME,&amp;quot;$KERNELENV&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;起動&#34;&gt;起動&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;./freebsd.sh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で起動します。&lt;/p&gt;

&lt;h1 id=&#34;その他&#34;&gt;その他&lt;/h1&gt;

&lt;p&gt;FreeBSDのイメージを一杯作りたい人はダウンロードしてきたやつを&lt;code&gt;cp&lt;/code&gt;して使うと良いと思います。&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>